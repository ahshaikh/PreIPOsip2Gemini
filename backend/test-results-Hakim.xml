<?xml version="1.0" encoding="UTF-8"?>
<testsuites>
  <testsuite name="C:\PreIPO\backend\phpunit.xml" tests="907" assertions="1464" errors="241" failures="177" skipped="5" time="558.989634">
    <testsuite name="Feature" tests="444" assertions="799" errors="99" failures="132" skipped="5" time="449.819252">
      <testsuite name="Tests\Feature\UserLuckyDrawEndpointsTest" file="C:\PreIPO\backend\tests\Feature\UserLuckyDrawEndpointsTest.php" tests="2" assertions="2" errors="1" failures="0" skipped="0" time="1.748231">
        <testcase name="testUserCanViewCurrentDraw" file="C:\PreIPO\backend\tests\Feature\UserLuckyDrawEndpointsTest.php" line="36" class="Tests\Feature\UserLuckyDrawEndpointsTest" classname="Tests.Feature.UserLuckyDrawEndpointsTest" assertions="2" time="0.754523"/>
        <testcase name="testUserCanViewOwnEntries" file="C:\PreIPO\backend\tests\Feature\UserLuckyDrawEndpointsTest.php" line="47" class="Tests\Feature\UserLuckyDrawEndpointsTest" classname="Tests.Feature.UserLuckyDrawEndpointsTest" assertions="0" time="0.993709">
          <error type="Error">Tests\Feature\UserLuckyDrawEndpointsTest::testUserCanViewOwnEntries&#13;
Error: Class "Database\Factories\LuckyDrawEntryFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Feature\UserLuckyDrawEndpointsTest.php:64</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\SubscriptionLifecycleTest" file="C:\PreIPO\backend\tests\Feature\SubscriptionLifecycleTest.php" tests="4" assertions="8" errors="0" failures="0" skipped="0" time="5.881345">
        <testcase name="user_can_cancel_subscription" file="C:\PreIPO\backend\tests\Feature\SubscriptionLifecycleTest.php" line="93" class="Tests\Feature\SubscriptionLifecycleTest" classname="Tests.Feature.SubscriptionLifecycleTest" assertions="2" time="1.514174"/>
        <testcase name="user_can_pause_subscription" file="C:\PreIPO\backend\tests\Feature\SubscriptionLifecycleTest.php" line="69" class="Tests\Feature\SubscriptionLifecycleTest" classname="Tests.Feature.SubscriptionLifecycleTest" assertions="2" time="1.449509"/>
        <testcase name="user_can_upgrade_plan" file="C:\PreIPO\backend\tests\Feature\SubscriptionLifecycleTest.php" line="47" class="Tests\Feature\SubscriptionLifecycleTest" classname="Tests.Feature.SubscriptionLifecycleTest" assertions="2" time="1.457658"/>
        <testcase name="user_can_subscribe_successfully" file="C:\PreIPO\backend\tests\Feature\SubscriptionLifecycleTest.php" line="32" class="Tests\Feature\SubscriptionLifecycleTest" classname="Tests.Feature.SubscriptionLifecycleTest" assertions="2" time="1.460004"/>
      </testsuite>
      <testsuite name="Tests\Feature\ReferralSystemTest" file="C:\PreIPO\backend\tests\Feature\ReferralSystemTest.php" tests="1" assertions="0" errors="1" failures="0" skipped="0" time="1.474120">
        <testcase name="referrer_gets_bonus_and_tier_upgrade_on_referee_payment" file="C:\PreIPO\backend\tests\Feature\ReferralSystemTest.php" line="26" class="Tests\Feature\ReferralSystemTest" classname="Tests.Feature.ReferralSystemTest" assertions="0" time="1.474120">
          <error type="ErrorException">Tests\Feature\ReferralSystemTest::referrer_gets_bonus_and_tier_upgrade_on_referee_payment&#13;
ErrorException: Undefined variable $tdsService
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bootstrap\HandleExceptions.php:258
C:\PreIPO\backend\app\Jobs\ProcessReferralJob.php:131
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Jobs\ProcessReferralJob.php:93
C:\PreIPO\backend\app\Services\IdempotencyService.php:206
C:\PreIPO\backend\app\Jobs\ProcessReferralJob.php:87
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\tests\Feature\ReferralSystemTest.php:52</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\ChargebackInvariantsTest" file="C:\PreIPO\backend\tests\Feature\ChargebackInvariantsTest.php" tests="9" assertions="16" errors="0" failures="0" skipped="0" time="8.498305">
        <testcase name="chargeback_creates_balanced_ledger_entries" file="C:\PreIPO\backend\tests\Feature\ChargebackInvariantsTest.php" line="169" class="Tests\Feature\ChargebackInvariantsTest" classname="Tests.Feature.ChargebackInvariantsTest" assertions="1" time="0.910326"/>
        <testcase name="user_risk_score_updates_on_chargeback_confirmation" file="C:\PreIPO\backend\tests\Feature\ChargebackInvariantsTest.php" line="82" class="Tests\Feature\ChargebackInvariantsTest" classname="Tests.Feature.ChargebackInvariantsTest" assertions="4" time="0.902755"/>
        <testcase name="user_auto_blocked_when_score_exceeds_threshold" file="C:\PreIPO\backend\tests\Feature\ChargebackInvariantsTest.php" line="99" class="Tests\Feature\ChargebackInvariantsTest" classname="Tests.Feature.ChargebackInvariantsTest" assertions="3" time="1.038377"/>
        <testcase name="chargeback_confirmed_event_not_dispatched_for_orphan_payment" file="C:\PreIPO\backend\tests\Feature\ChargebackInvariantsTest.php" line="59" class="Tests\Feature\ChargebackInvariantsTest" classname="Tests.Feature.ChargebackInvariantsTest" assertions="1" time="0.900354"/>
        <testcase name="chargeback_confirmation_is_terminal_state" file="C:\PreIPO\backend\tests\Feature\ChargebackInvariantsTest.php" line="120" class="Tests\Feature\ChargebackInvariantsTest" classname="Tests.Feature.ChargebackInvariantsTest" assertions="2" time="0.921778"/>
        <testcase name="concurrent_chargeback_processing_is_safe" file="C:\PreIPO\backend\tests\Feature\ChargebackInvariantsTest.php" line="211" class="Tests\Feature\ChargebackInvariantsTest" classname="Tests.Feature.ChargebackInvariantsTest" assertions="1" time="1.005615"/>
        <testcase name="duplicate_chargeback_confirmation_is_idempotent" file="C:\PreIPO\backend\tests\Feature\ChargebackInvariantsTest.php" line="144" class="Tests\Feature\ChargebackInvariantsTest" classname="Tests.Feature.ChargebackInvariantsTest" assertions="1" time="0.978190"/>
        <testcase name="no_negative_wallet_balance_after_chargeback" file="C:\PreIPO\backend\tests\Feature\ChargebackInvariantsTest.php" line="195" class="Tests\Feature\ChargebackInvariantsTest" classname="Tests.Feature.ChargebackInvariantsTest" assertions="2" time="0.923425"/>
        <testcase name="chargeback_confirmed_event_is_dispatched_on_confirmation" file="C:\PreIPO\backend\tests\Feature\ChargebackInvariantsTest.php" line="32" class="Tests\Feature\ChargebackInvariantsTest" classname="Tests.Feature.ChargebackInvariantsTest" assertions="1" time="0.917487"/>
      </testsuite>
      <testsuite name="Tests\Feature\EdgeCaseResilienceTest" file="C:\PreIPO\backend\tests\Feature\EdgeCaseResilienceTest.php" tests="10" assertions="5" errors="8" failures="0" skipped="0" time="15.829953">
        <testcase name="double_webhook_delivery_is_idempotent" file="C:\PreIPO\backend\tests\Feature\EdgeCaseResilienceTest.php" line="230" class="Tests\Feature\EdgeCaseResilienceTest" classname="Tests.Feature.EdgeCaseResilienceTest" assertions="0" time="1.553736">
          <error type="RuntimeException">Tests\Feature\EdgeCaseResilienceTest::double_webhook_delivery_is_idempotent&#13;
RuntimeException: Payment #4643 has NULL amount_paise. Float fallback is PROHIBITED. Data integrity violation.
&#13;
C:\PreIPO\backend\app\Models\Payment.php:495
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:804
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:741
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:670
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\EdgeCaseResilienceTest.php:246</error>
        </testcase>
        <testcase name="rapid_fire_webhooks_processed_safely" file="C:\PreIPO\backend\tests\Feature\EdgeCaseResilienceTest.php" line="460" class="Tests\Feature\EdgeCaseResilienceTest" classname="Tests.Feature.EdgeCaseResilienceTest" assertions="0" time="1.500173">
          <error type="RuntimeException">Tests\Feature\EdgeCaseResilienceTest::rapid_fire_webhooks_processed_safely&#13;
RuntimeException: Payment #4644 has NULL amount_paise. Float fallback is PROHIBITED. Data integrity violation.
&#13;
C:\PreIPO\backend\app\Models\Payment.php:495
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:804
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:741
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:670
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\EdgeCaseResilienceTest.php:477</error>
        </testcase>
        <testcase name="chargeback_during_plan_upgrade_maintains_integrity" file="C:\PreIPO\backend\tests\Feature\EdgeCaseResilienceTest.php" line="96" class="Tests\Feature\EdgeCaseResilienceTest" classname="Tests.Feature.EdgeCaseResilienceTest" assertions="1" time="1.565654">
          <error type="Illuminate\Database\QueryException">Tests\Feature\EdgeCaseResilienceTest::chargeback_during_plan_upgrade_maintains_integrity&#13;
Illuminate\Database\QueryException: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'type' in 'where clause' (Connection: mysql, SQL: select sum(`amount_paise`) as aggregate from `ledger_lines` where `type` = debit)
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:398
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3106
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3091
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3676
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3090
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3603
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3564
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\tests\Feature\EdgeCaseResilienceTest.php:542
C:\PreIPO\backend\tests\Feature\EdgeCaseResilienceTest.php:135</error>
        </testcase>
        <testcase name="concurrent_payment_and_cancel_resolves_safely" file="C:\PreIPO\backend\tests\Feature\EdgeCaseResilienceTest.php" line="290" class="Tests\Feature\EdgeCaseResilienceTest" classname="Tests.Feature.EdgeCaseResilienceTest" assertions="0" time="1.565806">
          <error type="RuntimeException">Tests\Feature\EdgeCaseResilienceTest::concurrent_payment_and_cancel_resolves_safely&#13;
RuntimeException: Payment #4651 has NULL amount_paise. Float fallback is PROHIBITED. Data integrity violation.
&#13;
C:\PreIPO\backend\app\Models\Payment.php:495
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:804
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:741
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:670
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\EdgeCaseResilienceTest.php:306</error>
        </testcase>
        <testcase name="refund_after_bonus_claws_back_correctly" file="C:\PreIPO\backend\tests\Feature\EdgeCaseResilienceTest.php" line="143" class="Tests\Feature\EdgeCaseResilienceTest" classname="Tests.Feature.EdgeCaseResilienceTest" assertions="0" time="1.527243">
          <error type="RuntimeException">Tests\Feature\EdgeCaseResilienceTest::refund_after_bonus_claws_back_correctly&#13;
RuntimeException: Subscription #3501 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:80
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:56
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\Dispatchable.php:19
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:74
C:\PreIPO\backend\app\Services\IdempotencyService.php:206
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:52
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\DatabaseTransactionsManager.php:39
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:51
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:751
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\EdgeCaseResilienceTest.php:157</error>
        </testcase>
        <testcase name="chargeback_on_already_chargebacked_payment_rejected" file="C:\PreIPO\backend\tests\Feature\EdgeCaseResilienceTest.php" line="330" class="Tests\Feature\EdgeCaseResilienceTest" classname="Tests.Feature.EdgeCaseResilienceTest" assertions="3" time="1.525816"/>
        <testcase name="investment_exceeding_inventory_handled_gracefully" file="C:\PreIPO\backend\tests\Feature\EdgeCaseResilienceTest.php" line="402" class="Tests\Feature\EdgeCaseResilienceTest" classname="Tests.Feature.EdgeCaseResilienceTest" assertions="0" time="1.668150">
          <error type="RuntimeException">Tests\Feature\EdgeCaseResilienceTest::investment_exceeding_inventory_handled_gracefully&#13;
RuntimeException: Subscription #3504 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:80
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:56
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\Dispatchable.php:19
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:74
C:\PreIPO\backend\app\Services\IdempotencyService.php:206
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:52
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\DatabaseTransactionsManager.php:39
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:51
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:751
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\EdgeCaseResilienceTest.php:429</error>
        </testcase>
        <testcase name="subscription_cancel_during_retry_stops_retries" file="C:\PreIPO\backend\tests\Feature\EdgeCaseResilienceTest.php" line="201" class="Tests\Feature\EdgeCaseResilienceTest" classname="Tests.Feature.EdgeCaseResilienceTest" assertions="1" time="1.624283"/>
        <testcase name="payment_during_pause_handled_correctly" file="C:\PreIPO\backend\tests\Feature\EdgeCaseResilienceTest.php" line="369" class="Tests\Feature\EdgeCaseResilienceTest" classname="Tests.Feature.EdgeCaseResilienceTest" assertions="0" time="1.665135">
          <error type="RuntimeException">Tests\Feature\EdgeCaseResilienceTest::payment_during_pause_handled_correctly&#13;
RuntimeException: Payment #4659 has NULL amount_paise. Float fallback is PROHIBITED. Data integrity violation.
&#13;
C:\PreIPO\backend\app\Models\Payment.php:495
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:804
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:741
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:670
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\EdgeCaseResilienceTest.php:382</error>
        </testcase>
        <testcase name="refund_larger_than_payment_rejected" file="C:\PreIPO\backend\tests\Feature\EdgeCaseResilienceTest.php" line="505" class="Tests\Feature\EdgeCaseResilienceTest" classname="Tests.Feature.EdgeCaseResilienceTest" assertions="0" time="1.633957">
          <error type="Error">Tests\Feature\EdgeCaseResilienceTest::refund_larger_than_payment_rejected&#13;
Error: Call to undefined method App\Services\PaymentWebhookService::handleRefund()
&#13;
C:\PreIPO\backend\tests\Feature\EdgeCaseResilienceTest.php:520</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\WithdrawalRequestTest" file="C:\PreIPO\backend\tests\Feature\WithdrawalRequestTest.php" tests="6" assertions="6" errors="1" failures="4" skipped="0" time="5.952852">
        <testcase name="test_validates_kyc_approved" file="C:\PreIPO\backend\tests\Feature\WithdrawalRequestTest.php" line="75" class="Tests\Feature\WithdrawalRequestTest" classname="Tests.Feature.WithdrawalRequestTest" assertions="2" time="0.986187"/>
        <testcase name="test_validates_amount_minimum" file="C:\PreIPO\backend\tests\Feature\WithdrawalRequestTest.php" line="53" class="Tests\Feature\WithdrawalRequestTest" classname="Tests.Feature.WithdrawalRequestTest" assertions="1" time="0.954136">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\WithdrawalRequestTest::test_validates_amount_minimum&#13;
Expected response status code [422] but received 500.
Failed asserting that 500 is identical to 422.&#13;
&#13;
The following exception occurred during the last request:

PDOException: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' in C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:407
Stack trace:
#0 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(407): PDO-&gt;prepare('select sum(`amo...')
#1 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(812): Illuminate\Database\Connection-&gt;Illuminate\Database\{closure}('select sum(`amo...', Array)
#2 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(779): Illuminate\Database\Connection-&gt;runQueryCallback('select sum(`amo...', Array, Object(Closure))
#3 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(398): Illuminate\Database\Connection-&gt;run('select sum(`amo...', Array, Object(Closure))
#4 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3106): Illuminate\Database\Connection-&gt;select('select sum(`amo...', Array, true)
#5 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3091): Illuminate\Database\Query\Builder-&gt;runSelect()
#6 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3676): Illuminate\Database\Query\Builder-&gt;Illuminate\Database\Query\{closure}()
#7 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3090): Illuminate\Database\Query\Builder-&gt;onceWithColumns(Array, Object(Closure))
#8 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3603): Illuminate\Database\Query\Builder-&gt;get(Array)
#9 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3564): Illuminate\Database\Query\Builder-&gt;aggregate('sum', Array)
#10 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php(2120): Illuminate\Database\Query\Builder-&gt;sum('amount')
#11 C:\PreIPO\backend\app\Http\Requests\User\WithdrawalRequest.php(70): Illuminate\Database\Eloquent\Builder-&gt;__call('sum', Array)
#12 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(450): App\Http\Requests\User\WithdrawalRequest-&gt;App\Http\Requests\User\{closure}(Object(Illuminate\Validation\Validator))
#13 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(503): Illuminate\Validation\Validator-&gt;Illuminate\Validation\{closure}()
#14 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(516): Illuminate\Validation\Validator-&gt;passes()
#15 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\ValidatesWhenResolvedTrait.php(31): Illuminate\Validation\Validator-&gt;fails()
#16 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Providers\FormRequestServiceProvider.php(30): Illuminate\Foundation\Http\FormRequest-&gt;validateResolved()
#17 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1432): Illuminate\Foundation\Providers\FormRequestServiceProvider-&gt;Illuminate\Foundation\Providers\{closure}(Object(App\Http\Requests\User\WithdrawalRequest), Object(Illuminate\Foundation\Application))
#18 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1368): Illuminate\Container\Container-&gt;fireCallbackArray(Object(App\Http\Requests\User\WithdrawalRequest), Array)
#19 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1354): Illuminate\Container\Container-&gt;fireAfterResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#20 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(850): Illuminate\Container\Container-&gt;fireResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#21 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1078): Illuminate\Container\Container-&gt;resolve('App\\Http\\Reques...', Array, true)
#22 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(763): Illuminate\Foundation\Application-&gt;resolve('App\\Http\\Reques...', Array)
#23 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1058): Illuminate\Container\Container-&gt;make('App\\Http\\Reques...', Array)
#24 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(92): Illuminate\Foundation\Application-&gt;make('App\\Http\\Reques...')
#25 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(51): Illuminate\Routing\ControllerDispatcher-&gt;transformDependency(Object(ReflectionParameter), Array, Object(stdClass))
#26 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(30): Illuminate\Routing\ControllerDispatcher-&gt;resolveMethodDependencies(Array, Object(ReflectionMethod))
#27 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(60): Illuminate\Routing\ControllerDispatcher-&gt;resolveClassMethodDependencies(Array, Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#28 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(41): Illuminate\Routing\ControllerDispatcher-&gt;resolveParameters(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#29 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(266): Illuminate\Routing\ControllerDispatcher-&gt;dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#30 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(212): Illuminate\Routing\Route-&gt;runController()
#31 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(808): Illuminate\Routing\Route-&gt;run()
#32 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Routing\Router-&gt;Illuminate\Routing\{closure}(Object(Illuminate\Http\Request))
#33 C:\PreIPO\backend\app\Http\Middleware\EnsureMfaVerified.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#34 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\EnsureMfaVerified-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#35 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#36 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#37 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(161): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#38 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(127): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequest(Object(Illuminate\Http\Request), Object(Closure), Array)
#39 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(89): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequestUsingNamedLimiter(Object(Illuminate\Http\Request), Object(Closure), 'financial', Object(Closure))
#40 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'financial')
#41 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Auth\Middleware\Authenticate.php(64): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'sanctum')
#43 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#44 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(807): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#45 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(786): Illuminate\Routing\Router-&gt;runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#46 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(750): Illuminate\Routing\Router-&gt;runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#47 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(739): Illuminate\Routing\Router-&gt;dispatchToRoute(Object(Illuminate\Http\Request))
#48 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(201): Illuminate\Routing\Router-&gt;dispatch(Object(Illuminate\Http\Request))
#49 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Foundation\Http\Kernel-&gt;Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#50 C:\PreIPO\backend\app\Http\Middleware\RedirectMiddleware.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#51 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\RedirectMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#52 C:\PreIPO\backend\app\Http\Middleware\CheckMaintenanceMode.php(48): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#53 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckMaintenanceMode-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#54 C:\PreIPO\backend\app\Http\Middleware\SanitizeInput.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#55 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\SanitizeInput-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#56 C:\PreIPO\backend\app\Http\Middleware\ForceHttps.php(23): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#57 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\ForceHttps-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#58 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#59 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#60 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#61 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#62 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#63 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#64 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#65 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#66 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#67 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#68 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#69 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#70 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\HandleCors.php(62): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#71 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\HandleCors-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#72 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#73 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#74 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#75 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#76 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#77 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(176): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#78 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(145): Illuminate\Foundation\Http\Kernel-&gt;sendRequestThroughRouter(Object(Illuminate\Http\Request))
#79 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel-&gt;handle(Object(Illuminate\Http\Request))
#80 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase-&gt;call('POST', '/api/v1/user/wa...', Array, Array, Array, Array, '{"amount":500,"...')
#81 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase-&gt;json('POST', '/api/v1/user/wa...', Array, Array, 0)
#82 C:\PreIPO\backend\tests\Feature\WithdrawalRequestTest.php(55): Illuminate\Foundation\Testing\TestCase-&gt;postJson('/api/v1/user/wa...', Array)
#83 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(1667): Tests\Feature\WithdrawalRequestTest-&gt;test_validates_amount_minimum()
#84 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(519): PHPUnit\Framework\TestCase-&gt;runTest()
#85 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestRunner\TestRunner.php(87): PHPUnit\Framework\TestCase-&gt;runBare()
#86 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(365): PHPUnit\Framework\TestRunner-&gt;run(Object(Tests\Feature\WithdrawalRequestTest))
#87 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestCase-&gt;run()
#88 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#89 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#90 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\TestRunner.php(64): PHPUnit\Framework\TestSuite-&gt;run()
#91 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\Application.php(211): PHPUnit\TextUI\TestRunner-&gt;run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#92 C:\PreIPO\backend\vendor\phpunit\phpunit\phpunit(104): PHPUnit\TextUI\Application-&gt;run(Array)
#93 {main}

Next Illuminate\Database\QueryException: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' (Connection: mysql, SQL: select sum(`amount`) as aggregate from `withdrawals` where `user_id` = 15228 and `status` != rejected and date(`created_at`) = 2026-02-22) in C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
Stack trace:
#0 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(779): Illuminate\Database\Connection-&gt;runQueryCallback('select sum(`amo...', Array, Object(Closure))
#1 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(398): Illuminate\Database\Connection-&gt;run('select sum(`amo...', Array, Object(Closure))
#2 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3106): Illuminate\Database\Connection-&gt;select('select sum(`amo...', Array, true)
#3 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3091): Illuminate\Database\Query\Builder-&gt;runSelect()
#4 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3676): Illuminate\Database\Query\Builder-&gt;Illuminate\Database\Query\{closure}()
#5 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3090): Illuminate\Database\Query\Builder-&gt;onceWithColumns(Array, Object(Closure))
#6 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3603): Illuminate\Database\Query\Builder-&gt;get(Array)
#7 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3564): Illuminate\Database\Query\Builder-&gt;aggregate('sum', Array)
#8 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php(2120): Illuminate\Database\Query\Builder-&gt;sum('amount')
#9 C:\PreIPO\backend\app\Http\Requests\User\WithdrawalRequest.php(70): Illuminate\Database\Eloquent\Builder-&gt;__call('sum', Array)
#10 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(450): App\Http\Requests\User\WithdrawalRequest-&gt;App\Http\Requests\User\{closure}(Object(Illuminate\Validation\Validator))
#11 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(503): Illuminate\Validation\Validator-&gt;Illuminate\Validation\{closure}()
#12 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(516): Illuminate\Validation\Validator-&gt;passes()
#13 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\ValidatesWhenResolvedTrait.php(31): Illuminate\Validation\Validator-&gt;fails()
#14 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Providers\FormRequestServiceProvider.php(30): Illuminate\Foundation\Http\FormRequest-&gt;validateResolved()
#15 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1432): Illuminate\Foundation\Providers\FormRequestServiceProvider-&gt;Illuminate\Foundation\Providers\{closure}(Object(App\Http\Requests\User\WithdrawalRequest), Object(Illuminate\Foundation\Application))
#16 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1368): Illuminate\Container\Container-&gt;fireCallbackArray(Object(App\Http\Requests\User\WithdrawalRequest), Array)
#17 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1354): Illuminate\Container\Container-&gt;fireAfterResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#18 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(850): Illuminate\Container\Container-&gt;fireResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#19 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1078): Illuminate\Container\Container-&gt;resolve('App\\Http\\Reques...', Array, true)
#20 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(763): Illuminate\Foundation\Application-&gt;resolve('App\\Http\\Reques...', Array)
#21 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1058): Illuminate\Container\Container-&gt;make('App\\Http\\Reques...', Array)
#22 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(92): Illuminate\Foundation\Application-&gt;make('App\\Http\\Reques...')
#23 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(51): Illuminate\Routing\ControllerDispatcher-&gt;transformDependency(Object(ReflectionParameter), Array, Object(stdClass))
#24 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(30): Illuminate\Routing\ControllerDispatcher-&gt;resolveMethodDependencies(Array, Object(ReflectionMethod))
#25 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(60): Illuminate\Routing\ControllerDispatcher-&gt;resolveClassMethodDependencies(Array, Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#26 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(41): Illuminate\Routing\ControllerDispatcher-&gt;resolveParameters(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#27 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(266): Illuminate\Routing\ControllerDispatcher-&gt;dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#28 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(212): Illuminate\Routing\Route-&gt;runController()
#29 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(808): Illuminate\Routing\Route-&gt;run()
#30 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Routing\Router-&gt;Illuminate\Routing\{closure}(Object(Illuminate\Http\Request))
#31 C:\PreIPO\backend\app\Http\Middleware\EnsureMfaVerified.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#32 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\EnsureMfaVerified-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#33 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#34 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#35 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(161): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#36 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(127): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequest(Object(Illuminate\Http\Request), Object(Closure), Array)
#37 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(89): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequestUsingNamedLimiter(Object(Illuminate\Http\Request), Object(Closure), 'financial', Object(Closure))
#38 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'financial')
#39 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Auth\Middleware\Authenticate.php(64): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#40 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'sanctum')
#41 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(807): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#43 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(786): Illuminate\Routing\Router-&gt;runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#44 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(750): Illuminate\Routing\Router-&gt;runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#45 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(739): Illuminate\Routing\Router-&gt;dispatchToRoute(Object(Illuminate\Http\Request))
#46 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(201): Illuminate\Routing\Router-&gt;dispatch(Object(Illuminate\Http\Request))
#47 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Foundation\Http\Kernel-&gt;Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#48 C:\PreIPO\backend\app\Http\Middleware\RedirectMiddleware.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#49 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\RedirectMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#50 C:\PreIPO\backend\app\Http\Middleware\CheckMaintenanceMode.php(48): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#51 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckMaintenanceMode-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#52 C:\PreIPO\backend\app\Http\Middleware\SanitizeInput.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#53 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\SanitizeInput-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#54 C:\PreIPO\backend\app\Http\Middleware\ForceHttps.php(23): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#55 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\ForceHttps-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#56 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#57 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#58 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#59 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#60 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#61 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#62 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#63 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#64 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#65 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#66 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#67 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#68 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\HandleCors.php(62): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#69 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\HandleCors-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#70 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#71 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#72 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#73 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#74 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#75 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(176): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#76 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(145): Illuminate\Foundation\Http\Kernel-&gt;sendRequestThroughRouter(Object(Illuminate\Http\Request))
#77 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel-&gt;handle(Object(Illuminate\Http\Request))
#78 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase-&gt;call('POST', '/api/v1/user/wa...', Array, Array, Array, Array, '{"amount":500,"...')
#79 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase-&gt;json('POST', '/api/v1/user/wa...', Array, Array, 0)
#80 C:\PreIPO\backend\tests\Feature\WithdrawalRequestTest.php(55): Illuminate\Foundation\Testing\TestCase-&gt;postJson('/api/v1/user/wa...', Array)
#81 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(1667): Tests\Feature\WithdrawalRequestTest-&gt;test_validates_amount_minimum()
#82 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(519): PHPUnit\Framework\TestCase-&gt;runTest()
#83 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestRunner\TestRunner.php(87): PHPUnit\Framework\TestCase-&gt;runBare()
#84 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(365): PHPUnit\Framework\TestRunner-&gt;run(Object(Tests\Feature\WithdrawalRequestTest))
#85 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestCase-&gt;run()
#86 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#87 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#88 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\TestRunner.php(64): PHPUnit\Framework\TestSuite-&gt;run()
#89 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\Application.php(211): PHPUnit\TextUI\TestRunner-&gt;run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#90 C:\PreIPO\backend\vendor\phpunit\phpunit\phpunit(104): PHPUnit\TextUI\Application-&gt;run(Array)
#91 {main}

----------------------------------------------------------------------------------

SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' (Connection: mysql, SQL: select sum(`amount`) as aggregate from `withdrawals` where `user_id` = 15228 and `status` != rejected and date(`created_at`) = 2026-02-22)
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\WithdrawalRequestTest.php:59</failure>
        </testcase>
        <testcase name="test_validates_sufficient_balance" file="C:\PreIPO\backend\tests\Feature\WithdrawalRequestTest.php" line="64" class="Tests\Feature\WithdrawalRequestTest" classname="Tests.Feature.WithdrawalRequestTest" assertions="1" time="1.016849">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\WithdrawalRequestTest::test_validates_sufficient_balance&#13;
Expected response status code [422] but received 500.
Failed asserting that 500 is identical to 422.&#13;
&#13;
The following exception occurred during the last request:

PDOException: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' in C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:407
Stack trace:
#0 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(407): PDO-&gt;prepare('select sum(`amo...')
#1 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(812): Illuminate\Database\Connection-&gt;Illuminate\Database\{closure}('select sum(`amo...', Array)
#2 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(779): Illuminate\Database\Connection-&gt;runQueryCallback('select sum(`amo...', Array, Object(Closure))
#3 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(398): Illuminate\Database\Connection-&gt;run('select sum(`amo...', Array, Object(Closure))
#4 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3106): Illuminate\Database\Connection-&gt;select('select sum(`amo...', Array, true)
#5 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3091): Illuminate\Database\Query\Builder-&gt;runSelect()
#6 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3676): Illuminate\Database\Query\Builder-&gt;Illuminate\Database\Query\{closure}()
#7 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3090): Illuminate\Database\Query\Builder-&gt;onceWithColumns(Array, Object(Closure))
#8 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3603): Illuminate\Database\Query\Builder-&gt;get(Array)
#9 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3564): Illuminate\Database\Query\Builder-&gt;aggregate('sum', Array)
#10 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php(2120): Illuminate\Database\Query\Builder-&gt;sum('amount')
#11 C:\PreIPO\backend\app\Http\Requests\User\WithdrawalRequest.php(70): Illuminate\Database\Eloquent\Builder-&gt;__call('sum', Array)
#12 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(450): App\Http\Requests\User\WithdrawalRequest-&gt;App\Http\Requests\User\{closure}(Object(Illuminate\Validation\Validator))
#13 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(503): Illuminate\Validation\Validator-&gt;Illuminate\Validation\{closure}()
#14 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(516): Illuminate\Validation\Validator-&gt;passes()
#15 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\ValidatesWhenResolvedTrait.php(31): Illuminate\Validation\Validator-&gt;fails()
#16 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Providers\FormRequestServiceProvider.php(30): Illuminate\Foundation\Http\FormRequest-&gt;validateResolved()
#17 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1432): Illuminate\Foundation\Providers\FormRequestServiceProvider-&gt;Illuminate\Foundation\Providers\{closure}(Object(App\Http\Requests\User\WithdrawalRequest), Object(Illuminate\Foundation\Application))
#18 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1368): Illuminate\Container\Container-&gt;fireCallbackArray(Object(App\Http\Requests\User\WithdrawalRequest), Array)
#19 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1354): Illuminate\Container\Container-&gt;fireAfterResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#20 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(850): Illuminate\Container\Container-&gt;fireResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#21 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1078): Illuminate\Container\Container-&gt;resolve('App\\Http\\Reques...', Array, true)
#22 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(763): Illuminate\Foundation\Application-&gt;resolve('App\\Http\\Reques...', Array)
#23 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1058): Illuminate\Container\Container-&gt;make('App\\Http\\Reques...', Array)
#24 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(92): Illuminate\Foundation\Application-&gt;make('App\\Http\\Reques...')
#25 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(51): Illuminate\Routing\ControllerDispatcher-&gt;transformDependency(Object(ReflectionParameter), Array, Object(stdClass))
#26 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(30): Illuminate\Routing\ControllerDispatcher-&gt;resolveMethodDependencies(Array, Object(ReflectionMethod))
#27 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(60): Illuminate\Routing\ControllerDispatcher-&gt;resolveClassMethodDependencies(Array, Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#28 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(41): Illuminate\Routing\ControllerDispatcher-&gt;resolveParameters(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#29 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(266): Illuminate\Routing\ControllerDispatcher-&gt;dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#30 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(212): Illuminate\Routing\Route-&gt;runController()
#31 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(808): Illuminate\Routing\Route-&gt;run()
#32 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Routing\Router-&gt;Illuminate\Routing\{closure}(Object(Illuminate\Http\Request))
#33 C:\PreIPO\backend\app\Http\Middleware\EnsureMfaVerified.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#34 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\EnsureMfaVerified-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#35 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#36 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#37 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(161): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#38 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(127): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequest(Object(Illuminate\Http\Request), Object(Closure), Array)
#39 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(89): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequestUsingNamedLimiter(Object(Illuminate\Http\Request), Object(Closure), 'financial', Object(Closure))
#40 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'financial')
#41 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Auth\Middleware\Authenticate.php(64): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'sanctum')
#43 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#44 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(807): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#45 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(786): Illuminate\Routing\Router-&gt;runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#46 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(750): Illuminate\Routing\Router-&gt;runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#47 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(739): Illuminate\Routing\Router-&gt;dispatchToRoute(Object(Illuminate\Http\Request))
#48 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(201): Illuminate\Routing\Router-&gt;dispatch(Object(Illuminate\Http\Request))
#49 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Foundation\Http\Kernel-&gt;Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#50 C:\PreIPO\backend\app\Http\Middleware\RedirectMiddleware.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#51 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\RedirectMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#52 C:\PreIPO\backend\app\Http\Middleware\CheckMaintenanceMode.php(48): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#53 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckMaintenanceMode-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#54 C:\PreIPO\backend\app\Http\Middleware\SanitizeInput.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#55 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\SanitizeInput-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#56 C:\PreIPO\backend\app\Http\Middleware\ForceHttps.php(23): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#57 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\ForceHttps-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#58 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#59 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#60 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#61 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#62 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#63 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#64 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#65 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#66 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#67 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#68 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#69 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#70 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\HandleCors.php(62): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#71 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\HandleCors-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#72 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#73 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#74 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#75 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#76 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#77 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(176): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#78 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(145): Illuminate\Foundation\Http\Kernel-&gt;sendRequestThroughRouter(Object(Illuminate\Http\Request))
#79 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel-&gt;handle(Object(Illuminate\Http\Request))
#80 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase-&gt;call('POST', '/api/v1/user/wa...', Array, Array, Array, Array, '{"amount":20000...')
#81 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase-&gt;json('POST', '/api/v1/user/wa...', Array, Array, 0)
#82 C:\PreIPO\backend\tests\Feature\WithdrawalRequestTest.php(66): Illuminate\Foundation\Testing\TestCase-&gt;postJson('/api/v1/user/wa...', Array)
#83 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(1667): Tests\Feature\WithdrawalRequestTest-&gt;test_validates_sufficient_balance()
#84 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(519): PHPUnit\Framework\TestCase-&gt;runTest()
#85 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestRunner\TestRunner.php(87): PHPUnit\Framework\TestCase-&gt;runBare()
#86 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(365): PHPUnit\Framework\TestRunner-&gt;run(Object(Tests\Feature\WithdrawalRequestTest))
#87 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestCase-&gt;run()
#88 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#89 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#90 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\TestRunner.php(64): PHPUnit\Framework\TestSuite-&gt;run()
#91 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\Application.php(211): PHPUnit\TextUI\TestRunner-&gt;run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#92 C:\PreIPO\backend\vendor\phpunit\phpunit\phpunit(104): PHPUnit\TextUI\Application-&gt;run(Array)
#93 {main}

Next Illuminate\Database\QueryException: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' (Connection: mysql, SQL: select sum(`amount`) as aggregate from `withdrawals` where `user_id` = 15233 and `status` != rejected and date(`created_at`) = 2026-02-22) in C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
Stack trace:
#0 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(779): Illuminate\Database\Connection-&gt;runQueryCallback('select sum(`amo...', Array, Object(Closure))
#1 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(398): Illuminate\Database\Connection-&gt;run('select sum(`amo...', Array, Object(Closure))
#2 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3106): Illuminate\Database\Connection-&gt;select('select sum(`amo...', Array, true)
#3 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3091): Illuminate\Database\Query\Builder-&gt;runSelect()
#4 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3676): Illuminate\Database\Query\Builder-&gt;Illuminate\Database\Query\{closure}()
#5 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3090): Illuminate\Database\Query\Builder-&gt;onceWithColumns(Array, Object(Closure))
#6 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3603): Illuminate\Database\Query\Builder-&gt;get(Array)
#7 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3564): Illuminate\Database\Query\Builder-&gt;aggregate('sum', Array)
#8 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php(2120): Illuminate\Database\Query\Builder-&gt;sum('amount')
#9 C:\PreIPO\backend\app\Http\Requests\User\WithdrawalRequest.php(70): Illuminate\Database\Eloquent\Builder-&gt;__call('sum', Array)
#10 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(450): App\Http\Requests\User\WithdrawalRequest-&gt;App\Http\Requests\User\{closure}(Object(Illuminate\Validation\Validator))
#11 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(503): Illuminate\Validation\Validator-&gt;Illuminate\Validation\{closure}()
#12 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(516): Illuminate\Validation\Validator-&gt;passes()
#13 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\ValidatesWhenResolvedTrait.php(31): Illuminate\Validation\Validator-&gt;fails()
#14 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Providers\FormRequestServiceProvider.php(30): Illuminate\Foundation\Http\FormRequest-&gt;validateResolved()
#15 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1432): Illuminate\Foundation\Providers\FormRequestServiceProvider-&gt;Illuminate\Foundation\Providers\{closure}(Object(App\Http\Requests\User\WithdrawalRequest), Object(Illuminate\Foundation\Application))
#16 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1368): Illuminate\Container\Container-&gt;fireCallbackArray(Object(App\Http\Requests\User\WithdrawalRequest), Array)
#17 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1354): Illuminate\Container\Container-&gt;fireAfterResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#18 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(850): Illuminate\Container\Container-&gt;fireResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#19 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1078): Illuminate\Container\Container-&gt;resolve('App\\Http\\Reques...', Array, true)
#20 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(763): Illuminate\Foundation\Application-&gt;resolve('App\\Http\\Reques...', Array)
#21 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1058): Illuminate\Container\Container-&gt;make('App\\Http\\Reques...', Array)
#22 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(92): Illuminate\Foundation\Application-&gt;make('App\\Http\\Reques...')
#23 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(51): Illuminate\Routing\ControllerDispatcher-&gt;transformDependency(Object(ReflectionParameter), Array, Object(stdClass))
#24 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(30): Illuminate\Routing\ControllerDispatcher-&gt;resolveMethodDependencies(Array, Object(ReflectionMethod))
#25 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(60): Illuminate\Routing\ControllerDispatcher-&gt;resolveClassMethodDependencies(Array, Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#26 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(41): Illuminate\Routing\ControllerDispatcher-&gt;resolveParameters(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#27 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(266): Illuminate\Routing\ControllerDispatcher-&gt;dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#28 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(212): Illuminate\Routing\Route-&gt;runController()
#29 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(808): Illuminate\Routing\Route-&gt;run()
#30 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Routing\Router-&gt;Illuminate\Routing\{closure}(Object(Illuminate\Http\Request))
#31 C:\PreIPO\backend\app\Http\Middleware\EnsureMfaVerified.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#32 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\EnsureMfaVerified-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#33 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#34 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#35 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(161): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#36 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(127): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequest(Object(Illuminate\Http\Request), Object(Closure), Array)
#37 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(89): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequestUsingNamedLimiter(Object(Illuminate\Http\Request), Object(Closure), 'financial', Object(Closure))
#38 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'financial')
#39 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Auth\Middleware\Authenticate.php(64): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#40 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'sanctum')
#41 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(807): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#43 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(786): Illuminate\Routing\Router-&gt;runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#44 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(750): Illuminate\Routing\Router-&gt;runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#45 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(739): Illuminate\Routing\Router-&gt;dispatchToRoute(Object(Illuminate\Http\Request))
#46 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(201): Illuminate\Routing\Router-&gt;dispatch(Object(Illuminate\Http\Request))
#47 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Foundation\Http\Kernel-&gt;Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#48 C:\PreIPO\backend\app\Http\Middleware\RedirectMiddleware.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#49 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\RedirectMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#50 C:\PreIPO\backend\app\Http\Middleware\CheckMaintenanceMode.php(48): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#51 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckMaintenanceMode-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#52 C:\PreIPO\backend\app\Http\Middleware\SanitizeInput.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#53 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\SanitizeInput-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#54 C:\PreIPO\backend\app\Http\Middleware\ForceHttps.php(23): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#55 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\ForceHttps-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#56 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#57 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#58 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#59 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#60 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#61 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#62 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#63 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#64 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#65 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#66 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#67 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#68 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\HandleCors.php(62): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#69 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\HandleCors-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#70 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#71 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#72 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#73 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#74 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#75 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(176): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#76 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(145): Illuminate\Foundation\Http\Kernel-&gt;sendRequestThroughRouter(Object(Illuminate\Http\Request))
#77 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel-&gt;handle(Object(Illuminate\Http\Request))
#78 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase-&gt;call('POST', '/api/v1/user/wa...', Array, Array, Array, Array, '{"amount":20000...')
#79 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase-&gt;json('POST', '/api/v1/user/wa...', Array, Array, 0)
#80 C:\PreIPO\backend\tests\Feature\WithdrawalRequestTest.php(66): Illuminate\Foundation\Testing\TestCase-&gt;postJson('/api/v1/user/wa...', Array)
#81 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(1667): Tests\Feature\WithdrawalRequestTest-&gt;test_validates_sufficient_balance()
#82 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(519): PHPUnit\Framework\TestCase-&gt;runTest()
#83 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestRunner\TestRunner.php(87): PHPUnit\Framework\TestCase-&gt;runBare()
#84 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(365): PHPUnit\Framework\TestRunner-&gt;run(Object(Tests\Feature\WithdrawalRequestTest))
#85 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestCase-&gt;run()
#86 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#87 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#88 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\TestRunner.php(64): PHPUnit\Framework\TestSuite-&gt;run()
#89 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\Application.php(211): PHPUnit\TextUI\TestRunner-&gt;run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#90 C:\PreIPO\backend\vendor\phpunit\phpunit\phpunit(104): PHPUnit\TextUI\Application-&gt;run(Array)
#91 {main}

----------------------------------------------------------------------------------

SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' (Connection: mysql, SQL: select sum(`amount`) as aggregate from `withdrawals` where `user_id` = 15233 and `status` != rejected and date(`created_at`) = 2026-02-22)
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\WithdrawalRequestTest.php:70</failure>
        </testcase>
        <testcase name="test_validates_withdrawal_limit_per_day" file="C:\PreIPO\backend\tests\Feature\WithdrawalRequestTest.php" line="99" class="Tests\Feature\WithdrawalRequestTest" classname="Tests.Feature.WithdrawalRequestTest" assertions="0" time="0.998771">
          <error type="ArgumentCountError">Tests\Feature\WithdrawalRequestTest::test_validates_withdrawal_limit_per_day&#13;
ArgumentCountError: Too few arguments to function App\Services\WithdrawalService::__construct(), 0 passed in C:\PreIPO\backend\tests\Feature\WithdrawalRequestTest.php on line 102 and exactly 1 expected
&#13;
C:\PreIPO\backend\app\Services\WithdrawalService.php:81
C:\PreIPO\backend\tests\Feature\WithdrawalRequestTest.php:102</error>
        </testcase>
        <testcase name="test_validates_amount_positive" file="C:\PreIPO\backend\tests\Feature\WithdrawalRequestTest.php" line="42" class="Tests\Feature\WithdrawalRequestTest" classname="Tests.Feature.WithdrawalRequestTest" assertions="1" time="0.984319">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\WithdrawalRequestTest::test_validates_amount_positive&#13;
Expected response status code [422] but received 500.
Failed asserting that 500 is identical to 422.&#13;
&#13;
The following exception occurred during the last request:

PDOException: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' in C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:407
Stack trace:
#0 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(407): PDO-&gt;prepare('select sum(`amo...')
#1 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(812): Illuminate\Database\Connection-&gt;Illuminate\Database\{closure}('select sum(`amo...', Array)
#2 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(779): Illuminate\Database\Connection-&gt;runQueryCallback('select sum(`amo...', Array, Object(Closure))
#3 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(398): Illuminate\Database\Connection-&gt;run('select sum(`amo...', Array, Object(Closure))
#4 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3106): Illuminate\Database\Connection-&gt;select('select sum(`amo...', Array, true)
#5 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3091): Illuminate\Database\Query\Builder-&gt;runSelect()
#6 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3676): Illuminate\Database\Query\Builder-&gt;Illuminate\Database\Query\{closure}()
#7 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3090): Illuminate\Database\Query\Builder-&gt;onceWithColumns(Array, Object(Closure))
#8 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3603): Illuminate\Database\Query\Builder-&gt;get(Array)
#9 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3564): Illuminate\Database\Query\Builder-&gt;aggregate('sum', Array)
#10 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php(2120): Illuminate\Database\Query\Builder-&gt;sum('amount')
#11 C:\PreIPO\backend\app\Http\Requests\User\WithdrawalRequest.php(70): Illuminate\Database\Eloquent\Builder-&gt;__call('sum', Array)
#12 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(450): App\Http\Requests\User\WithdrawalRequest-&gt;App\Http\Requests\User\{closure}(Object(Illuminate\Validation\Validator))
#13 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(503): Illuminate\Validation\Validator-&gt;Illuminate\Validation\{closure}()
#14 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(516): Illuminate\Validation\Validator-&gt;passes()
#15 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\ValidatesWhenResolvedTrait.php(31): Illuminate\Validation\Validator-&gt;fails()
#16 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Providers\FormRequestServiceProvider.php(30): Illuminate\Foundation\Http\FormRequest-&gt;validateResolved()
#17 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1432): Illuminate\Foundation\Providers\FormRequestServiceProvider-&gt;Illuminate\Foundation\Providers\{closure}(Object(App\Http\Requests\User\WithdrawalRequest), Object(Illuminate\Foundation\Application))
#18 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1368): Illuminate\Container\Container-&gt;fireCallbackArray(Object(App\Http\Requests\User\WithdrawalRequest), Array)
#19 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1354): Illuminate\Container\Container-&gt;fireAfterResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#20 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(850): Illuminate\Container\Container-&gt;fireResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#21 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1078): Illuminate\Container\Container-&gt;resolve('App\\Http\\Reques...', Array, true)
#22 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(763): Illuminate\Foundation\Application-&gt;resolve('App\\Http\\Reques...', Array)
#23 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1058): Illuminate\Container\Container-&gt;make('App\\Http\\Reques...', Array)
#24 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(92): Illuminate\Foundation\Application-&gt;make('App\\Http\\Reques...')
#25 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(51): Illuminate\Routing\ControllerDispatcher-&gt;transformDependency(Object(ReflectionParameter), Array, Object(stdClass))
#26 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(30): Illuminate\Routing\ControllerDispatcher-&gt;resolveMethodDependencies(Array, Object(ReflectionMethod))
#27 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(60): Illuminate\Routing\ControllerDispatcher-&gt;resolveClassMethodDependencies(Array, Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#28 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(41): Illuminate\Routing\ControllerDispatcher-&gt;resolveParameters(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#29 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(266): Illuminate\Routing\ControllerDispatcher-&gt;dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#30 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(212): Illuminate\Routing\Route-&gt;runController()
#31 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(808): Illuminate\Routing\Route-&gt;run()
#32 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Routing\Router-&gt;Illuminate\Routing\{closure}(Object(Illuminate\Http\Request))
#33 C:\PreIPO\backend\app\Http\Middleware\EnsureMfaVerified.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#34 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\EnsureMfaVerified-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#35 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#36 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#37 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(161): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#38 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(127): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequest(Object(Illuminate\Http\Request), Object(Closure), Array)
#39 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(89): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequestUsingNamedLimiter(Object(Illuminate\Http\Request), Object(Closure), 'financial', Object(Closure))
#40 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'financial')
#41 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Auth\Middleware\Authenticate.php(64): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'sanctum')
#43 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#44 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(807): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#45 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(786): Illuminate\Routing\Router-&gt;runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#46 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(750): Illuminate\Routing\Router-&gt;runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#47 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(739): Illuminate\Routing\Router-&gt;dispatchToRoute(Object(Illuminate\Http\Request))
#48 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(201): Illuminate\Routing\Router-&gt;dispatch(Object(Illuminate\Http\Request))
#49 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Foundation\Http\Kernel-&gt;Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#50 C:\PreIPO\backend\app\Http\Middleware\RedirectMiddleware.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#51 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\RedirectMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#52 C:\PreIPO\backend\app\Http\Middleware\CheckMaintenanceMode.php(48): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#53 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckMaintenanceMode-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#54 C:\PreIPO\backend\app\Http\Middleware\SanitizeInput.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#55 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\SanitizeInput-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#56 C:\PreIPO\backend\app\Http\Middleware\ForceHttps.php(23): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#57 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\ForceHttps-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#58 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#59 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#60 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#61 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#62 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#63 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#64 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#65 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#66 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#67 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#68 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#69 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#70 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\HandleCors.php(62): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#71 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\HandleCors-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#72 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#73 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#74 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#75 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#76 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#77 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(176): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#78 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(145): Illuminate\Foundation\Http\Kernel-&gt;sendRequestThroughRouter(Object(Illuminate\Http\Request))
#79 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel-&gt;handle(Object(Illuminate\Http\Request))
#80 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase-&gt;call('POST', '/api/v1/user/wa...', Array, Array, Array, Array, '{"amount":-100,...')
#81 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase-&gt;json('POST', '/api/v1/user/wa...', Array, Array, 0)
#82 C:\PreIPO\backend\tests\Feature\WithdrawalRequestTest.php(44): Illuminate\Foundation\Testing\TestCase-&gt;postJson('/api/v1/user/wa...', Array)
#83 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(1667): Tests\Feature\WithdrawalRequestTest-&gt;test_validates_amount_positive()
#84 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(519): PHPUnit\Framework\TestCase-&gt;runTest()
#85 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestRunner\TestRunner.php(87): PHPUnit\Framework\TestCase-&gt;runBare()
#86 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(365): PHPUnit\Framework\TestRunner-&gt;run(Object(Tests\Feature\WithdrawalRequestTest))
#87 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestCase-&gt;run()
#88 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#89 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#90 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\TestRunner.php(64): PHPUnit\Framework\TestSuite-&gt;run()
#91 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\Application.php(211): PHPUnit\TextUI\TestRunner-&gt;run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#92 C:\PreIPO\backend\vendor\phpunit\phpunit\phpunit(104): PHPUnit\TextUI\Application-&gt;run(Array)
#93 {main}

Next Illuminate\Database\QueryException: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' (Connection: mysql, SQL: select sum(`amount`) as aggregate from `withdrawals` where `user_id` = 15245 and `status` != rejected and date(`created_at`) = 2026-02-22) in C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
Stack trace:
#0 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(779): Illuminate\Database\Connection-&gt;runQueryCallback('select sum(`amo...', Array, Object(Closure))
#1 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(398): Illuminate\Database\Connection-&gt;run('select sum(`amo...', Array, Object(Closure))
#2 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3106): Illuminate\Database\Connection-&gt;select('select sum(`amo...', Array, true)
#3 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3091): Illuminate\Database\Query\Builder-&gt;runSelect()
#4 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3676): Illuminate\Database\Query\Builder-&gt;Illuminate\Database\Query\{closure}()
#5 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3090): Illuminate\Database\Query\Builder-&gt;onceWithColumns(Array, Object(Closure))
#6 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3603): Illuminate\Database\Query\Builder-&gt;get(Array)
#7 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3564): Illuminate\Database\Query\Builder-&gt;aggregate('sum', Array)
#8 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php(2120): Illuminate\Database\Query\Builder-&gt;sum('amount')
#9 C:\PreIPO\backend\app\Http\Requests\User\WithdrawalRequest.php(70): Illuminate\Database\Eloquent\Builder-&gt;__call('sum', Array)
#10 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(450): App\Http\Requests\User\WithdrawalRequest-&gt;App\Http\Requests\User\{closure}(Object(Illuminate\Validation\Validator))
#11 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(503): Illuminate\Validation\Validator-&gt;Illuminate\Validation\{closure}()
#12 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(516): Illuminate\Validation\Validator-&gt;passes()
#13 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\ValidatesWhenResolvedTrait.php(31): Illuminate\Validation\Validator-&gt;fails()
#14 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Providers\FormRequestServiceProvider.php(30): Illuminate\Foundation\Http\FormRequest-&gt;validateResolved()
#15 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1432): Illuminate\Foundation\Providers\FormRequestServiceProvider-&gt;Illuminate\Foundation\Providers\{closure}(Object(App\Http\Requests\User\WithdrawalRequest), Object(Illuminate\Foundation\Application))
#16 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1368): Illuminate\Container\Container-&gt;fireCallbackArray(Object(App\Http\Requests\User\WithdrawalRequest), Array)
#17 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1354): Illuminate\Container\Container-&gt;fireAfterResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#18 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(850): Illuminate\Container\Container-&gt;fireResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#19 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1078): Illuminate\Container\Container-&gt;resolve('App\\Http\\Reques...', Array, true)
#20 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(763): Illuminate\Foundation\Application-&gt;resolve('App\\Http\\Reques...', Array)
#21 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1058): Illuminate\Container\Container-&gt;make('App\\Http\\Reques...', Array)
#22 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(92): Illuminate\Foundation\Application-&gt;make('App\\Http\\Reques...')
#23 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(51): Illuminate\Routing\ControllerDispatcher-&gt;transformDependency(Object(ReflectionParameter), Array, Object(stdClass))
#24 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(30): Illuminate\Routing\ControllerDispatcher-&gt;resolveMethodDependencies(Array, Object(ReflectionMethod))
#25 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(60): Illuminate\Routing\ControllerDispatcher-&gt;resolveClassMethodDependencies(Array, Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#26 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(41): Illuminate\Routing\ControllerDispatcher-&gt;resolveParameters(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#27 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(266): Illuminate\Routing\ControllerDispatcher-&gt;dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#28 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(212): Illuminate\Routing\Route-&gt;runController()
#29 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(808): Illuminate\Routing\Route-&gt;run()
#30 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Routing\Router-&gt;Illuminate\Routing\{closure}(Object(Illuminate\Http\Request))
#31 C:\PreIPO\backend\app\Http\Middleware\EnsureMfaVerified.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#32 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\EnsureMfaVerified-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#33 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#34 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#35 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(161): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#36 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(127): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequest(Object(Illuminate\Http\Request), Object(Closure), Array)
#37 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(89): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequestUsingNamedLimiter(Object(Illuminate\Http\Request), Object(Closure), 'financial', Object(Closure))
#38 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'financial')
#39 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Auth\Middleware\Authenticate.php(64): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#40 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'sanctum')
#41 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(807): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#43 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(786): Illuminate\Routing\Router-&gt;runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#44 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(750): Illuminate\Routing\Router-&gt;runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#45 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(739): Illuminate\Routing\Router-&gt;dispatchToRoute(Object(Illuminate\Http\Request))
#46 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(201): Illuminate\Routing\Router-&gt;dispatch(Object(Illuminate\Http\Request))
#47 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Foundation\Http\Kernel-&gt;Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#48 C:\PreIPO\backend\app\Http\Middleware\RedirectMiddleware.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#49 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\RedirectMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#50 C:\PreIPO\backend\app\Http\Middleware\CheckMaintenanceMode.php(48): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#51 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckMaintenanceMode-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#52 C:\PreIPO\backend\app\Http\Middleware\SanitizeInput.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#53 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\SanitizeInput-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#54 C:\PreIPO\backend\app\Http\Middleware\ForceHttps.php(23): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#55 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\ForceHttps-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#56 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#57 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#58 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#59 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#60 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#61 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#62 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#63 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#64 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#65 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#66 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#67 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#68 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\HandleCors.php(62): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#69 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\HandleCors-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#70 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#71 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#72 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#73 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#74 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#75 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(176): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#76 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(145): Illuminate\Foundation\Http\Kernel-&gt;sendRequestThroughRouter(Object(Illuminate\Http\Request))
#77 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel-&gt;handle(Object(Illuminate\Http\Request))
#78 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase-&gt;call('POST', '/api/v1/user/wa...', Array, Array, Array, Array, '{"amount":-100,...')
#79 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase-&gt;json('POST', '/api/v1/user/wa...', Array, Array, 0)
#80 C:\PreIPO\backend\tests\Feature\WithdrawalRequestTest.php(44): Illuminate\Foundation\Testing\TestCase-&gt;postJson('/api/v1/user/wa...', Array)
#81 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(1667): Tests\Feature\WithdrawalRequestTest-&gt;test_validates_amount_positive()
#82 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(519): PHPUnit\Framework\TestCase-&gt;runTest()
#83 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestRunner\TestRunner.php(87): PHPUnit\Framework\TestCase-&gt;runBare()
#84 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(365): PHPUnit\Framework\TestRunner-&gt;run(Object(Tests\Feature\WithdrawalRequestTest))
#85 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestCase-&gt;run()
#86 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#87 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#88 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\TestRunner.php(64): PHPUnit\Framework\TestSuite-&gt;run()
#89 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\Application.php(211): PHPUnit\TextUI\TestRunner-&gt;run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#90 C:\PreIPO\backend\vendor\phpunit\phpunit\phpunit(104): PHPUnit\TextUI\Application-&gt;run(Array)
#91 {main}

----------------------------------------------------------------------------------

SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' (Connection: mysql, SQL: select sum(`amount`) as aggregate from `withdrawals` where `user_id` = 15245 and `status` != rejected and date(`created_at`) = 2026-02-22)
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\WithdrawalRequestTest.php:48</failure>
        </testcase>
        <testcase name="test_validates_bank_details_present" file="C:\PreIPO\backend\tests\Feature\WithdrawalRequestTest.php" line="88" class="Tests\Feature\WithdrawalRequestTest" classname="Tests.Feature.WithdrawalRequestTest" assertions="1" time="1.012590">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\WithdrawalRequestTest::test_validates_bank_details_present&#13;
Expected response status code [422] but received 500.
Failed asserting that 500 is identical to 422.&#13;
&#13;
The following exception occurred during the last request:

PDOException: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' in C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:407
Stack trace:
#0 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(407): PDO-&gt;prepare('select sum(`amo...')
#1 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(812): Illuminate\Database\Connection-&gt;Illuminate\Database\{closure}('select sum(`amo...', Array)
#2 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(779): Illuminate\Database\Connection-&gt;runQueryCallback('select sum(`amo...', Array, Object(Closure))
#3 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(398): Illuminate\Database\Connection-&gt;run('select sum(`amo...', Array, Object(Closure))
#4 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3106): Illuminate\Database\Connection-&gt;select('select sum(`amo...', Array, true)
#5 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3091): Illuminate\Database\Query\Builder-&gt;runSelect()
#6 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3676): Illuminate\Database\Query\Builder-&gt;Illuminate\Database\Query\{closure}()
#7 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3090): Illuminate\Database\Query\Builder-&gt;onceWithColumns(Array, Object(Closure))
#8 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3603): Illuminate\Database\Query\Builder-&gt;get(Array)
#9 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3564): Illuminate\Database\Query\Builder-&gt;aggregate('sum', Array)
#10 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php(2120): Illuminate\Database\Query\Builder-&gt;sum('amount')
#11 C:\PreIPO\backend\app\Http\Requests\User\WithdrawalRequest.php(70): Illuminate\Database\Eloquent\Builder-&gt;__call('sum', Array)
#12 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(450): App\Http\Requests\User\WithdrawalRequest-&gt;App\Http\Requests\User\{closure}(Object(Illuminate\Validation\Validator))
#13 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(503): Illuminate\Validation\Validator-&gt;Illuminate\Validation\{closure}()
#14 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(516): Illuminate\Validation\Validator-&gt;passes()
#15 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\ValidatesWhenResolvedTrait.php(31): Illuminate\Validation\Validator-&gt;fails()
#16 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Providers\FormRequestServiceProvider.php(30): Illuminate\Foundation\Http\FormRequest-&gt;validateResolved()
#17 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1432): Illuminate\Foundation\Providers\FormRequestServiceProvider-&gt;Illuminate\Foundation\Providers\{closure}(Object(App\Http\Requests\User\WithdrawalRequest), Object(Illuminate\Foundation\Application))
#18 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1368): Illuminate\Container\Container-&gt;fireCallbackArray(Object(App\Http\Requests\User\WithdrawalRequest), Array)
#19 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1354): Illuminate\Container\Container-&gt;fireAfterResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#20 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(850): Illuminate\Container\Container-&gt;fireResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#21 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1078): Illuminate\Container\Container-&gt;resolve('App\\Http\\Reques...', Array, true)
#22 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(763): Illuminate\Foundation\Application-&gt;resolve('App\\Http\\Reques...', Array)
#23 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1058): Illuminate\Container\Container-&gt;make('App\\Http\\Reques...', Array)
#24 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(92): Illuminate\Foundation\Application-&gt;make('App\\Http\\Reques...')
#25 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(51): Illuminate\Routing\ControllerDispatcher-&gt;transformDependency(Object(ReflectionParameter), Array, Object(stdClass))
#26 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(30): Illuminate\Routing\ControllerDispatcher-&gt;resolveMethodDependencies(Array, Object(ReflectionMethod))
#27 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(60): Illuminate\Routing\ControllerDispatcher-&gt;resolveClassMethodDependencies(Array, Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#28 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(41): Illuminate\Routing\ControllerDispatcher-&gt;resolveParameters(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#29 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(266): Illuminate\Routing\ControllerDispatcher-&gt;dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#30 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(212): Illuminate\Routing\Route-&gt;runController()
#31 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(808): Illuminate\Routing\Route-&gt;run()
#32 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Routing\Router-&gt;Illuminate\Routing\{closure}(Object(Illuminate\Http\Request))
#33 C:\PreIPO\backend\app\Http\Middleware\EnsureMfaVerified.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#34 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\EnsureMfaVerified-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#35 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#36 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#37 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(161): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#38 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(127): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequest(Object(Illuminate\Http\Request), Object(Closure), Array)
#39 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(89): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequestUsingNamedLimiter(Object(Illuminate\Http\Request), Object(Closure), 'financial', Object(Closure))
#40 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'financial')
#41 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Auth\Middleware\Authenticate.php(64): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'sanctum')
#43 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#44 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(807): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#45 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(786): Illuminate\Routing\Router-&gt;runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#46 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(750): Illuminate\Routing\Router-&gt;runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#47 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(739): Illuminate\Routing\Router-&gt;dispatchToRoute(Object(Illuminate\Http\Request))
#48 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(201): Illuminate\Routing\Router-&gt;dispatch(Object(Illuminate\Http\Request))
#49 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Foundation\Http\Kernel-&gt;Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#50 C:\PreIPO\backend\app\Http\Middleware\RedirectMiddleware.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#51 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\RedirectMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#52 C:\PreIPO\backend\app\Http\Middleware\CheckMaintenanceMode.php(48): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#53 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckMaintenanceMode-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#54 C:\PreIPO\backend\app\Http\Middleware\SanitizeInput.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#55 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\SanitizeInput-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#56 C:\PreIPO\backend\app\Http\Middleware\ForceHttps.php(23): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#57 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\ForceHttps-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#58 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#59 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#60 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#61 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#62 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#63 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#64 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#65 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#66 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#67 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#68 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#69 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#70 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\HandleCors.php(62): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#71 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\HandleCors-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#72 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#73 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#74 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#75 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#76 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#77 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(176): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#78 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(145): Illuminate\Foundation\Http\Kernel-&gt;sendRequestThroughRouter(Object(Illuminate\Http\Request))
#79 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel-&gt;handle(Object(Illuminate\Http\Request))
#80 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase-&gt;call('POST', '/api/v1/user/wa...', Array, Array, Array, Array, '{"amount":5000,...')
#81 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase-&gt;json('POST', '/api/v1/user/wa...', Array, Array, 0)
#82 C:\PreIPO\backend\tests\Feature\WithdrawalRequestTest.php(90): Illuminate\Foundation\Testing\TestCase-&gt;postJson('/api/v1/user/wa...', Array)
#83 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(1667): Tests\Feature\WithdrawalRequestTest-&gt;test_validates_bank_details_present()
#84 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(519): PHPUnit\Framework\TestCase-&gt;runTest()
#85 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestRunner\TestRunner.php(87): PHPUnit\Framework\TestCase-&gt;runBare()
#86 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(365): PHPUnit\Framework\TestRunner-&gt;run(Object(Tests\Feature\WithdrawalRequestTest))
#87 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestCase-&gt;run()
#88 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#89 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#90 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\TestRunner.php(64): PHPUnit\Framework\TestSuite-&gt;run()
#91 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\Application.php(211): PHPUnit\TextUI\TestRunner-&gt;run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#92 C:\PreIPO\backend\vendor\phpunit\phpunit\phpunit(104): PHPUnit\TextUI\Application-&gt;run(Array)
#93 {main}

Next Illuminate\Database\QueryException: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' (Connection: mysql, SQL: select sum(`amount`) as aggregate from `withdrawals` where `user_id` = 15250 and `status` != rejected and date(`created_at`) = 2026-02-22) in C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
Stack trace:
#0 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(779): Illuminate\Database\Connection-&gt;runQueryCallback('select sum(`amo...', Array, Object(Closure))
#1 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(398): Illuminate\Database\Connection-&gt;run('select sum(`amo...', Array, Object(Closure))
#2 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3106): Illuminate\Database\Connection-&gt;select('select sum(`amo...', Array, true)
#3 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3091): Illuminate\Database\Query\Builder-&gt;runSelect()
#4 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3676): Illuminate\Database\Query\Builder-&gt;Illuminate\Database\Query\{closure}()
#5 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3090): Illuminate\Database\Query\Builder-&gt;onceWithColumns(Array, Object(Closure))
#6 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3603): Illuminate\Database\Query\Builder-&gt;get(Array)
#7 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3564): Illuminate\Database\Query\Builder-&gt;aggregate('sum', Array)
#8 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php(2120): Illuminate\Database\Query\Builder-&gt;sum('amount')
#9 C:\PreIPO\backend\app\Http\Requests\User\WithdrawalRequest.php(70): Illuminate\Database\Eloquent\Builder-&gt;__call('sum', Array)
#10 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(450): App\Http\Requests\User\WithdrawalRequest-&gt;App\Http\Requests\User\{closure}(Object(Illuminate\Validation\Validator))
#11 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(503): Illuminate\Validation\Validator-&gt;Illuminate\Validation\{closure}()
#12 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(516): Illuminate\Validation\Validator-&gt;passes()
#13 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\ValidatesWhenResolvedTrait.php(31): Illuminate\Validation\Validator-&gt;fails()
#14 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Providers\FormRequestServiceProvider.php(30): Illuminate\Foundation\Http\FormRequest-&gt;validateResolved()
#15 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1432): Illuminate\Foundation\Providers\FormRequestServiceProvider-&gt;Illuminate\Foundation\Providers\{closure}(Object(App\Http\Requests\User\WithdrawalRequest), Object(Illuminate\Foundation\Application))
#16 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1368): Illuminate\Container\Container-&gt;fireCallbackArray(Object(App\Http\Requests\User\WithdrawalRequest), Array)
#17 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1354): Illuminate\Container\Container-&gt;fireAfterResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#18 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(850): Illuminate\Container\Container-&gt;fireResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#19 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1078): Illuminate\Container\Container-&gt;resolve('App\\Http\\Reques...', Array, true)
#20 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(763): Illuminate\Foundation\Application-&gt;resolve('App\\Http\\Reques...', Array)
#21 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1058): Illuminate\Container\Container-&gt;make('App\\Http\\Reques...', Array)
#22 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(92): Illuminate\Foundation\Application-&gt;make('App\\Http\\Reques...')
#23 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(51): Illuminate\Routing\ControllerDispatcher-&gt;transformDependency(Object(ReflectionParameter), Array, Object(stdClass))
#24 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(30): Illuminate\Routing\ControllerDispatcher-&gt;resolveMethodDependencies(Array, Object(ReflectionMethod))
#25 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(60): Illuminate\Routing\ControllerDispatcher-&gt;resolveClassMethodDependencies(Array, Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#26 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(41): Illuminate\Routing\ControllerDispatcher-&gt;resolveParameters(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#27 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(266): Illuminate\Routing\ControllerDispatcher-&gt;dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#28 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(212): Illuminate\Routing\Route-&gt;runController()
#29 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(808): Illuminate\Routing\Route-&gt;run()
#30 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Routing\Router-&gt;Illuminate\Routing\{closure}(Object(Illuminate\Http\Request))
#31 C:\PreIPO\backend\app\Http\Middleware\EnsureMfaVerified.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#32 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\EnsureMfaVerified-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#33 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#34 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#35 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(161): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#36 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(127): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequest(Object(Illuminate\Http\Request), Object(Closure), Array)
#37 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(89): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequestUsingNamedLimiter(Object(Illuminate\Http\Request), Object(Closure), 'financial', Object(Closure))
#38 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'financial')
#39 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Auth\Middleware\Authenticate.php(64): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#40 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'sanctum')
#41 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(807): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#43 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(786): Illuminate\Routing\Router-&gt;runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#44 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(750): Illuminate\Routing\Router-&gt;runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#45 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(739): Illuminate\Routing\Router-&gt;dispatchToRoute(Object(Illuminate\Http\Request))
#46 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(201): Illuminate\Routing\Router-&gt;dispatch(Object(Illuminate\Http\Request))
#47 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Foundation\Http\Kernel-&gt;Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#48 C:\PreIPO\backend\app\Http\Middleware\RedirectMiddleware.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#49 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\RedirectMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#50 C:\PreIPO\backend\app\Http\Middleware\CheckMaintenanceMode.php(48): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#51 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckMaintenanceMode-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#52 C:\PreIPO\backend\app\Http\Middleware\SanitizeInput.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#53 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\SanitizeInput-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#54 C:\PreIPO\backend\app\Http\Middleware\ForceHttps.php(23): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#55 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\ForceHttps-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#56 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#57 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#58 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#59 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#60 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#61 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#62 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#63 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#64 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#65 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#66 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#67 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#68 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\HandleCors.php(62): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#69 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\HandleCors-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#70 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#71 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#72 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#73 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#74 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#75 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(176): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#76 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(145): Illuminate\Foundation\Http\Kernel-&gt;sendRequestThroughRouter(Object(Illuminate\Http\Request))
#77 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel-&gt;handle(Object(Illuminate\Http\Request))
#78 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase-&gt;call('POST', '/api/v1/user/wa...', Array, Array, Array, Array, '{"amount":5000,...')
#79 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase-&gt;json('POST', '/api/v1/user/wa...', Array, Array, 0)
#80 C:\PreIPO\backend\tests\Feature\WithdrawalRequestTest.php(90): Illuminate\Foundation\Testing\TestCase-&gt;postJson('/api/v1/user/wa...', Array)
#81 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(1667): Tests\Feature\WithdrawalRequestTest-&gt;test_validates_bank_details_present()
#82 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(519): PHPUnit\Framework\TestCase-&gt;runTest()
#83 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestRunner\TestRunner.php(87): PHPUnit\Framework\TestCase-&gt;runBare()
#84 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(365): PHPUnit\Framework\TestRunner-&gt;run(Object(Tests\Feature\WithdrawalRequestTest))
#85 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestCase-&gt;run()
#86 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#87 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#88 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\TestRunner.php(64): PHPUnit\Framework\TestSuite-&gt;run()
#89 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\Application.php(211): PHPUnit\TextUI\TestRunner-&gt;run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#90 C:\PreIPO\backend\vendor\phpunit\phpunit\phpunit(104): PHPUnit\TextUI\Application-&gt;run(Array)
#91 {main}

----------------------------------------------------------------------------------

SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' (Connection: mysql, SQL: select sum(`amount`) as aggregate from `withdrawals` where `user_id` = 15250 and `status` != rejected and date(`created_at`) = 2026-02-22)
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\WithdrawalRequestTest.php:94</failure>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\SnapshotIntegrityTest" file="C:\PreIPO\backend\tests\Feature\SnapshotIntegrityTest.php" tests="9" assertions="4" errors="7" failures="0" skipped="0" time="12.418583">
        <testcase name="payment_sum_matches_revenue_ledger" file="C:\PreIPO\backend\tests\Feature\SnapshotIntegrityTest.php" line="251" class="Tests\Feature\SnapshotIntegrityTest" classname="Tests.Feature.SnapshotIntegrityTest" assertions="0" time="1.011951">
          <error type="RuntimeException">Tests\Feature\SnapshotIntegrityTest::payment_sum_matches_revenue_ledger&#13;
RuntimeException: Subscription #3517 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:80
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:56
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\Dispatchable.php:19
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:74
C:\PreIPO\backend\app\Services\IdempotencyService.php:206
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:52
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\DatabaseTransactionsManager.php:39
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:51
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:751
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\SnapshotIntegrityTest.php:446
C:\PreIPO\backend\tests\Feature\SnapshotIntegrityTest.php:253</error>
        </testcase>
        <testcase name="wallet_balances_match_transaction_sums" file="C:\PreIPO\backend\tests\Feature\SnapshotIntegrityTest.php" line="287" class="Tests\Feature\SnapshotIntegrityTest" classname="Tests.Feature.SnapshotIntegrityTest" assertions="0" time="0.986849">
          <error type="RuntimeException">Tests\Feature\SnapshotIntegrityTest::wallet_balances_match_transaction_sums&#13;
RuntimeException: Subscription #3518 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:80
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:56
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\Dispatchable.php:19
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:74
C:\PreIPO\backend\app\Services\IdempotencyService.php:206
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:52
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\DatabaseTransactionsManager.php:39
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:51
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:751
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\SnapshotIntegrityTest.php:446
C:\PreIPO\backend\tests\Feature\SnapshotIntegrityTest.php:289</error>
        </testcase>
        <testcase name="reporting_queries_are_consistent" file="C:\PreIPO\backend\tests\Feature\SnapshotIntegrityTest.php" line="320" class="Tests\Feature\SnapshotIntegrityTest" classname="Tests.Feature.SnapshotIntegrityTest" assertions="0" time="1.142409">
          <error type="RuntimeException">Tests\Feature\SnapshotIntegrityTest::reporting_queries_are_consistent&#13;
RuntimeException: Subscription #3520 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:80
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:56
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\Dispatchable.php:19
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:74
C:\PreIPO\backend\app\Services\IdempotencyService.php:206
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:52
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\DatabaseTransactionsManager.php:39
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:51
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:751
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\SnapshotIntegrityTest.php:446
C:\PreIPO\backend\tests\Feature\SnapshotIntegrityTest.php:322</error>
        </testcase>
        <testcase name="no_negative_liabilities_in_ledger" file="C:\PreIPO\backend\tests\Feature\SnapshotIntegrityTest.php" line="134" class="Tests\Feature\SnapshotIntegrityTest" classname="Tests.Feature.SnapshotIntegrityTest" assertions="0" time="1.593991">
          <error type="RuntimeException">Tests\Feature\SnapshotIntegrityTest::no_negative_liabilities_in_ledger&#13;
RuntimeException: Subscription #3521 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:80
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:56
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\Dispatchable.php:19
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:74
C:\PreIPO\backend\app\Services\IdempotencyService.php:206
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:52
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\DatabaseTransactionsManager.php:39
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:51
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:751
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\SnapshotIntegrityTest.php:446
C:\PreIPO\backend\tests\Feature\SnapshotIntegrityTest.php:136</error>
        </testcase>
        <testcase name="no_floating_point_drift_in_calculations" file="C:\PreIPO\backend\tests\Feature\SnapshotIntegrityTest.php" line="89" class="Tests\Feature\SnapshotIntegrityTest" classname="Tests.Feature.SnapshotIntegrityTest" assertions="2" time="1.618368"/>
        <testcase name="bonus_contract_snapshot_preserved_through_payments" file="C:\PreIPO\backend\tests\Feature\SnapshotIntegrityTest.php" line="351" class="Tests\Feature\SnapshotIntegrityTest" classname="Tests.Feature.SnapshotIntegrityTest" assertions="0" time="1.528124">
          <error type="Illuminate\Database\QueryException">Tests\Feature\SnapshotIntegrityTest::bonus_contract_snapshot_preserved_through_payments&#13;
Illuminate\Database\QueryException: Array to string conversion (Connection: mysql, SQL: insert into `subscriptions` (`user_id`, `plan_id`, `amount`, `subscription_code`, `status`, `start_date`, `end_date`, `next_payment_date`, `bonus_multiplier`, `consecutive_payments_count`, `pause_count`, `is_auto_debit`, `bonus_contract_snapshot`, `updated_at`, `created_at`) values (15291, 1764, 2500.00, SUB-IZZUCGZOPY, active, 2024-10-05 13:05:51, 2026-10-05 13:05:51, 2026-02-27 10:30:52, 1, 0, 0, 0, ?, 2026-02-22 10:30:52, 2026-02-22 10:30:52))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
C:\PreIPO\backend\tests\Feature\SnapshotIntegrityTest.php:365</error>
        </testcase>
        <testcase name="aggregates_match_raw_ledger_sums" file="C:\PreIPO\backend\tests\Feature\SnapshotIntegrityTest.php" line="58" class="Tests\Feature\SnapshotIntegrityTest" classname="Tests.Feature.SnapshotIntegrityTest" assertions="0" time="1.592597">
          <error type="RuntimeException">Tests\Feature\SnapshotIntegrityTest::aggregates_match_raw_ledger_sums&#13;
RuntimeException: Subscription #3522 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:80
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:56
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\Dispatchable.php:19
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:74
C:\PreIPO\backend\app\Services\IdempotencyService.php:206
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:52
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\DatabaseTransactionsManager.php:39
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:51
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:751
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\SnapshotIntegrityTest.php:446
C:\PreIPO\backend\tests\Feature\SnapshotIntegrityTest.php:61</error>
        </testcase>
        <testcase name="snapshot_hash_detects_tampering" file="C:\PreIPO\backend\tests\Feature\SnapshotIntegrityTest.php" line="215" class="Tests\Feature\SnapshotIntegrityTest" classname="Tests.Feature.SnapshotIntegrityTest" assertions="2" time="1.468012"/>
        <testcase name="investment_snapshots_are_immutable" file="C:\PreIPO\backend\tests\Feature\SnapshotIntegrityTest.php" line="165" class="Tests\Feature\SnapshotIntegrityTest" classname="Tests.Feature.SnapshotIntegrityTest" assertions="0" time="1.476282">
          <error type="Illuminate\Database\QueryException">Tests\Feature\SnapshotIntegrityTest::investment_snapshots_are_immutable&#13;
Illuminate\Database\QueryException: Array to string conversion (Connection: mysql, SQL: insert into `subscriptions` (`user_id`, `plan_id`, `amount`, `subscription_code`, `status`, `start_date`, `end_date`, `next_payment_date`, `bonus_multiplier`, `consecutive_payments_count`, `pause_count`, `is_auto_debit`, `bonus_contract_snapshot`, `updated_at`, `created_at`) values (15307, 1764, 2500.00, SUB-0Q9F5YALVP, active, 2025-09-22 09:15:19, 2027-09-22 09:15:19, 2026-02-27 10:30:57, 1, 0, 0, 0, ?, 2026-02-22 10:30:57, 2026-02-22 10:30:57))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
C:\PreIPO\backend\tests\Feature\SnapshotIntegrityTest.php:183</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\PaymentRequestTest" file="C:\PreIPO\backend\tests\Feature\PaymentRequestTest.php" tests="5" assertions="11" errors="0" failures="0" skipped="0" time="4.868140">
        <testcase name="test_validates_amount_positive" file="C:\PreIPO\backend\tests\Feature\PaymentRequestTest.php" line="83" class="Tests\Feature\PaymentRequestTest" classname="Tests.Feature.PaymentRequestTest" assertions="2" time="0.967101"/>
        <testcase name="test_validates_payment_method_enum" file="C:\PreIPO\backend\tests\Feature\PaymentRequestTest.php" line="99" class="Tests\Feature\PaymentRequestTest" classname="Tests.Feature.PaymentRequestTest" assertions="1" time="0.952222"/>
        <testcase name="test_validates_subscription_exists" file="C:\PreIPO\backend\tests\Feature\PaymentRequestTest.php" line="54" class="Tests\Feature\PaymentRequestTest" classname="Tests.Feature.PaymentRequestTest" assertions="3" time="0.962823"/>
        <testcase name="test_passes_with_valid_data" file="C:\PreIPO\backend\tests\Feature\PaymentRequestTest.php" line="107" class="Tests\Feature\PaymentRequestTest" classname="Tests.Feature.PaymentRequestTest" assertions="4" time="0.999549"/>
        <testcase name="test_validates_user_owns_subscription" file="C:\PreIPO\backend\tests\Feature\PaymentRequestTest.php" line="65" class="Tests\Feature\PaymentRequestTest" classname="Tests.Feature.PaymentRequestTest" assertions="1" time="0.986445"/>
      </testsuite>
      <testsuite name="Tests\Feature\RateLimitingTest" file="C:\PreIPO\backend\tests\Feature\RateLimitingTest.php" tests="4" assertions="18" errors="0" failures="1" skipped="0" time="0.321562">
        <testcase name="test_rate_limit_resets_after_time_window" file="C:\PreIPO\backend\tests\Feature\RateLimitingTest.php" line="88" class="Tests\Feature\RateLimitingTest" classname="Tests.Feature.RateLimitingTest" assertions="4" time="0.086557"/>
        <testcase name="test_rate_limit_blocks_after_max_attempts" file="C:\PreIPO\backend\tests\Feature\RateLimitingTest.php" line="51" class="Tests\Feature\RateLimitingTest" classname="Tests.Feature.RateLimitingTest" assertions="6" time="0.097382"/>
        <testcase name="test_rate_limit_allows_within_limit" file="C:\PreIPO\backend\tests\Feature\RateLimitingTest.php" line="32" class="Tests\Feature\RateLimitingTest" classname="Tests.Feature.RateLimitingTest" assertions="1" time="0.061656">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\RateLimitingTest::test_rate_limit_allows_within_limit&#13;
Expected response status code [401] but received 429.
Failed asserting that 429 is identical to 401.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\RateLimitingTest.php:46</failure>
        </testcase>
        <testcase name="test_rate_limit_returns_correct_headers" file="C:\PreIPO\backend\tests\Feature\RateLimitingTest.php" line="73" class="Tests\Feature\RateLimitingTest" classname="Tests.Feature.RateLimitingTest" assertions="7" time="0.075967"/>
      </testsuite>
      <testsuite name="Tests\Feature\ReferralCampaignControllerTest" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" tests="23" assertions="53" errors="0" failures="5" skipped="0" time="34.611198">
        <testcase name="regular_user_cannot_list_campaigns" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" line="54" class="Tests\Feature\ReferralCampaignControllerTest" classname="Tests.Feature.ReferralCampaignControllerTest" assertions="1" time="1.092762"/>
        <testcase name="regular_user_cannot_delete_campaign" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" line="359" class="Tests\Feature\ReferralCampaignControllerTest" classname="Tests.Feature.ReferralCampaignControllerTest" assertions="1" time="1.510921"/>
        <testcase name="update_validates_date_consistency" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" line="298" class="Tests\Feature\ReferralCampaignControllerTest" classname="Tests.Feature.ReferralCampaignControllerTest" assertions="3" time="1.487712"/>
        <testcase name="update_allows_partial_updates" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" line="247" class="Tests\Feature\ReferralCampaignControllerTest" classname="Tests.Feature.ReferralCampaignControllerTest" assertions="2" time="1.547414"/>
        <testcase name="cannot_create_campaign_with_unreasonable_multiplier" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" line="371" class="Tests\Feature\ReferralCampaignControllerTest" classname="Tests.Feature.ReferralCampaignControllerTest" assertions="1" time="1.486566">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ReferralCampaignControllerTest::cannot_create_campaign_with_unreasonable_multiplier&#13;
Expected response status code [201] but received 200.
Failed asserting that 200 is identical to 201.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php:386</failure>
        </testcase>
        <testcase name="admin_can_delete_referral_campaign" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" line="334" class="Tests\Feature\ReferralCampaignControllerTest" classname="Tests.Feature.ReferralCampaignControllerTest" assertions="3" time="1.462039"/>
        <testcase name="admin_can_update_referral_campaign" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" line="223" class="Tests\Feature\ReferralCampaignControllerTest" classname="Tests.Feature.ReferralCampaignControllerTest" assertions="3" time="1.507588"/>
        <testcase name="store_enforces_maximum_multiplier_cap" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" line="116" class="Tests\Feature\ReferralCampaignControllerTest" classname="Tests.Feature.ReferralCampaignControllerTest" assertions="3" time="1.698013"/>
        <testcase name="store_enforces_maximum_bonus_amount_cap" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" line="134" class="Tests\Feature\ReferralCampaignControllerTest" classname="Tests.Feature.ReferralCampaignControllerTest" assertions="3" time="1.507394"/>
        <testcase name="delete_returns_404_for_nonexistent_campaign" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" line="350" class="Tests\Feature\ReferralCampaignControllerTest" classname="Tests.Feature.ReferralCampaignControllerTest" assertions="1" time="1.487106"/>
        <testcase name="admin_can_toggle_campaign_active_status" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" line="316" class="Tests\Feature\ReferralCampaignControllerTest" classname="Tests.Feature.ReferralCampaignControllerTest" assertions="2" time="1.552372"/>
        <testcase name="store_validates_required_fields" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" line="88" class="Tests\Feature\ReferralCampaignControllerTest" classname="Tests.Feature.ReferralCampaignControllerTest" assertions="7" time="1.513971"/>
        <testcase name="admin_can_create_referral_campaign" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" line="64" class="Tests\Feature\ReferralCampaignControllerTest" classname="Tests.Feature.ReferralCampaignControllerTest" assertions="1" time="1.362792">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ReferralCampaignControllerTest::admin_can_create_referral_campaign&#13;
Expected response status code [201] but received 200.
Failed asserting that 200 is identical to 201.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php:78</failure>
        </testcase>
        <testcase name="store_validates_minimum_multiplier" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" line="186" class="Tests\Feature\ReferralCampaignControllerTest" classname="Tests.Feature.ReferralCampaignControllerTest" assertions="3" time="1.584753"/>
        <testcase name="update_enforces_multiplier_cap" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" line="270" class="Tests\Feature\ReferralCampaignControllerTest" classname="Tests.Feature.ReferralCampaignControllerTest" assertions="3" time="1.513777"/>
        <testcase name="store_allows_bonus_at_maximum_cap" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" line="169" class="Tests\Feature\ReferralCampaignControllerTest" classname="Tests.Feature.ReferralCampaignControllerTest" assertions="1" time="1.550409">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ReferralCampaignControllerTest::store_allows_bonus_at_maximum_cap&#13;
Expected response status code [201] but received 200.
Failed asserting that 200 is identical to 201.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php:182</failure>
        </testcase>
        <testcase name="campaigns_are_returned_in_latest_order" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" line="41" class="Tests\Feature\ReferralCampaignControllerTest" classname="Tests.Feature.ReferralCampaignControllerTest" assertions="2" time="1.493283"/>
        <testcase name="admin_can_list_referral_campaigns" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" line="29" class="Tests\Feature\ReferralCampaignControllerTest" classname="Tests.Feature.ReferralCampaignControllerTest" assertions="2" time="1.550553"/>
        <testcase name="store_allows_multiplier_at_maximum_cap" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" line="152" class="Tests\Feature\ReferralCampaignControllerTest" classname="Tests.Feature.ReferralCampaignControllerTest" assertions="1" time="1.551123">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ReferralCampaignControllerTest::store_allows_multiplier_at_maximum_cap&#13;
Expected response status code [201] but received 200.
Failed asserting that 200 is identical to 201.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php:165</failure>
        </testcase>
        <testcase name="store_validates_end_date_after_start_date" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" line="98" class="Tests\Feature\ReferralCampaignControllerTest" classname="Tests.Feature.ReferralCampaignControllerTest" assertions="3" time="1.428866"/>
        <testcase name="update_enforces_bonus_cap" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" line="284" class="Tests\Feature\ReferralCampaignControllerTest" classname="Tests.Feature.ReferralCampaignControllerTest" assertions="3" time="1.599014"/>
        <testcase name="store_validates_non_negative_bonus" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" line="204" class="Tests\Feature\ReferralCampaignControllerTest" classname="Tests.Feature.ReferralCampaignControllerTest" assertions="3" time="1.608205"/>
        <testcase name="campaign_multiplier_precision_is_respected" file="C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php" line="397" class="Tests\Feature\ReferralCampaignControllerTest" classname="Tests.Feature.ReferralCampaignControllerTest" assertions="1" time="1.514567">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ReferralCampaignControllerTest::campaign_multiplier_precision_is_respected&#13;
Expected response status code [201] but received 200.
Failed asserting that 200 is identical to 201.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ReferralCampaignControllerTest.php:410</failure>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\PaymentLifecycleTest" file="C:\PreIPO\backend\tests\Feature\PaymentLifecycleTest.php" tests="1" assertions="0" errors="0" failures="0" skipped="1" time="1.462626">
        <testcase name="test_full_payment_lifecycle_succeeds" file="C:\PreIPO\backend\tests\Feature\PaymentLifecycleTest.php" line="32" class="Tests\Feature\PaymentLifecycleTest" classname="Tests.Feature.PaymentLifecycleTest" assertions="0" time="1.462626">
          <skipped/>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\ThemeSeoControllerTest" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" tests="29" assertions="29" errors="0" failures="29" skipped="0" time="41.713939">
        <testcase name="theme_validates_font_family_max_length" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="155" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.476274">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::theme_validates_font_family_max_length&#13;
Expected response status code [422] but received 404.
Failed asserting that 404 is identical to 422.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:162</failure>
        </testcase>
        <testcase name="theme_rejects_invalid_hex_format" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="111" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.474453">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::theme_rejects_invalid_hex_format&#13;
Expected response status code [422] but received 404.
Failed asserting that 404 is identical to 422.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:129</failure>
        </testcase>
        <testcase name="favicon_validates_file_type" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="250" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.532807">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::favicon_validates_file_type&#13;
Expected response status code [422] but received 404.
Failed asserting that 404 is identical to 422.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:259</failure>
        </testcase>
        <testcase name="admin_can_update_font_family" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="66" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.474418">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::admin_can_update_font_family&#13;
Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:73</failure>
        </testcase>
        <testcase name="theme_update_clears_settings_cache" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="452" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.519523">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::theme_update_clears_settings_cache&#13;
Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:462</failure>
        </testcase>
        <testcase name="regular_user_cannot_update_seo" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="430" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.589953">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::regular_user_cannot_update_seo&#13;
Expected response status code [403] but received 404.
Failed asserting that 404 is identical to 403.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:437</failure>
        </testcase>
        <testcase name="seo_validates_google_analytics_id_format" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="371" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.493090">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::seo_validates_google_analytics_id_format&#13;
Expected response status code [422] but received 404.
Failed asserting that 404 is identical to 422.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:389</failure>
        </testcase>
        <testcase name="admin_can_upload_favicon" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="232" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.560149">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::admin_can_upload_favicon&#13;
Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:241</failure>
        </testcase>
        <testcase name="admin_can_update_meta_title_suffix" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="298" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.516256">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::admin_can_update_meta_title_suffix&#13;
Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:305</failure>
        </testcase>
        <testcase name="logo_validates_max_file_size" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="200" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.522038">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::logo_validates_max_file_size&#13;
Expected response status code [422] but received 404.
Failed asserting that 404 is identical to 422.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:209</failure>
        </testcase>
        <testcase name="unauthenticated_user_cannot_update_theme" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="441" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.548410">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::unauthenticated_user_cannot_update_theme&#13;
Expected response status code [401] but received 404.
Failed asserting that 404 is identical to 401.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:447</failure>
        </testcase>
        <testcase name="theme_accepts_valid_hex_colors" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="134" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.458572">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::theme_accepts_valid_hex_colors&#13;
Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:150</failure>
        </testcase>
        <testcase name="admin_can_update_secondary_color" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="50" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="0.991708">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::admin_can_update_secondary_color&#13;
Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:57</failure>
        </testcase>
        <testcase name="admin_can_upload_logo" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="168" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="0.979313">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::admin_can_upload_logo&#13;
Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:177</failure>
        </testcase>
        <testcase name="seo_validates_meta_title_suffix_max_length" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="326" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="0.929299">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::seo_validates_meta_title_suffix_max_length&#13;
Expected response status code [422] but received 404.
Failed asserting that 404 is identical to 422.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:333</failure>
        </testcase>
        <testcase name="logo_accepts_valid_image_types" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="214" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.004761">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::logo_accepts_valid_image_types&#13;
Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:226</failure>
        </testcase>
        <testcase name="admin_can_update_primary_color" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="33" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="0.943726">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::admin_can_update_primary_color&#13;
Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:40</failure>
        </testcase>
        <testcase name="admin_can_set_google_analytics_ua_id" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="355" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.497492">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::admin_can_set_google_analytics_ua_id&#13;
Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:362</failure>
        </testcase>
        <testcase name="logo_validates_file_type" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="186" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.444970">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::logo_validates_file_type&#13;
Expected response status code [422] but received 404.
Failed asserting that 404 is identical to 422.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:195</failure>
        </testcase>
        <testcase name="seo_accepts_valid_google_analytics_ids" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="395" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.521934">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::seo_accepts_valid_google_analytics_ids&#13;
Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:413</failure>
        </testcase>
        <testcase name="admin_can_update_robots_txt" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="279" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.440856">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::admin_can_update_robots_txt&#13;
Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:288</failure>
        </testcase>
        <testcase name="seo_update_clears_settings_cache" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="470" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.456775">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::seo_update_clears_settings_cache&#13;
Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:480</failure>
        </testcase>
        <testcase name="admin_can_update_multiple_theme_settings" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="82" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.457971">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::admin_can_update_multiple_theme_settings&#13;
Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:91</failure>
        </testcase>
        <testcase name="uploading_new_logo_deletes_old_one" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="489" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.471751">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::uploading_new_logo_deletes_old_one&#13;
Failed asserting that null is not equal to null.
&#13;
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:508</failure>
        </testcase>
        <testcase name="favicon_validates_max_file_size" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="264" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.477994">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::favicon_validates_max_file_size&#13;
Expected response status code [422] but received 404.
Failed asserting that 404 is identical to 422.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:273</failure>
        </testcase>
        <testcase name="theme_validates_hex_color_format" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="99" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="2.564617">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::theme_validates_hex_color_format&#13;
Expected response status code [422] but received 404.
Failed asserting that 404 is identical to 422.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:106</failure>
        </testcase>
        <testcase name="seo_validates_robots_txt_max_length" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="314" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.448270">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::seo_validates_robots_txt_max_length&#13;
Expected response status code [422] but received 404.
Failed asserting that 404 is identical to 422.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:321</failure>
        </testcase>
        <testcase name="regular_user_cannot_update_theme" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="419" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.402005">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::regular_user_cannot_update_theme&#13;
Expected response status code [403] but received 404.
Failed asserting that 404 is identical to 403.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:426</failure>
        </testcase>
        <testcase name="admin_can_set_google_analytics_ga4_id" file="C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php" line="339" class="Tests\Feature\ThemeSeoControllerTest" classname="Tests.Feature.ThemeSeoControllerTest" assertions="1" time="1.514558">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ThemeSeoControllerTest::admin_can_set_google_analytics_ga4_id&#13;
Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ThemeSeoControllerTest.php:346</failure>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\ProfitShareTest" file="C:\PreIPO\backend\tests\Feature\ProfitShareTest.php" tests="2" assertions="2" errors="0" failures="2" skipped="0" time="1.969930">
        <testcase name="admin_can_calculate_profit_share" file="C:\PreIPO\backend\tests\Feature\ProfitShareTest.php" line="52" class="Tests\Feature\ProfitShareTest" classname="Tests.Feature.ProfitShareTest" assertions="1" time="0.968859">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ProfitShareTest::admin_can_calculate_profit_share&#13;
Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ProfitShareTest.php:57</failure>
        </testcase>
        <testcase name="admin_can_distribute_profit_share" file="C:\PreIPO\backend\tests\Feature\ProfitShareTest.php" line="67" class="Tests\Feature\ProfitShareTest" classname="Tests.Feature.ProfitShareTest" assertions="1" time="1.001071">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ProfitShareTest::admin_can_distribute_profit_share&#13;
Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\ProfitShareTest.php:77</failure>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\ProcessMonthlyLuckyDrawTest" file="C:\PreIPO\backend\tests\Feature\ProcessMonthlyLuckyDrawTest.php" tests="3" assertions="4" errors="2" failures="0" skipped="1" time="4.593907">
        <testcase name="test_allocates_entries_to_active_users" file="C:\PreIPO\backend\tests\Feature\ProcessMonthlyLuckyDrawTest.php" line="51" class="Tests\Feature\ProcessMonthlyLuckyDrawTest" classname="Tests.Feature.ProcessMonthlyLuckyDrawTest" assertions="1" time="1.456827">
          <skipped/>
        </testcase>
        <testcase name="test_creates_draw_for_current_month" file="C:\PreIPO\backend\tests\Feature\ProcessMonthlyLuckyDrawTest.php" line="30" class="Tests\Feature\ProcessMonthlyLuckyDrawTest" classname="Tests.Feature.ProcessMonthlyLuckyDrawTest" assertions="1" time="1.589790">
          <error type="Error">Tests\Feature\ProcessMonthlyLuckyDrawTest::test_creates_draw_for_current_month&#13;
Error: Class "Tests\Feature\Mockery" not found
&#13;
C:\PreIPO\backend\tests\Feature\ProcessMonthlyLuckyDrawTest.php:40</error>
        </testcase>
        <testcase name="test_executes_draw_and_selects_winners" file="C:\PreIPO\backend\tests\Feature\ProcessMonthlyLuckyDrawTest.php" line="63" class="Tests\Feature\ProcessMonthlyLuckyDrawTest" classname="Tests.Feature.ProcessMonthlyLuckyDrawTest" assertions="2" time="1.547291">
          <error type="Error">Tests\Feature\ProcessMonthlyLuckyDrawTest::test_executes_draw_and_selects_winners&#13;
Error: Class "Tests\Feature\Mockery" not found
&#13;
C:\PreIPO\backend\tests\Feature\ProcessMonthlyLuckyDrawTest.php:78</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\Models\DisclosureTierVisibilityScopeTest" file="C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php" tests="15" assertions="11" errors="7" failures="7" skipped="0" time="1.172490">
        <testcase name="test_company_get_disclosure_tier_info_helper" file="C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php" line="182" class="Tests\Feature\Models\DisclosureTierVisibilityScopeTest" classname="Tests.Feature.Models.DisclosureTierVisibilityScopeTest" assertions="1" time="0.070550">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\Models\DisclosureTierVisibilityScopeTest::test_company_get_disclosure_tier_info_helper&#13;
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
-'tier_2_live'
+'tier_0_pending'
&#13;
C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php:186</failure>
        </testcase>
        <testcase name="test_invariant_no_public_visibility_below_tier_2" file="C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php" line="369" class="Tests\Feature\Models\DisclosureTierVisibilityScopeTest" classname="Tests.Feature.Models.DisclosureTierVisibilityScopeTest" assertions="0" time="0.075542">
          <error type="RuntimeException">Tests\Feature\Models\DisclosureTierVisibilityScopeTest::test_invariant_no_public_visibility_below_tier_2&#13;
RuntimeException: LIFECYCLE VIOLATION: New products must start with 'draft' status. Attempted status: approved
&#13;
C:\PreIPO\backend\app\Models\Product.php:122
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1307
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php:373</error>
        </testcase>
        <testcase name="test_product_from_companies_at_or_above_tier_scope" file="C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php" line="287" class="Tests\Feature\Models\DisclosureTierVisibilityScopeTest" classname="Tests.Feature.Models.DisclosureTierVisibilityScopeTest" assertions="0" time="0.129197">
          <error type="RuntimeException">Tests\Feature\Models\DisclosureTierVisibilityScopeTest::test_product_from_companies_at_or_above_tier_scope&#13;
RuntimeException: LIFECYCLE VIOLATION: New products must start with 'draft' status. Attempted status: approved
&#13;
C:\PreIPO\backend\app\Models\Product.php:122
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1307
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php:289</error>
        </testcase>
        <testcase name="test_company_is_publicly_visible_by_tier_helper" file="C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php" line="171" class="Tests\Feature\Models\DisclosureTierVisibilityScopeTest" classname="Tests.Feature.Models.DisclosureTierVisibilityScopeTest" assertions="3" time="0.066497">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\Models\DisclosureTierVisibilityScopeTest::test_company_is_publicly_visible_by_tier_helper&#13;
Failed asserting that false is true.
&#13;
C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php:175</failure>
        </testcase>
        <testcase name="test_company_by_disclosure_tier_scope" file="C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php" line="81" class="Tests\Feature\Models\DisclosureTierVisibilityScopeTest" classname="Tests.Feature.Models.DisclosureTierVisibilityScopeTest" assertions="1" time="0.064525">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\Models\DisclosureTierVisibilityScopeTest::test_company_by_disclosure_tier_scope&#13;
Failed asserting that actual size 4 matches expected size 1.
&#13;
C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php:85</failure>
        </testcase>
        <testcase name="test_company_investable_scope" file="C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php" line="122" class="Tests\Feature\Models\DisclosureTierVisibilityScopeTest" classname="Tests.Feature.Models.DisclosureTierVisibilityScopeTest" assertions="2" time="0.065776"/>
        <testcase name="test_product_publicly_visible_scope" file="C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php" line="200" class="Tests\Feature\Models\DisclosureTierVisibilityScopeTest" classname="Tests.Feature.Models.DisclosureTierVisibilityScopeTest" assertions="0" time="0.094009">
          <error type="RuntimeException">Tests\Feature\Models\DisclosureTierVisibilityScopeTest::test_product_publicly_visible_scope&#13;
RuntimeException: LIFECYCLE VIOLATION: New products must start with 'draft' status. Attempted status: approved
&#13;
C:\PreIPO\backend\app\Models\Product.php:122
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1307
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php:203</error>
        </testcase>
        <testcase name="test_company_publicly_visible_scope" file="C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php" line="65" class="Tests\Feature\Models\DisclosureTierVisibilityScopeTest" classname="Tests.Feature.Models.DisclosureTierVisibilityScopeTest" assertions="1" time="0.061457">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\Models\DisclosureTierVisibilityScopeTest::test_company_publicly_visible_scope&#13;
Failed asserting that actual size 0 matches expected size 2.
&#13;
C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php:71</failure>
        </testcase>
        <testcase name="test_company_pending_review_scope" file="C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php" line="137" class="Tests\Feature\Models\DisclosureTierVisibilityScopeTest" classname="Tests.Feature.Models.DisclosureTierVisibilityScopeTest" assertions="1" time="0.062996">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\Models\DisclosureTierVisibilityScopeTest::test_company_pending_review_scope&#13;
Failed asserting that actual size 4 matches expected size 2.
&#13;
C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php:141</failure>
        </testcase>
        <testcase name="test_product_by_company_disclosure_tier_scope" file="C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php" line="249" class="Tests\Feature\Models\DisclosureTierVisibilityScopeTest" classname="Tests.Feature.Models.DisclosureTierVisibilityScopeTest" assertions="0" time="0.078952">
          <error type="RuntimeException">Tests\Feature\Models\DisclosureTierVisibilityScopeTest::test_product_by_company_disclosure_tier_scope&#13;
RuntimeException: LIFECYCLE VIOLATION: New products must start with 'draft' status. Attempted status: approved
&#13;
C:\PreIPO\backend\app\Models\Product.php:122
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1307
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php:251</error>
        </testcase>
        <testcase name="test_product_get_visibility_status_helper" file="C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php" line="345" class="Tests\Feature\Models\DisclosureTierVisibilityScopeTest" classname="Tests.Feature.Models.DisclosureTierVisibilityScopeTest" assertions="0" time="0.095548">
          <error type="RuntimeException">Tests\Feature\Models\DisclosureTierVisibilityScopeTest::test_product_get_visibility_status_helper&#13;
RuntimeException: LIFECYCLE VIOLATION: New products must start with 'draft' status. Attempted status: approved
&#13;
C:\PreIPO\backend\app\Models\Product.php:122
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1307
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php:347</error>
        </testcase>
        <testcase name="test_product_is_publicly_visible_by_company_tier_helper" file="C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php" line="322" class="Tests\Feature\Models\DisclosureTierVisibilityScopeTest" classname="Tests.Feature.Models.DisclosureTierVisibilityScopeTest" assertions="0" time="0.075949">
          <error type="RuntimeException">Tests\Feature\Models\DisclosureTierVisibilityScopeTest::test_product_is_publicly_visible_by_company_tier_helper&#13;
RuntimeException: LIFECYCLE VIOLATION: New products must start with 'draft' status. Attempted status: approved
&#13;
C:\PreIPO\backend\app\Models\Product.php:122
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1307
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php:324</error>
        </testcase>
        <testcase name="test_company_specific_tier_scopes" file="C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php" line="151" class="Tests\Feature\Models\DisclosureTierVisibilityScopeTest" classname="Tests.Feature.Models.DisclosureTierVisibilityScopeTest" assertions="1" time="0.081166">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\Models\DisclosureTierVisibilityScopeTest::test_company_specific_tier_scopes&#13;
Failed asserting that actual size 0 matches expected size 1.
&#13;
C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php:154</failure>
        </testcase>
        <testcase name="test_invariant_product_visibility_matches_company_visibility" file="C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php" line="427" class="Tests\Feature\Models\DisclosureTierVisibilityScopeTest" classname="Tests.Feature.Models.DisclosureTierVisibilityScopeTest" assertions="0" time="0.076449">
          <error type="RuntimeException">Tests\Feature\Models\DisclosureTierVisibilityScopeTest::test_invariant_product_visibility_matches_company_visibility&#13;
RuntimeException: LIFECYCLE VIOLATION: New products must start with 'draft' status. Attempted status: approved
&#13;
C:\PreIPO\backend\app\Models\Product.php:122
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1307
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php:431</error>
        </testcase>
        <testcase name="test_company_at_or_above_tier_scope" file="C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php" line="97" class="Tests\Feature\Models\DisclosureTierVisibilityScopeTest" classname="Tests.Feature.Models.DisclosureTierVisibilityScopeTest" assertions="1" time="0.073877">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\Models\DisclosureTierVisibilityScopeTest::test_company_at_or_above_tier_scope&#13;
Failed asserting that actual size 0 matches expected size 3.
&#13;
C:\PreIPO\backend\tests\Feature\Models\DisclosureTierVisibilityScopeTest.php:102</failure>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\FinancialDriftTest" file="C:\PreIPO\backend\tests\Feature\FinancialDriftTest.php" tests="1" assertions="6" errors="0" failures="0" skipped="0" time="0.084946">
        <testcase name="test_math_consistency_across_scenarios" file="C:\PreIPO\backend\tests\Feature\FinancialDriftTest.php" line="16" class="Tests\Feature\FinancialDriftTest" classname="Tests.Feature.FinancialDriftTest" assertions="6" time="0.084946"/>
      </testsuite>
      <testsuite name="Tests\Feature\RegisterRequestTest" file="C:\PreIPO\backend\tests\Feature\RegisterRequestTest.php" tests="5" assertions="20" errors="0" failures="3" skipped="0" time="0.424603">
        <testcase name="test_validates_referral_code_if_provided" file="C:\PreIPO\backend\tests\Feature\RegisterRequestTest.php" line="122" class="Tests\Feature\RegisterRequestTest" classname="Tests.Feature.RegisterRequestTest" assertions="1" time="0.075219">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\RegisterRequestTest::test_validates_referral_code_if_provided&#13;
Failed asserting that false is true.
&#13;
C:\PreIPO\backend\tests\Feature\RegisterRequestTest.php:125</failure>
        </testcase>
        <testcase name="test_validates_password_complexity" file="C:\PreIPO\backend\tests\Feature\RegisterRequestTest.php" line="97" class="Tests\Feature\RegisterRequestTest" classname="Tests.Feature.RegisterRequestTest" assertions="7" time="0.082407">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\RegisterRequestTest::test_validates_password_complexity&#13;
Failed asserting that false is true.
&#13;
C:\PreIPO\backend\tests\Feature\RegisterRequestTest.php:118</failure>
        </testcase>
        <testcase name="test_validates_username_format" file="C:\PreIPO\backend\tests\Feature\RegisterRequestTest.php" line="46" class="Tests\Feature\RegisterRequestTest" classname="Tests.Feature.RegisterRequestTest" assertions="5" time="0.105673">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\RegisterRequestTest::test_validates_username_format&#13;
Failed asserting that false is true.
&#13;
C:\PreIPO\backend\tests\Feature\RegisterRequestTest.php:62</failure>
        </testcase>
        <testcase name="test_validates_email_format" file="C:\PreIPO\backend\tests\Feature\RegisterRequestTest.php" line="66" class="Tests\Feature\RegisterRequestTest" classname="Tests.Feature.RegisterRequestTest" assertions="3" time="0.072581"/>
        <testcase name="test_validates_mobile_10_digits" file="C:\PreIPO\backend\tests\Feature\RegisterRequestTest.php" line="80" class="Tests\Feature\RegisterRequestTest" classname="Tests.Feature.RegisterRequestTest" assertions="4" time="0.088723"/>
      </testsuite>
      <testsuite name="Tests\Feature\AuthTest" file="C:\PreIPO\backend\tests\Feature\AuthTest.php" tests="13" assertions="27" errors="1" failures="2" skipped="0" time="20.280820">
        <testcase name="test_register_sends_otp_email_and_sms" file="C:\PreIPO\backend\tests\Feature\AuthTest.php" line="116" class="Tests\Feature\AuthTest" classname="Tests.Feature.AuthTest" assertions="3" time="1.599212"/>
        <testcase name="test_login_updates_last_login_timestamp" file="C:\PreIPO\backend\tests\Feature\AuthTest.php" line="236" class="Tests\Feature\AuthTest" classname="Tests.Feature.AuthTest" assertions="2" time="1.571274"/>
        <testcase name="test_login_rejects_suspended_account" file="C:\PreIPO\backend\tests\Feature\AuthTest.php" line="251" class="Tests\Feature\AuthTest" classname="Tests.Feature.AuthTest" assertions="2" time="1.692615"/>
        <testcase name="test_login_validates_credentials" file="C:\PreIPO\backend\tests\Feature\AuthTest.php" line="197" class="Tests\Feature\AuthTest" classname="Tests.Feature.AuthTest" assertions="2" time="1.602070"/>
        <testcase name="test_register_rejects_invalid_referral_code" file="C:\PreIPO\backend\tests\Feature\AuthTest.php" line="174" class="Tests\Feature\AuthTest" classname="Tests.Feature.AuthTest" assertions="3" time="1.566118"/>
        <testcase name="test_register_creates_wallet_for_new_user" file="C:\PreIPO\backend\tests\Feature\AuthTest.php" line="51" class="Tests\Feature\AuthTest" classname="Tests.Feature.AuthTest" assertions="2" time="1.595269"/>
        <testcase name="test_login_generates_jwt_token" file="C:\PreIPO\backend\tests\Feature\AuthTest.php" line="220" class="Tests\Feature\AuthTest" classname="Tests.Feature.AuthTest" assertions="3" time="1.558088"/>
        <testcase name="test_register_creates_user_with_hashed_password" file="C:\PreIPO\backend\tests\Feature\AuthTest.php" line="26" class="Tests\Feature\AuthTest" classname="Tests.Feature.AuthTest" assertions="4" time="1.596930"/>
        <testcase name="test_register_creates_profile_for_new_user" file="C:\PreIPO\backend\tests\Feature\AuthTest.php" line="73" class="Tests\Feature\AuthTest" classname="Tests.Feature.AuthTest" assertions="1" time="1.528340"/>
        <testcase name="test_login_rejects_blocked_account" file="C:\PreIPO\backend\tests\Feature\AuthTest.php" line="268" class="Tests\Feature\AuthTest" classname="Tests.Feature.AuthTest" assertions="1" time="1.533917">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AuthTest::test_login_rejects_blocked_account&#13;
Expected response status code [403] but received 429.
Failed asserting that 429 is identical to 403.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\AuthTest.php:280</failure>
        </testcase>
        <testcase name="test_register_generates_unique_referral_code" file="C:\PreIPO\backend\tests\Feature\AuthTest.php" line="94" class="Tests\Feature\AuthTest" classname="Tests.Feature.AuthTest" assertions="0" time="1.463124">
          <error type="ErrorException">Tests\Feature\AuthTest::test_register_generates_unique_referral_code&#13;
ErrorException: Attempt to read property "referral_code" on null
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bootstrap\HandleExceptions.php:258
C:\PreIPO\backend\tests\Feature\AuthTest.php:111</error>
        </testcase>
        <testcase name="test_register_validates_referral_code_if_provided" file="C:\PreIPO\backend\tests\Feature\AuthTest.php" line="147" class="Tests\Feature\AuthTest" classname="Tests.Feature.AuthTest" assertions="1" time="1.461867">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AuthTest::test_register_validates_referral_code_if_provided&#13;
Expected response status code [201] but received 429.
Failed asserting that 429 is identical to 201.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\AuthTest.php:167</failure>
        </testcase>
        <testcase name="test_logout_revokes_token" file="C:\PreIPO\backend\tests\Feature\AuthTest.php" line="285" class="Tests\Feature\AuthTest" classname="Tests.Feature.AuthTest" assertions="3" time="1.511996"/>
      </testsuite>
      <testsuite name="Tests\Feature\FullUserJourneyIntegrationTest" file="C:\PreIPO\backend\tests\Feature\FullUserJourneyIntegrationTest.php" tests="8" assertions="7" errors="4" failures="4" skipped="0" time="13.236028">
        <testcase name="bulk_bonus_award_to_multiple_users" file="C:\PreIPO\backend\tests\Feature\FullUserJourneyIntegrationTest.php" line="346" class="Tests\Feature\FullUserJourneyIntegrationTest" classname="Tests.Feature.FullUserJourneyIntegrationTest" assertions="3" time="1.658617">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\FullUserJourneyIntegrationTest::bulk_bonus_award_to_multiple_users&#13;
Failed asserting that 250 matches expected 350.
&#13;
C:\PreIPO\backend\tests\Feature\FullUserJourneyIntegrationTest.php:370</failure>
        </testcase>
        <testcase name="settings_update_clears_cache_correctly" file="C:\PreIPO\backend\tests\Feature\FullUserJourneyIntegrationTest.php" line="375" class="Tests\Feature\FullUserJourneyIntegrationTest" classname="Tests.Feature.FullUserJourneyIntegrationTest" assertions="1" time="1.799138">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\FullUserJourneyIntegrationTest::settings_update_clears_cache_correctly&#13;
Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\FullUserJourneyIntegrationTest.php:386</failure>
        </testcase>
        <testcase name="admin_wallet_adjustment_flow" file="C:\PreIPO\backend\tests\Feature\FullUserJourneyIntegrationTest.php" line="138" class="Tests\Feature\FullUserJourneyIntegrationTest" classname="Tests.Feature.FullUserJourneyIntegrationTest" assertions="2" time="1.890273">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\FullUserJourneyIntegrationTest::admin_wallet_adjustment_flow&#13;
Failed asserting that 500 matches expected 1500.
&#13;
C:\PreIPO\backend\tests\Feature\FullUserJourneyIntegrationTest.php:156</failure>
        </testcase>
        <testcase name="withdrawal_flow_with_locked_balance" file="C:\PreIPO\backend\tests\Feature\FullUserJourneyIntegrationTest.php" line="304" class="Tests\Feature\FullUserJourneyIntegrationTest" classname="Tests.Feature.FullUserJourneyIntegrationTest" assertions="0" time="1.558402">
          <error type="ArgumentCountError">Tests\Feature\FullUserJourneyIntegrationTest::withdrawal_flow_with_locked_balance&#13;
ArgumentCountError: Too few arguments to function App\Services\WalletService::__construct(), 0 passed in C:\PreIPO\backend\tests\Feature\FullUserJourneyIntegrationTest.php on line 312 and exactly 1 expected
&#13;
C:\PreIPO\backend\app\Services\WalletService.php:47
C:\PreIPO\backend\tests\Feature\FullUserJourneyIntegrationTest.php:312</error>
        </testcase>
        <testcase name="milestone_bonus_awarded_at_correct_month" file="C:\PreIPO\backend\tests\Feature\FullUserJourneyIntegrationTest.php" line="186" class="Tests\Feature\FullUserJourneyIntegrationTest" classname="Tests.Feature.FullUserJourneyIntegrationTest" assertions="0" time="1.593008">
          <error type="Illuminate\Database\QueryException">Tests\Feature\FullUserJourneyIntegrationTest::milestone_bonus_awarded_at_correct_month&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1364 Field 'amount' doesn't have a default value (Connection: mysql, SQL: insert into `subscriptions` (`user_id`, `plan_id`, `status`, `consecutive_payments_count`, `bonus_multiplier`, `updated_at`, `created_at`) values (15664, 5193, active, 5, 1, 2026-02-22 10:32:57, 2026-02-22 10:32:57))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Feature\FullUserJourneyIntegrationTest.php:193</error>
        </testcase>
        <testcase name="concurrent_wallet_operations_maintain_integrity" file="C:\PreIPO\backend\tests\Feature\FullUserJourneyIntegrationTest.php" line="399" class="Tests\Feature\FullUserJourneyIntegrationTest" classname="Tests.Feature.FullUserJourneyIntegrationTest" assertions="0" time="1.552048">
          <error type="ArgumentCountError">Tests\Feature\FullUserJourneyIntegrationTest::concurrent_wallet_operations_maintain_integrity&#13;
ArgumentCountError: Too few arguments to function App\Services\WalletService::__construct(), 0 passed in C:\PreIPO\backend\tests\Feature\FullUserJourneyIntegrationTest.php on line 405 and exactly 1 expected
&#13;
C:\PreIPO\backend\app\Services\WalletService.php:47
C:\PreIPO\backend\tests\Feature\FullUserJourneyIntegrationTest.php:405</error>
        </testcase>
        <testcase name="referral_multiplier_affects_bonus_calculation" file="C:\PreIPO\backend\tests\Feature\FullUserJourneyIntegrationTest.php" line="244" class="Tests\Feature\FullUserJourneyIntegrationTest" classname="Tests.Feature.FullUserJourneyIntegrationTest" assertions="0" time="1.614254">
          <error type="Illuminate\Database\QueryException">Tests\Feature\FullUserJourneyIntegrationTest::referral_multiplier_affects_bonus_calculation&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1364 Field 'amount' doesn't have a default value (Connection: mysql, SQL: insert into `subscriptions` (`user_id`, `plan_id`, `status`, `consecutive_payments_count`, `bonus_multiplier`, `updated_at`, `created_at`) values (15676, 5203, active, 4, 2, 2026-02-22 10:33:00, 2026-02-22 10:33:00))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Feature\FullUserJourneyIntegrationTest.php:251</error>
        </testcase>
        <testcase name="complete_user_registration_to_first_bonus_journey" file="C:\PreIPO\backend\tests\Feature\FullUserJourneyIntegrationTest.php" line="53" class="Tests\Feature\FullUserJourneyIntegrationTest" classname="Tests.Feature.FullUserJourneyIntegrationTest" assertions="1" time="1.570288">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\FullUserJourneyIntegrationTest::complete_user_registration_to_first_bonus_journey&#13;
Expected response status code [201] but received 404.
Failed asserting that 404 is identical to 201.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\FullUserJourneyIntegrationTest.php:64</failure>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\Models\CompanyDisclosureTierImmutabilityTest" file="C:\PreIPO\backend\tests\Feature\Models\CompanyDisclosureTierImmutabilityTest.php" tests="9" assertions="12" errors="0" failures="5" skipped="0" time="0.677990">
        <testcase name="test_initial_tier_assignment_on_creation_is_allowed" file="C:\PreIPO\backend\tests\Feature\Models\CompanyDisclosureTierImmutabilityTest.php" line="114" class="Tests\Feature\Models\CompanyDisclosureTierImmutabilityTest" classname="Tests.Feature.Models.CompanyDisclosureTierImmutabilityTest" assertions="1" time="0.089812">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\Models\CompanyDisclosureTierImmutabilityTest::test_initial_tier_assignment_on_creation_is_allowed&#13;
Failed asserting that null matches expected 'tier_1_upcoming'.
&#13;
C:\PreIPO\backend\tests\Feature\Models\CompanyDisclosureTierImmutabilityTest.php:123</failure>
        </testcase>
        <testcase name="test_update_modification_is_blocked" file="C:\PreIPO\backend\tests\Feature\Models\CompanyDisclosureTierImmutabilityTest.php" line="49" class="Tests\Feature\Models\CompanyDisclosureTierImmutabilityTest" classname="Tests.Feature.Models.CompanyDisclosureTierImmutabilityTest" assertions="1" time="0.059026">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\Models\CompanyDisclosureTierImmutabilityTest::test_update_modification_is_blocked&#13;
Failed asserting that exception of type "App\Exceptions\DisclosureTierImmutabilityException" is thrown.</failure>
        </testcase>
        <testcase name="test_disclosure_tier_not_in_fillable" file="C:\PreIPO\backend\tests\Feature\Models\CompanyDisclosureTierImmutabilityTest.php" line="88" class="Tests\Feature\Models\CompanyDisclosureTierImmutabilityTest" classname="Tests.Feature.Models.CompanyDisclosureTierImmutabilityTest" assertions="1" time="0.067876"/>
        <testcase name="test_fill_and_save_modification_is_blocked" file="C:\PreIPO\backend\tests\Feature\Models\CompanyDisclosureTierImmutabilityTest.php" line="62" class="Tests\Feature\Models\CompanyDisclosureTierImmutabilityTest" classname="Tests.Feature.Models.CompanyDisclosureTierImmutabilityTest" assertions="1" time="0.072345">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\Models\CompanyDisclosureTierImmutabilityTest::test_fill_and_save_modification_is_blocked&#13;
Failed asserting that exception of type "App\Exceptions\DisclosureTierImmutabilityException" is thrown.</failure>
        </testcase>
        <testcase name="test_set_attribute_modification_is_blocked" file="C:\PreIPO\backend\tests\Feature\Models\CompanyDisclosureTierImmutabilityTest.php" line="76" class="Tests\Feature\Models\CompanyDisclosureTierImmutabilityTest" classname="Tests.Feature.Models.CompanyDisclosureTierImmutabilityTest" assertions="2" time="0.067477"/>
        <testcase name="test_other_fields_can_be_modified" file="C:\PreIPO\backend\tests\Feature\Models\CompanyDisclosureTierImmutabilityTest.php" line="97" class="Tests\Feature\Models\CompanyDisclosureTierImmutabilityTest" classname="Tests.Feature.Models.CompanyDisclosureTierImmutabilityTest" assertions="1" time="0.079771"/>
        <testcase name="test_direct_save_modification_is_blocked" file="C:\PreIPO\backend\tests\Feature\Models\CompanyDisclosureTierImmutabilityTest.php" line="37" class="Tests\Feature\Models\CompanyDisclosureTierImmutabilityTest" classname="Tests.Feature.Models.CompanyDisclosureTierImmutabilityTest" assertions="2" time="0.071821"/>
        <testcase name="test_exception_contains_correct_context" file="C:\PreIPO\backend\tests\Feature\Models\CompanyDisclosureTierImmutabilityTest.php" line="144" class="Tests\Feature\Models\CompanyDisclosureTierImmutabilityTest" classname="Tests.Feature.Models.CompanyDisclosureTierImmutabilityTest" assertions="2" time="0.062106">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\Models\CompanyDisclosureTierImmutabilityTest::test_exception_contains_correct_context&#13;
Failed asserting that null matches expected 'tier_0_pending'.
&#13;
C:\PreIPO\backend\tests\Feature\Models\CompanyDisclosureTierImmutabilityTest.php:152</failure>
        </testcase>
        <testcase name="test_modification_blocked_in_larger_update" file="C:\PreIPO\backend\tests\Feature\Models\CompanyDisclosureTierImmutabilityTest.php" line="129" class="Tests\Feature\Models\CompanyDisclosureTierImmutabilityTest" classname="Tests.Feature.Models.CompanyDisclosureTierImmutabilityTest" assertions="1" time="0.107756">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\Models\CompanyDisclosureTierImmutabilityTest::test_modification_blocked_in_larger_update&#13;
Failed asserting that exception of type "App\Exceptions\DisclosureTierImmutabilityException" is thrown.</failure>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Unit\MaintenanceModeTest" file="C:\PreIPO\backend\tests\Feature\MaintenanceModeTest.php" tests="4" assertions="6" errors="0" failures="0" skipped="0" time="4.619259">
        <testcase name="test_maintenance_mode_shows_custom_message" file="C:\PreIPO\backend\tests\Feature\MaintenanceModeTest.php" line="73" class="Tests\Unit\MaintenanceModeTest" classname="Tests.Unit.MaintenanceModeTest" assertions="2" time="0.886269"/>
        <testcase name="test_maintenance_mode_respects_ip_whitelist" file="C:\PreIPO\backend\tests\Feature\MaintenanceModeTest.php" line="84" class="Tests\Unit\MaintenanceModeTest" classname="Tests.Unit.MaintenanceModeTest" assertions="1" time="1.618721"/>
        <testcase name="test_maintenance_mode_allows_admins" file="C:\PreIPO\backend\tests\Feature\MaintenanceModeTest.php" line="57" class="Tests\Unit\MaintenanceModeTest" classname="Tests.Unit.MaintenanceModeTest" assertions="2" time="1.156749"/>
        <testcase name="test_maintenance_mode_blocks_all_users" file="C:\PreIPO\backend\tests\Feature\MaintenanceModeTest.php" line="46" class="Tests\Unit\MaintenanceModeTest" classname="Tests.Unit.MaintenanceModeTest" assertions="1" time="0.957520"/>
      </testsuite>
      <testsuite name="Tests\Feature\UserProfileEndpointsTest" file="C:\PreIPO\backend\tests\Feature\UserProfileEndpointsTest.php" tests="14" assertions="30" errors="0" failures="4" skipped="0" time="13.786411">
        <testcase name="testUploadAvatarSucceeds" file="C:\PreIPO\backend\tests\Feature\UserProfileEndpointsTest.php" line="93" class="Tests\Feature\UserProfileEndpointsTest" classname="Tests.Feature.UserProfileEndpointsTest" assertions="3" time="0.982904"/>
        <testcase name="testUnauthorizedAccessToProfileFails" file="C:\PreIPO\backend\tests\Feature\UserProfileEndpointsTest.php" line="35" class="Tests\Feature\UserProfileEndpointsTest" classname="Tests.Feature.UserProfileEndpointsTest" assertions="1" time="0.926596"/>
        <testcase name="testUpdateBankDetailsValidatesAccountNumberLength" file="C:\PreIPO\backend\tests\Feature\UserProfileEndpointsTest.php" line="240" class="Tests\Feature\UserProfileEndpointsTest" classname="Tests.Feature.UserProfileEndpointsTest" assertions="1" time="0.962447">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\UserProfileEndpointsTest::testUpdateBankDetailsValidatesAccountNumberLength&#13;
Expected response status code [422] but received 404.
Failed asserting that 404 is identical to 422.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\UserProfileEndpointsTest.php:247</failure>
        </testcase>
        <testcase name="testChangePasswordRequiresOldPassword" file="C:\PreIPO\backend\tests\Feature\UserProfileEndpointsTest.php" line="132" class="Tests\Feature\UserProfileEndpointsTest" classname="Tests.Feature.UserProfileEndpointsTest" assertions="3" time="0.974777"/>
        <testcase name="testProfileUpdateValidation" file="C:\PreIPO\backend\tests\Feature\UserProfileEndpointsTest.php" line="82" class="Tests\Feature\UserProfileEndpointsTest" classname="Tests.Feature.UserProfileEndpointsTest" assertions="3" time="0.957075"/>
        <testcase name="testGetBankDetailsReturnsUserData" file="C:\PreIPO\backend\tests\Feature\UserProfileEndpointsTest.php" line="252" class="Tests\Feature\UserProfileEndpointsTest" classname="Tests.Feature.UserProfileEndpointsTest" assertions="1" time="1.009060">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\UserProfileEndpointsTest::testGetBankDetailsReturnsUserData&#13;
Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\UserProfileEndpointsTest.php:262</failure>
        </testcase>
        <testcase name="testUpdateProfileWithValidData" file="C:\PreIPO\backend\tests\Feature\UserProfileEndpointsTest.php" line="65" class="Tests\Feature\UserProfileEndpointsTest" classname="Tests.Feature.UserProfileEndpointsTest" assertions="2" time="0.937662"/>
        <testcase name="testProfileIncludesKycStatus" file="C:\PreIPO\backend\tests\Feature\UserProfileEndpointsTest.php" line="56" class="Tests\Feature\UserProfileEndpointsTest" classname="Tests.Feature.UserProfileEndpointsTest" assertions="2" time="0.950231"/>
        <testcase name="testChangePasswordWithValidData" file="C:\PreIPO\backend\tests\Feature\UserProfileEndpointsTest.php" line="113" class="Tests\Feature\UserProfileEndpointsTest" classname="Tests.Feature.UserProfileEndpointsTest" assertions="4" time="0.909976"/>
        <testcase name="testUserCannotAccessAnotherUsersProfileData" file="C:\PreIPO\backend\tests\Feature\UserProfileEndpointsTest.php" line="181" class="Tests\Feature\UserProfileEndpointsTest" classname="Tests.Feature.UserProfileEndpointsTest" assertions="3" time="0.922963"/>
        <testcase name="testUserCannotEditAnotherUsersProfile" file="C:\PreIPO\backend\tests\Feature\UserProfileEndpointsTest.php" line="148" class="Tests\Feature\UserProfileEndpointsTest" classname="Tests.Feature.UserProfileEndpointsTest" assertions="3" time="1.068499"/>
        <testcase name="testUpdateBankDetailsValidatesIfscFormat" file="C:\PreIPO\backend\tests\Feature\UserProfileEndpointsTest.php" line="228" class="Tests\Feature\UserProfileEndpointsTest" classname="Tests.Feature.UserProfileEndpointsTest" assertions="1" time="1.173296">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\UserProfileEndpointsTest::testUpdateBankDetailsValidatesIfscFormat&#13;
Expected response status code [422] but received 404.
Failed asserting that 404 is identical to 422.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\UserProfileEndpointsTest.php:235</failure>
        </testcase>
        <testcase name="testUpdateBankDetailsWithValidData" file="C:\PreIPO\backend\tests\Feature\UserProfileEndpointsTest.php" line="210" class="Tests\Feature\UserProfileEndpointsTest" classname="Tests.Feature.UserProfileEndpointsTest" assertions="1" time="0.958619">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\UserProfileEndpointsTest::testUpdateBankDetailsWithValidData&#13;
Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\UserProfileEndpointsTest.php:217</failure>
        </testcase>
        <testcase name="testGetProfileReturnsUserData" file="C:\PreIPO\backend\tests\Feature\UserProfileEndpointsTest.php" line="43" class="Tests\Feature\UserProfileEndpointsTest" classname="Tests.Feature.UserProfileEndpointsTest" assertions="2" time="1.052306"/>
      </testsuite>
      <testsuite name="Tests\Feature\KycTest" file="C:\PreIPO\backend\tests\Feature\KycTest.php" tests="3" assertions="2" errors="1" failures="2" skipped="0" time="1.127175">
        <testcase name="admin_can_approve_kyc" file="C:\PreIPO\backend\tests\Feature\KycTest.php" line="64" class="Tests\Feature\KycTest" classname="Tests.Feature.KycTest" assertions="1" time="0.423700">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\KycTest::admin_can_approve_kyc&#13;
Expected response status code [200] but received 500.
Failed asserting that 500 is identical to 200.&#13;
&#13;
The following exception occurred during the last request:

ErrorException: Attempt to read property "value" on string in C:\PreIPO\backend\app\Services\Kyc\KycStatusService.php:98
Stack trace:
#0 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bootstrap\HandleExceptions.php(258): Illuminate\Foundation\Bootstrap\HandleExceptions-&gt;handleError(2, 'Attempt to read...', 'C:\\PreIPO\\backe...', 98)
#1 C:\PreIPO\backend\app\Services\Kyc\KycStatusService.php(98): Illuminate\Foundation\Bootstrap\HandleExceptions-&gt;Illuminate\Foundation\Bootstrap\{closure}(2, 'Attempt to read...', 'C:\\PreIPO\\backe...', 98)
#2 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php(32): App\Services\Kyc\KycStatusService-&gt;App\Services\Kyc\{closure}(Object(Illuminate\Database\MySqlConnection))
#3 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php(495): Illuminate\Database\Connection-&gt;transaction(Object(Closure))
#4 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php(361): Illuminate\Database\DatabaseManager-&gt;__call('transaction', Array)
#5 C:\PreIPO\backend\app\Services\Kyc\KycStatusService.php(60): Illuminate\Support\Facades\Facade::__callStatic('transaction', Array)
#6 C:\PreIPO\backend\app\Http\Controllers\Api\Admin\KycQueueController.php(119): App\Services\Kyc\KycStatusService-&gt;transitionTo(Object(App\Models\UserKyc), Object(App\Enums\KycStatus), Array)
#7 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php(32): App\Http\Controllers\Api\Admin\KycQueueController-&gt;App\Http\Controllers\Api\Admin\{closure}(Object(Illuminate\Database\MySqlConnection))
#8 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php(495): Illuminate\Database\Connection-&gt;transaction(Object(Closure))
#9 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php(361): Illuminate\Database\DatabaseManager-&gt;__call('transaction', Array)
#10 C:\PreIPO\backend\app\Http\Controllers\Api\Admin\KycQueueController.php(115): Illuminate\Support\Facades\Facade::__callStatic('transaction', Array)
#11 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(47): App\Http\Controllers\Api\Admin\KycQueueController-&gt;approve(Object(Illuminate\Http\Request), '15603')
#12 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(266): Illuminate\Routing\ControllerDispatcher-&gt;dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\Admin\KycQueueController), 'approve')
#13 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(212): Illuminate\Routing\Route-&gt;runController()
#14 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(808): Illuminate\Routing\Route-&gt;run()
#15 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Routing\Router-&gt;Illuminate\Routing\{closure}(Object(Illuminate\Http\Request))
#16 C:\PreIPO\backend\app\Http\Middleware\CheckPermission.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#17 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckPermission-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'kyc.approve')
#18 C:\PreIPO\backend\vendor\spatie\laravel-permission\src\Middleware\RoleMiddleware.php(37): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#19 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Spatie\Permission\Middleware\RoleMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'admin|super-adm...')
#20 C:\PreIPO\backend\app\Http\Middleware\AdminIpRestriction.php(43): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#21 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\AdminIpRestriction-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#22 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#23 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#24 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(161): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#25 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(127): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequest(Object(Illuminate\Http\Request), Object(Closure), Array)
#26 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(89): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequestUsingNamedLimiter(Object(Illuminate\Http\Request), Object(Closure), 'admin-actions', Object(Closure))
#27 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'admin-actions')
#28 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Auth\Middleware\Authenticate.php(64): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#29 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'sanctum')
#30 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#31 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(807): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#32 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(786): Illuminate\Routing\Router-&gt;runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#33 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(750): Illuminate\Routing\Router-&gt;runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#34 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(739): Illuminate\Routing\Router-&gt;dispatchToRoute(Object(Illuminate\Http\Request))
#35 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(201): Illuminate\Routing\Router-&gt;dispatch(Object(Illuminate\Http\Request))
#36 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Foundation\Http\Kernel-&gt;Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#37 C:\PreIPO\backend\app\Http\Middleware\RedirectMiddleware.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#38 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\RedirectMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#39 C:\PreIPO\backend\app\Http\Middleware\CheckMaintenanceMode.php(48): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#40 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckMaintenanceMode-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#41 C:\PreIPO\backend\app\Http\Middleware\SanitizeInput.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\SanitizeInput-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#43 C:\PreIPO\backend\app\Http\Middleware\ForceHttps.php(23): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#44 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\ForceHttps-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#45 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#46 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#47 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#48 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#49 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#50 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#51 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#52 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#53 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#54 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#55 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#56 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#57 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\HandleCors.php(62): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#58 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\HandleCors-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#59 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#60 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#61 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#62 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#63 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#64 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(176): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#65 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(145): Illuminate\Foundation\Http\Kernel-&gt;sendRequestThroughRouter(Object(Illuminate\Http\Request))
#66 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel-&gt;handle(Object(Illuminate\Http\Request))
#67 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase-&gt;call('POST', '/api/v1/admin/k...', Array, Array, Array, Array, '[]')
#68 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase-&gt;json('POST', '/api/v1/admin/k...', Array, Array, 0)
#69 C:\PreIPO\backend\tests\Feature\KycTest.php(70): Illuminate\Foundation\Testing\TestCase-&gt;postJson('/api/v1/admin/k...')
#70 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(1667): Tests\Feature\KycTest-&gt;admin_can_approve_kyc()
#71 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(519): PHPUnit\Framework\TestCase-&gt;runTest()
#72 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestRunner\TestRunner.php(87): PHPUnit\Framework\TestCase-&gt;runBare()
#73 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(365): PHPUnit\Framework\TestRunner-&gt;run(Object(Tests\Feature\KycTest))
#74 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestCase-&gt;run()
#75 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#76 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#77 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\TestRunner.php(64): PHPUnit\Framework\TestSuite-&gt;run()
#78 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\Application.php(211): PHPUnit\TextUI\TestRunner-&gt;run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#79 C:\PreIPO\backend\vendor\phpunit\phpunit\phpunit(104): PHPUnit\TextUI\Application-&gt;run(Array)
#80 {main}

----------------------------------------------------------------------------------

Attempt to read property "value" on string
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\KycTest.php:72</failure>
        </testcase>
        <testcase name="admin_can_reject_kyc_with_reason" file="C:\PreIPO\backend\tests\Feature\KycTest.php" line="80" class="Tests\Feature\KycTest" classname="Tests.Feature.KycTest" assertions="1" time="0.443075">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\KycTest::admin_can_reject_kyc_with_reason&#13;
Expected response status code [200] but received 500.
Failed asserting that 500 is identical to 200.&#13;
&#13;
The following exception occurred during the last request:

ErrorException: Attempt to read property "value" on string in C:\PreIPO\backend\app\Services\Kyc\KycStatusService.php:98
Stack trace:
#0 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bootstrap\HandleExceptions.php(258): Illuminate\Foundation\Bootstrap\HandleExceptions-&gt;handleError(2, 'Attempt to read...', 'C:\\PreIPO\\backe...', 98)
#1 C:\PreIPO\backend\app\Services\Kyc\KycStatusService.php(98): Illuminate\Foundation\Bootstrap\HandleExceptions-&gt;Illuminate\Foundation\Bootstrap\{closure}(2, 'Attempt to read...', 'C:\\PreIPO\\backe...', 98)
#2 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php(32): App\Services\Kyc\KycStatusService-&gt;App\Services\Kyc\{closure}(Object(Illuminate\Database\MySqlConnection))
#3 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php(495): Illuminate\Database\Connection-&gt;transaction(Object(Closure))
#4 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php(361): Illuminate\Database\DatabaseManager-&gt;__call('transaction', Array)
#5 C:\PreIPO\backend\app\Services\Kyc\KycStatusService.php(60): Illuminate\Support\Facades\Facade::__callStatic('transaction', Array)
#6 C:\PreIPO\backend\app\Http\Controllers\Api\Admin\KycQueueController.php(171): App\Services\Kyc\KycStatusService-&gt;transitionTo(Object(App\Models\UserKyc), Object(App\Enums\KycStatus), Array)
#7 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php(32): App\Http\Controllers\Api\Admin\KycQueueController-&gt;App\Http\Controllers\Api\Admin\{closure}(Object(Illuminate\Database\MySqlConnection))
#8 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php(495): Illuminate\Database\Connection-&gt;transaction(Object(Closure))
#9 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php(361): Illuminate\Database\DatabaseManager-&gt;__call('transaction', Array)
#10 C:\PreIPO\backend\app\Http\Controllers\Api\Admin\KycQueueController.php(168): Illuminate\Support\Facades\Facade::__callStatic('transaction', Array)
#11 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(47): App\Http\Controllers\Api\Admin\KycQueueController-&gt;reject(Object(Illuminate\Http\Request), '15607')
#12 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(266): Illuminate\Routing\ControllerDispatcher-&gt;dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\Admin\KycQueueController), 'reject')
#13 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(212): Illuminate\Routing\Route-&gt;runController()
#14 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(808): Illuminate\Routing\Route-&gt;run()
#15 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Routing\Router-&gt;Illuminate\Routing\{closure}(Object(Illuminate\Http\Request))
#16 C:\PreIPO\backend\app\Http\Middleware\CheckPermission.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#17 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckPermission-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'kyc.reject')
#18 C:\PreIPO\backend\vendor\spatie\laravel-permission\src\Middleware\RoleMiddleware.php(37): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#19 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Spatie\Permission\Middleware\RoleMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'admin|super-adm...')
#20 C:\PreIPO\backend\app\Http\Middleware\AdminIpRestriction.php(43): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#21 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\AdminIpRestriction-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#22 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#23 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#24 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(161): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#25 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(127): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequest(Object(Illuminate\Http\Request), Object(Closure), Array)
#26 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(89): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequestUsingNamedLimiter(Object(Illuminate\Http\Request), Object(Closure), 'admin-actions', Object(Closure))
#27 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'admin-actions')
#28 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Auth\Middleware\Authenticate.php(64): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#29 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'sanctum')
#30 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#31 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(807): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#32 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(786): Illuminate\Routing\Router-&gt;runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#33 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(750): Illuminate\Routing\Router-&gt;runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#34 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(739): Illuminate\Routing\Router-&gt;dispatchToRoute(Object(Illuminate\Http\Request))
#35 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(201): Illuminate\Routing\Router-&gt;dispatch(Object(Illuminate\Http\Request))
#36 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Foundation\Http\Kernel-&gt;Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#37 C:\PreIPO\backend\app\Http\Middleware\RedirectMiddleware.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#38 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\RedirectMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#39 C:\PreIPO\backend\app\Http\Middleware\CheckMaintenanceMode.php(48): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#40 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckMaintenanceMode-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#41 C:\PreIPO\backend\app\Http\Middleware\SanitizeInput.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\SanitizeInput-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#43 C:\PreIPO\backend\app\Http\Middleware\ForceHttps.php(23): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#44 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\ForceHttps-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#45 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#46 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#47 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#48 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#49 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#50 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#51 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#52 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#53 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#54 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#55 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#56 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#57 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\HandleCors.php(62): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#58 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\HandleCors-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#59 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#60 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#61 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#62 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#63 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#64 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(176): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#65 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(145): Illuminate\Foundation\Http\Kernel-&gt;sendRequestThroughRouter(Object(Illuminate\Http\Request))
#66 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel-&gt;handle(Object(Illuminate\Http\Request))
#67 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase-&gt;call('POST', '/api/v1/admin/k...', Array, Array, Array, Array, '{"reason":"Blur...')
#68 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase-&gt;json('POST', '/api/v1/admin/k...', Array, Array, 0)
#69 C:\PreIPO\backend\tests\Feature\KycTest.php(86): Illuminate\Foundation\Testing\TestCase-&gt;postJson('/api/v1/admin/k...', Array)
#70 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(1667): Tests\Feature\KycTest-&gt;admin_can_reject_kyc_with_reason()
#71 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(519): PHPUnit\Framework\TestCase-&gt;runTest()
#72 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestRunner\TestRunner.php(87): PHPUnit\Framework\TestCase-&gt;runBare()
#73 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(365): PHPUnit\Framework\TestRunner-&gt;run(Object(Tests\Feature\KycTest))
#74 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestCase-&gt;run()
#75 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#76 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#77 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\TestRunner.php(64): PHPUnit\Framework\TestSuite-&gt;run()
#78 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\Application.php(211): PHPUnit\TextUI\TestRunner-&gt;run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#79 C:\PreIPO\backend\vendor\phpunit\phpunit\phpunit(104): PHPUnit\TextUI\Application-&gt;run(Array)
#80 {main}

----------------------------------------------------------------------------------

Attempt to read property "value" on string
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\KycTest.php:90</failure>
        </testcase>
        <testcase name="user_can_upload_kyc_documents" file="C:\PreIPO\backend\tests\Feature\KycTest.php" line="32" class="Tests\Feature\KycTest" classname="Tests.Feature.KycTest" assertions="0" time="0.260400">
          <error type="Error">Tests\Feature\KycTest::user_can_upload_kyc_documents&#13;
Error: Call to undefined method Illuminate\Http\Testing\FileFactory::pdf()
&#13;
C:\PreIPO\backend\tests\Feature\KycTest.php:47</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\FinancialGuaranteesTest" file="C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php" tests="9" assertions="0" errors="9" failures="0" skipped="0" time="14.650478">
        <testcase name="no_negative_wallet_balances_exist" file="C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php" line="221" class="Tests\Feature\FinancialGuaranteesTest" classname="Tests.Feature.FinancialGuaranteesTest" assertions="0" time="0.976774">
          <error type="RuntimeException">Tests\Feature\FinancialGuaranteesTest::no_negative_wallet_balances_exist&#13;
RuntimeException: Subscription #3561 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:80
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:56
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\Dispatchable.php:19
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:74
C:\PreIPO\backend\app\Services\IdempotencyService.php:206
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:52
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\DatabaseTransactionsManager.php:39
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:51
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:751
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php:119
C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php:223</error>
        </testcase>
        <testcase name="receivables_match_outstanding_chargebacks" file="C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php" line="380" class="Tests\Feature\FinancialGuaranteesTest" classname="Tests.Feature.FinancialGuaranteesTest" assertions="0" time="1.694715">
          <error type="RuntimeException">Tests\Feature\FinancialGuaranteesTest::receivables_match_outstanding_chargebacks&#13;
RuntimeException: Subscription #3563 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:80
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:56
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\Dispatchable.php:19
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:74
C:\PreIPO\backend\app\Services\IdempotencyService.php:206
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:52
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\DatabaseTransactionsManager.php:39
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:51
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:751
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php:119
C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php:382</error>
        </testcase>
        <testcase name="bonus_payouts_reconcile_with_wallet_credits" file="C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php" line="283" class="Tests\Feature\FinancialGuaranteesTest" classname="Tests.Feature.FinancialGuaranteesTest" assertions="0" time="1.658142">
          <error type="RuntimeException">Tests\Feature\FinancialGuaranteesTest::bonus_payouts_reconcile_with_wallet_credits&#13;
RuntimeException: Subscription #3565 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:80
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:56
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\Dispatchable.php:19
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:74
C:\PreIPO\backend\app\Services\IdempotencyService.php:206
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:52
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\DatabaseTransactionsManager.php:39
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:51
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:751
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php:119
C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php:285</error>
        </testcase>
        <testcase name="ledger_debits_equal_credits" file="C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php" line="184" class="Tests\Feature\FinancialGuaranteesTest" classname="Tests.Feature.FinancialGuaranteesTest" assertions="0" time="1.645468">
          <error type="RuntimeException">Tests\Feature\FinancialGuaranteesTest::ledger_debits_equal_credits&#13;
RuntimeException: Subscription #3567 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:80
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:56
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\Dispatchable.php:19
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:74
C:\PreIPO\backend\app\Services\IdempotencyService.php:206
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:52
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\DatabaseTransactionsManager.php:39
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:51
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:751
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php:119
C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php:186</error>
        </testcase>
        <testcase name="subscription_revenue_matches_paid_payments" file="C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php" line="239" class="Tests\Feature\FinancialGuaranteesTest" classname="Tests.Feature.FinancialGuaranteesTest" assertions="0" time="1.757152">
          <error type="RuntimeException">Tests\Feature\FinancialGuaranteesTest::subscription_revenue_matches_paid_payments&#13;
RuntimeException: Subscription #3569 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:80
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:56
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\Dispatchable.php:19
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:74
C:\PreIPO\backend\app\Services\IdempotencyService.php:206
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:52
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\DatabaseTransactionsManager.php:39
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:51
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:751
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php:119
C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php:241</error>
        </testcase>
        <testcase name="wallet_balances_mirror_liability_ledger" file="C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php" line="346" class="Tests\Feature\FinancialGuaranteesTest" classname="Tests.Feature.FinancialGuaranteesTest" assertions="0" time="1.715146">
          <error type="RuntimeException">Tests\Feature\FinancialGuaranteesTest::wallet_balances_mirror_liability_ledger&#13;
RuntimeException: Subscription #3571 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:80
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:56
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\Dispatchable.php:19
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:74
C:\PreIPO\backend\app\Services\IdempotencyService.php:206
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:52
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\DatabaseTransactionsManager.php:39
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:51
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:751
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php:119
C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php:348</error>
        </testcase>
        <testcase name="no_orphaned_wallet_transactions_exist" file="C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php" line="312" class="Tests\Feature\FinancialGuaranteesTest" classname="Tests.Feature.FinancialGuaranteesTest" assertions="0" time="1.767160">
          <error type="RuntimeException">Tests\Feature\FinancialGuaranteesTest::no_orphaned_wallet_transactions_exist&#13;
RuntimeException: Subscription #3572 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:80
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:56
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\Dispatchable.php:19
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:74
C:\PreIPO\backend\app\Services\IdempotencyService.php:206
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:52
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\DatabaseTransactionsManager.php:39
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:51
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:751
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php:119
C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php:314</error>
        </testcase>
        <testcase name="wallet_balances_reconcile_with_transaction_history" file="C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php" line="149" class="Tests\Feature\FinancialGuaranteesTest" classname="Tests.Feature.FinancialGuaranteesTest" assertions="0" time="1.672493">
          <error type="RuntimeException">Tests\Feature\FinancialGuaranteesTest::wallet_balances_reconcile_with_transaction_history&#13;
RuntimeException: Subscription #3574 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:80
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:56
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\Dispatchable.php:19
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:74
C:\PreIPO\backend\app\Services\IdempotencyService.php:206
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:52
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\DatabaseTransactionsManager.php:39
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:51
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:751
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php:119
C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php:151</error>
        </testcase>
        <testcase name="full_financial_reconciliation_passes" file="C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php" line="416" class="Tests\Feature\FinancialGuaranteesTest" classname="Tests.Feature.FinancialGuaranteesTest" assertions="0" time="1.763428">
          <error type="RuntimeException">Tests\Feature\FinancialGuaranteesTest::full_financial_reconciliation_passes&#13;
RuntimeException: Subscription #3576 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:80
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Jobs\ProcessPaymentBonusJob.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:56
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\Dispatchable.php:19
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:74
C:\PreIPO\backend\app\Services\IdempotencyService.php:206
C:\PreIPO\backend\app\Jobs\ProcessSuccessfulPaymentJob.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:130
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:126
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:170
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php:127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:121
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\CallQueuedHandler.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\Jobs\Job.php:102
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:76
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:52
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\DatabaseTransactionsManager.php:39
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Queue\SyncQueue.php:51
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:244
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:228
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Bus\Dispatcher.php:77
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bus\PendingDispatch.php:222
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:751
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php:119
C:\PreIPO\backend\tests\Feature\FinancialGuaranteesTest.php:418</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\DailyDisputeSnapshotTest" file="C:\PreIPO\backend\tests\Feature\DailyDisputeSnapshotTest.php" tests="13" assertions="10" errors="4" failures="4" skipped="0" time="12.045274">
        <testcase name="snapshot_platform_wide_scope_works" file="C:\PreIPO\backend\tests\Feature\DailyDisputeSnapshotTest.php" line="327" class="Tests\Feature\DailyDisputeSnapshotTest" classname="Tests.Feature.DailyDisputeSnapshotTest" assertions="1" time="0.970280"/>
        <testcase name="snapshot_records_correct_status_counts" file="C:\PreIPO\backend\tests\Feature\DailyDisputeSnapshotTest.php" line="205" class="Tests\Feature\DailyDisputeSnapshotTest" classname="Tests.Feature.DailyDisputeSnapshotTest" assertions="0" time="1.127009">
          <error type="ErrorException">Tests\Feature\DailyDisputeSnapshotTest::snapshot_records_correct_status_counts&#13;
ErrorException: Attempt to read property "open_disputes" on null
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bootstrap\HandleExceptions.php:258
C:\PreIPO\backend\tests\Feature\DailyDisputeSnapshotTest.php:223</error>
        </testcase>
        <testcase name="snapshot_records_correct_severity_counts" file="C:\PreIPO\backend\tests\Feature\DailyDisputeSnapshotTest.php" line="178" class="Tests\Feature\DailyDisputeSnapshotTest" classname="Tests.Feature.DailyDisputeSnapshotTest" assertions="0" time="1.057142">
          <error type="ErrorException">Tests\Feature\DailyDisputeSnapshotTest::snapshot_records_correct_severity_counts&#13;
ErrorException: Attempt to read property "low_severity_count" on null
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bootstrap\HandleExceptions.php:258
C:\PreIPO\backend\tests\Feature\DailyDisputeSnapshotTest.php:198</error>
        </testcase>
        <testcase name="aggregate_command_creates_platform_snapshot" file="C:\PreIPO\backend\tests\Feature\DailyDisputeSnapshotTest.php" line="80" class="Tests\Feature\DailyDisputeSnapshotTest" classname="Tests.Feature.DailyDisputeSnapshotTest" assertions="1" time="1.045451">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\DailyDisputeSnapshotTest::aggregate_command_creates_platform_snapshot&#13;
Failed asserting that null is not null.
&#13;
C:\PreIPO\backend\tests\Feature\DailyDisputeSnapshotTest.php:98</failure>
        </testcase>
        <testcase name="snapshot_date_range_scope_works" file="C:\PreIPO\backend\tests\Feature\DailyDisputeSnapshotTest.php" line="303" class="Tests\Feature\DailyDisputeSnapshotTest" classname="Tests.Feature.DailyDisputeSnapshotTest" assertions="1" time="1.019991"/>
        <testcase name="snapshot_records_blocked_user_count" file="C:\PreIPO\backend\tests\Feature\DailyDisputeSnapshotTest.php" line="265" class="Tests\Feature\DailyDisputeSnapshotTest" classname="Tests.Feature.DailyDisputeSnapshotTest" assertions="0" time="0.283936">
          <error type="ErrorException">Tests\Feature\DailyDisputeSnapshotTest::snapshot_records_blocked_user_count&#13;
ErrorException: Attempt to read property "blocked_users_count" on null
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bootstrap\HandleExceptions.php:258
C:\PreIPO\backend\tests\Feature\DailyDisputeSnapshotTest.php:281</error>
        </testcase>
        <testcase name="snapshot_records_chargeback_metrics" file="C:\PreIPO\backend\tests\Feature\DailyDisputeSnapshotTest.php" line="230" class="Tests\Feature\DailyDisputeSnapshotTest" classname="Tests.Feature.DailyDisputeSnapshotTest" assertions="0" time="0.994045">
          <error type="ErrorException">Tests\Feature\DailyDisputeSnapshotTest::snapshot_records_chargeback_metrics&#13;
ErrorException: Attempt to read property "confirmed_chargeback_count" on null
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bootstrap\HandleExceptions.php:258
C:\PreIPO\backend\tests\Feature\DailyDisputeSnapshotTest.php:260</error>
        </testcase>
        <testcase name="snapshot_allows_same_date_different_plans" file="C:\PreIPO\backend\tests\Feature\DailyDisputeSnapshotTest.php" line="49" class="Tests\Feature\DailyDisputeSnapshotTest" classname="Tests.Feature.DailyDisputeSnapshotTest" assertions="1" time="0.876705"/>
        <testcase name="snapshot_enforces_unique_date_plan_constraint" file="C:\PreIPO\backend\tests\Feature\DailyDisputeSnapshotTest.php" line="27" class="Tests\Feature\DailyDisputeSnapshotTest" classname="Tests.Feature.DailyDisputeSnapshotTest" assertions="1" time="0.877897">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\DailyDisputeSnapshotTest::snapshot_enforces_unique_date_plan_constraint&#13;
Failed asserting that exception of type "Illuminate\Database\QueryException" is thrown.</failure>
        </testcase>
        <testcase name="aggregate_command_creates_per_plan_snapshots" file="C:\PreIPO\backend\tests\Feature\DailyDisputeSnapshotTest.php" line="103" class="Tests\Feature\DailyDisputeSnapshotTest" classname="Tests.Feature.DailyDisputeSnapshotTest" assertions="1" time="0.912677">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\DailyDisputeSnapshotTest::aggregate_command_creates_per_plan_snapshots&#13;
Failed asserting that null is not null.
&#13;
C:\PreIPO\backend\tests\Feature\DailyDisputeSnapshotTest.php:118</failure>
        </testcase>
        <testcase name="aggregate_command_overwrites_with_force" file="C:\PreIPO\backend\tests\Feature\DailyDisputeSnapshotTest.php" line="147" class="Tests\Feature\DailyDisputeSnapshotTest" classname="Tests.Feature.DailyDisputeSnapshotTest" assertions="1" time="0.945037">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\DailyDisputeSnapshotTest::aggregate_command_overwrites_with_force&#13;
Failed asserting that 999 matches expected 1.
&#13;
C:\PreIPO\backend\tests\Feature\DailyDisputeSnapshotTest.php:172</failure>
        </testcase>
        <testcase name="snapshot_model_calculates_rupee_amounts" file="C:\PreIPO\backend\tests\Feature\DailyDisputeSnapshotTest.php" line="287" class="Tests\Feature\DailyDisputeSnapshotTest" classname="Tests.Feature.DailyDisputeSnapshotTest" assertions="2" time="0.982639"/>
        <testcase name="aggregate_command_skips_existing_without_force" file="C:\PreIPO\backend\tests\Feature\DailyDisputeSnapshotTest.php" line="122" class="Tests\Feature\DailyDisputeSnapshotTest" classname="Tests.Feature.DailyDisputeSnapshotTest" assertions="1" time="0.952465"/>
      </testsuite>
      <testsuite name="Tests\Feature\ExampleTest" file="C:\PreIPO\backend\tests\Feature\ExampleTest.php" tests="1" assertions="1" errors="0" failures="0" skipped="0" time="0.098457">
        <testcase name="test_the_application_returns_a_successful_response" file="C:\PreIPO\backend\tests\Feature\ExampleTest.php" line="13" class="Tests\Feature\ExampleTest" classname="Tests.Feature.ExampleTest" assertions="1" time="0.098457"/>
      </testsuite>
      <testsuite name="Tests\Feature\OtpTest" file="C:\PreIPO\backend\tests\Feature\OtpTest.php" tests="3" assertions="4" errors="0" failures="3" skipped="0" time="2.762949">
        <testcase name="it_rejects_incorrect_otp" file="C:\PreIPO\backend\tests\Feature\OtpTest.php" line="46" class="Tests\Feature\OtpTest" classname="Tests.Feature.OtpTest" assertions="1" time="0.873586">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\OtpTest::it_rejects_incorrect_otp&#13;
Expected response status code [400] but received 200.
Failed asserting that 200 is identical to 400.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\OtpTest.php:63</failure>
        </testcase>
        <testcase name="it_rejects_expired_otp" file="C:\PreIPO\backend\tests\Feature\OtpTest.php" line="68" class="Tests\Feature\OtpTest" classname="Tests.Feature.OtpTest" assertions="1" time="0.969820">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\OtpTest::it_rejects_expired_otp&#13;
Expected response status code [400] but received 200.
Failed asserting that 200 is identical to 400.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\OtpTest.php:85</failure>
        </testcase>
        <testcase name="it_verifies_correct_otp_successfully" file="C:\PreIPO\backend\tests\Feature\OtpTest.php" line="21" class="Tests\Feature\OtpTest" classname="Tests.Feature.OtpTest" assertions="2" time="0.919543">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\OtpTest::it_verifies_correct_otp_successfully&#13;
Unable to find JSON: &#13;
&#13;
[{
    "message": "Email verified successfully."
}]&#13;
&#13;
within response JSON:&#13;
&#13;
[{
    "message": "OTP Verified successfully."
}].&#13;
&#13;

Failed asserting that an array has the subset Array &amp;0 [
    'message' =&gt; 'Email verified successfully.',
].
--- Expected
+++ Actual
@@ @@
 array (
-  'message' =&gt; 'Email verified successfully.',
+  'message' =&gt; 'OTP Verified successfully.',
 )
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\Constraints\ArraySubset.php:81
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\Assert.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\AssertableJsonString.php:318
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:767
C:\PreIPO\backend\tests\Feature\OtpTest.php:40</failure>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\KycSubmitRequestTest" file="C:\PreIPO\backend\tests\Feature\KycSubmitRequestTest.php" tests="5" assertions="12" errors="1" failures="3" skipped="0" time="0.352582">
        <testcase name="test_validates_ifsc_code_format" file="C:\PreIPO\backend\tests\Feature\KycSubmitRequestTest.php" line="71" class="Tests\Feature\KycSubmitRequestTest" classname="Tests.Feature.KycSubmitRequestTest" assertions="3" time="0.071619">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\KycSubmitRequestTest::test_validates_ifsc_code_format&#13;
Failed asserting that false is true.
&#13;
C:\PreIPO\backend\tests\Feature\KycSubmitRequestTest.php:79</failure>
        </testcase>
        <testcase name="test_validates_aadhaar_format" file="C:\PreIPO\backend\tests\Feature\KycSubmitRequestTest.php" line="50" class="Tests\Feature\KycSubmitRequestTest" classname="Tests.Feature.KycSubmitRequestTest" assertions="3" time="0.076110">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\KycSubmitRequestTest::test_validates_aadhaar_format&#13;
Failed asserting that false is true.
&#13;
C:\PreIPO\backend\tests\Feature\KycSubmitRequestTest.php:58</failure>
        </testcase>
        <testcase name="test_validates_bank_account_format" file="C:\PreIPO\backend\tests\Feature\KycSubmitRequestTest.php" line="63" class="Tests\Feature\KycSubmitRequestTest" classname="Tests.Feature.KycSubmitRequestTest" assertions="2" time="0.062387"/>
        <testcase name="test_validates_pan_format" file="C:\PreIPO\backend\tests\Feature\KycSubmitRequestTest.php" line="38" class="Tests\Feature\KycSubmitRequestTest" classname="Tests.Feature.KycSubmitRequestTest" assertions="4" time="0.079746">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\KycSubmitRequestTest::test_validates_pan_format&#13;
Failed asserting that false is true.
&#13;
C:\PreIPO\backend\tests\Feature\KycSubmitRequestTest.php:47</failure>
        </testcase>
        <testcase name="test_validates_document_uploads" file="C:\PreIPO\backend\tests\Feature\KycSubmitRequestTest.php" line="83" class="Tests\Feature\KycSubmitRequestTest" classname="Tests.Feature.KycSubmitRequestTest" assertions="0" time="0.062722">
          <error type="Error">Tests\Feature\KycSubmitRequestTest::test_validates_document_uploads&#13;
Error: Call to undefined method Illuminate\Http\Testing\FileFactory::pdf()
&#13;
C:\PreIPO\backend\tests\Feature\KycSubmitRequestTest.php:93</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\BlockedUserInvestmentTest" file="C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php" tests="8" assertions="1" errors="7" failures="1" skipped="0" time="7.629758">
        <testcase name="admin_can_view_blocked_users_list" file="C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php" line="180" class="Tests\Feature\BlockedUserInvestmentTest" classname="Tests.Feature.BlockedUserInvestmentTest" assertions="1" time="0.621488">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\BlockedUserInvestmentTest::admin_can_view_blocked_users_list&#13;
Expected response status code [200] but received 500.
Failed asserting that 500 is identical to 200.&#13;
&#13;
The following exception occurred during the last request:

Spatie\Permission\Exceptions\PermissionDoesNotExist: There is no permission named `compliance.view_legal` for guard `web`. in C:\PreIPO\backend\vendor\spatie\laravel-permission\src\Exceptions\PermissionDoesNotExist.php:11
Stack trace:
#0 C:\PreIPO\backend\vendor\spatie\laravel-permission\src\Models\Permission.php(96): Spatie\Permission\Exceptions\PermissionDoesNotExist::create('compliance.view...', 'web')
#1 C:\PreIPO\backend\vendor\spatie\laravel-permission\src\Traits\HasPermissions.php(188): Spatie\Permission\Models\Permission::findByName('compliance.view...', 'web')
#2 C:\PreIPO\backend\vendor\spatie\laravel-permission\src\Traits\HasPermissions.php(215): App\Models\User-&gt;filterPermission('compliance.view...', NULL)
#3 C:\PreIPO\backend\app\Http\Middleware\CheckPermission.php(21): App\Models\User-&gt;hasPermissionTo('compliance.view...')
#4 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckPermission-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'compliance.view...')
#5 C:\PreIPO\backend\vendor\spatie\laravel-permission\src\Middleware\RoleMiddleware.php(37): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#6 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Spatie\Permission\Middleware\RoleMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'admin|super-adm...')
#7 C:\PreIPO\backend\app\Http\Middleware\AdminIpRestriction.php(43): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#8 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\AdminIpRestriction-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#9 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#10 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#11 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Auth\Middleware\Authenticate.php(64): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#12 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'sanctum')
#13 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#14 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(807): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#15 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(786): Illuminate\Routing\Router-&gt;runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#16 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(750): Illuminate\Routing\Router-&gt;runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#17 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(739): Illuminate\Routing\Router-&gt;dispatchToRoute(Object(Illuminate\Http\Request))
#18 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(201): Illuminate\Routing\Router-&gt;dispatch(Object(Illuminate\Http\Request))
#19 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Foundation\Http\Kernel-&gt;Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#20 C:\PreIPO\backend\app\Http\Middleware\RedirectMiddleware.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#21 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\RedirectMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#22 C:\PreIPO\backend\app\Http\Middleware\CheckMaintenanceMode.php(48): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#23 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckMaintenanceMode-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#24 C:\PreIPO\backend\app\Http\Middleware\SanitizeInput.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#25 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\SanitizeInput-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#26 C:\PreIPO\backend\app\Http\Middleware\ForceHttps.php(23): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#27 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\ForceHttps-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#28 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#29 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#30 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#31 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#32 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#33 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#34 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#35 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#36 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#37 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#38 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#39 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#40 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\HandleCors.php(62): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#41 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\HandleCors-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#42 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#43 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#44 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#45 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#46 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#47 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(176): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#48 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(145): Illuminate\Foundation\Http\Kernel-&gt;sendRequestThroughRouter(Object(Illuminate\Http\Request))
#49 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel-&gt;handle(Object(Illuminate\Http\Request))
#50 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase-&gt;call('GET', '/api/v1/admin/d...', Array, Array, Array, Array, '[]')
#51 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(381): Illuminate\Foundation\Testing\TestCase-&gt;json('GET', '/api/v1/admin/d...', Array, Array, 0)
#52 C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php(190): Illuminate\Foundation\Testing\TestCase-&gt;getJson('/api/v1/admin/d...')
#53 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(1667): Tests\Feature\BlockedUserInvestmentTest-&gt;admin_can_view_blocked_users_list()
#54 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(519): PHPUnit\Framework\TestCase-&gt;runTest()
#55 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestRunner\TestRunner.php(87): PHPUnit\Framework\TestCase-&gt;runBare()
#56 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(365): PHPUnit\Framework\TestRunner-&gt;run(Object(Tests\Feature\BlockedUserInvestmentTest))
#57 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestCase-&gt;run()
#58 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#59 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#60 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\TestRunner.php(64): PHPUnit\Framework\TestSuite-&gt;run()
#61 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\Application.php(211): PHPUnit\TextUI\TestRunner-&gt;run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#62 C:\PreIPO\backend\vendor\phpunit\phpunit\phpunit(104): PHPUnit\TextUI\Application-&gt;run(Array)
#63 {main}

----------------------------------------------------------------------------------

There is no permission named `compliance.view_legal` for guard `web`.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php:192</failure>
        </testcase>
        <testcase name="guard_detects_recently_blocked_user" file="C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php" line="122" class="Tests\Feature\BlockedUserInvestmentTest" classname="Tests.Feature.BlockedUserInvestmentTest" assertions="0" time="0.983571">
          <error type="RuntimeException">Tests\Feature\BlockedUserInvestmentTest::guard_detects_recently_blocked_user&#13;
RuntimeException: Cannot activate product 'SmartSolutions quasi': No available inventory. Please add bulk purchase inventory before activating this product.
&#13;
C:\PreIPO\backend\app\Models\Product.php:203
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php:265
C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php:126</error>
        </testcase>
        <testcase name="non_blocked_user_can_receive_allocation" file="C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php" line="80" class="Tests\Feature\BlockedUserInvestmentTest" classname="Tests.Feature.BlockedUserInvestmentTest" assertions="0" time="0.855835">
          <error type="RuntimeException">Tests\Feature\BlockedUserInvestmentTest::non_blocked_user_can_receive_allocation&#13;
RuntimeException: Cannot activate product 'SmartSolutions quia': No available inventory. Please add bulk purchase inventory before activating this product.
&#13;
C:\PreIPO\backend\app\Models\Product.php:203
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php:265
C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php:83</error>
        </testcase>
        <testcase name="unblocked_user_can_receive_allocation_again" file="C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php" line="203" class="Tests\Feature\BlockedUserInvestmentTest" classname="Tests.Feature.BlockedUserInvestmentTest" assertions="0" time="1.006997">
          <error type="RuntimeException">Tests\Feature\BlockedUserInvestmentTest::unblocked_user_can_receive_allocation_again&#13;
RuntimeException: Cannot activate product 'TechStart commodi': No available inventory. Please add bulk purchase inventory before activating this product.
&#13;
C:\PreIPO\backend\app\Models\Product.php:203
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php:265
C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php:206</error>
        </testcase>
        <testcase name="no_partial_allocation_on_blocked_user" file="C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php" line="151" class="Tests\Feature\BlockedUserInvestmentTest" classname="Tests.Feature.BlockedUserInvestmentTest" assertions="0" time="1.043353">
          <error type="RuntimeException">Tests\Feature\BlockedUserInvestmentTest::no_partial_allocation_on_blocked_user&#13;
RuntimeException: Cannot activate product 'TechStart omnis': No available inventory. Please add bulk purchase inventory before activating this product.
&#13;
C:\PreIPO\backend\app\Models\Product.php:203
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php:265
C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php:154</error>
        </testcase>
        <testcase name="blocked_user_cannot_receive_share_allocation" file="C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php" line="36" class="Tests\Feature\BlockedUserInvestmentTest" classname="Tests.Feature.BlockedUserInvestmentTest" assertions="0" time="1.003811">
          <error type="RuntimeException">Tests\Feature\BlockedUserInvestmentTest::blocked_user_cannot_receive_share_allocation&#13;
RuntimeException: Cannot activate product 'CloudNine excepturi': No available inventory. Please add bulk purchase inventory before activating this product.
&#13;
C:\PreIPO\backend\app\Models\Product.php:203
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php:265
C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php:39</error>
        </testcase>
        <testcase name="blocked_user_allocation_does_not_mutate_inventory" file="C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php" line="54" class="Tests\Feature\BlockedUserInvestmentTest" classname="Tests.Feature.BlockedUserInvestmentTest" assertions="0" time="1.018382">
          <error type="RuntimeException">Tests\Feature\BlockedUserInvestmentTest::blocked_user_allocation_does_not_mutate_inventory&#13;
RuntimeException: Cannot activate product 'SmartSolutions ea': No available inventory. Please add bulk purchase inventory before activating this product.
&#13;
C:\PreIPO\backend\app\Models\Product.php:203
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php:265
C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php:57</error>
        </testcase>
        <testcase name="blocked_user_cannot_receive_legacy_allocation" file="C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php" line="106" class="Tests\Feature\BlockedUserInvestmentTest" classname="Tests.Feature.BlockedUserInvestmentTest" assertions="0" time="1.096321">
          <error type="RuntimeException">Tests\Feature\BlockedUserInvestmentTest::blocked_user_cannot_receive_legacy_allocation&#13;
RuntimeException: Cannot activate product 'HealthFirst sit': No available inventory. Please add bulk purchase inventory before activating this product.
&#13;
C:\PreIPO\backend\app\Models\Product.php:203
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php:265
C:\PreIPO\backend\tests\Feature\BlockedUserInvestmentTest.php:112</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\LuckyDrawTest" file="C:\PreIPO\backend\tests\Feature\LuckyDrawTest.php" tests="1" assertions="0" errors="1" failures="0" skipped="0" time="0.993659">
        <testcase name="admin_can_execute_draw" file="C:\PreIPO\backend\tests\Feature\LuckyDrawTest.php" line="36" class="Tests\Feature\LuckyDrawTest" classname="Tests.Feature.LuckyDrawTest" assertions="0" time="0.993659">
          <error type="Illuminate\Database\QueryException">Tests\Feature\LuckyDrawTest::admin_can_execute_draw&#13;
Illuminate\Database\QueryException: SQLSTATE[23000]: Integrity constraint violation: 1452 Cannot add or update a child row: a foreign key constraint fails (`preipo_test`.`lucky_draw_entries`, CONSTRAINT `lucky_draw_entries_payment_id_foreign` FOREIGN KEY (`payment_id`) REFERENCES `payments` (`id`) ON DELETE CASCADE) (Connection: mysql, SQL: insert into `lucky_draw_entries` (`user_id`, `lucky_draw_id`, `payment_id`, `updated_at`, `created_at`) values (15893, 184, 1, 2026-02-22 10:34:01, 2026-02-22 10:34:01))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Feature\LuckyDrawTest.php:42</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\AdminDashboardEndpointsTest" file="C:\PreIPO\backend\tests\Feature\AdminDashboardEndpointsTest.php" tests="10" assertions="15" errors="1" failures="5" skipped="0" time="1.347279">
        <testcase name="testDashboardShowsPendingWithdrawals" file="C:\PreIPO\backend\tests\Feature\AdminDashboardEndpointsTest.php" line="83" class="Tests\Feature\AdminDashboardEndpointsTest" classname="Tests.Feature.AdminDashboardEndpointsTest" assertions="1" time="0.162589"/>
        <testcase name="testDashboardShowsRecentActivity" file="C:\PreIPO\backend\tests\Feature\AdminDashboardEndpointsTest.php" line="114" class="Tests\Feature\AdminDashboardEndpointsTest" classname="Tests.Feature.AdminDashboardEndpointsTest" assertions="0" time="0.101552">
          <error type="Illuminate\Database\QueryException">Tests\Feature\AdminDashboardEndpointsTest::testDashboardShowsRecentActivity&#13;
Illuminate\Database\QueryException: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'properties' in 'field list' (Connection: mysql, SQL: insert into `activity_logs` (`user_id`, `action`, `description`, `ip_address`, `user_agent`, `properties`, `created_at`) values (15906, investment, User logged in, 11.45.16.153, Mozilla/5.0 (X11; Linux i686; rv:7.0) Gecko/20140805 Firefox/36.0, {"timestamp":"2026-02-22T10:34:01.483908Z","additional_info":"Quisquam praesentium quis sit dolore quod."}, 2026-02-22 10:34:01))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
C:\PreIPO\backend\tests\Feature\AdminDashboardEndpointsTest.php:116</error>
        </testcase>
        <testcase name="testGetDashboardStatsReturnsCorrectMetrics" file="C:\PreIPO\backend\tests\Feature\AdminDashboardEndpointsTest.php" line="94" class="Tests\Feature\AdminDashboardEndpointsTest" classname="Tests.Feature.AdminDashboardEndpointsTest" assertions="2" time="0.110908">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AdminDashboardEndpointsTest::testGetDashboardStatsReturnsCorrectMetrics&#13;
Unable to find JSON: &#13;
&#13;
[{
    "kpis": {
        "total_revenue": 1000,
        "total_users": 1,
        "pending_kyc": 1,
        "pending_withdrawals": 0
    }
}]&#13;
&#13;
within response JSON:&#13;
&#13;
[{
    "kpis": {
        "total_revenue": 0,
        "total_users": 1,
        "pending_kyc": 0,
        "pending_withdrawals": 1,
        "active_subscriptions": 0,
        "monthly_revenue": 0,
        "new_users_30d": 1,
        "pending_payments": 0,
        "payment_success_rate": 0,
        "arpu": 0,
        "churn_rate": 0,
        "total_aum": 0,
        "avg_investment": 0,
        "total_pending_approvals": 1
    },
    "charts": {
        "revenue_over_time": [],
        "user_growth": [
            {
                "date": "2026-02-22",
                "count": 1
            }
        ]
    },
    "recent_activity": [
        {
            "id": 29,
            "type": "withdrawal",
            "user": {
                "id": 15900,
                "username": "ljacobi",
                "email": "ylockman@example.com",
                "role": "user",
                "is_admin": false,
                "roles": []
            },
            "description": "ljacobi requested withdrawal of 20067.52 - Pending",
            "amount": 20067.52,
            "created_at": "2026-02-22T10:34:01.000000Z"
        },
        {
            "id": 30,
            "type": "withdrawal",
            "user": {
                "id": 15902,
                "username": "slittle",
                "email": "simonis.lilla@example.org",
                "role": "user",
                "is_admin": false,
                "roles": []
            },
            "description": "slittle requested withdrawal of 2458.9 - Completed",
            "amount": 2458.9,
            "created_at": "2026-02-22T10:34:01.000000Z"
        },
        {
            "id": 15744,
            "type": "kyc",
            "user": {
                "id": 15898,
                "username": "theodora06",
                "email": "monahan.ottilie@example.net",
                "role": "user",
                "is_admin": false,
                "roles": []
            },
            "description": "theodora06 KYC verified",
            "amount": null,
            "created_at": "2026-02-22T10:34:01.000000Z"
        },
        {
            "id": 15745,
            "type": "kyc",
            "user": {
                "id": 15899,
                "username": "lizzie.gleason",
                "email": "rohan.emmanuelle@example.com",
                "role": "user",
                "is_admin": false,
                "roles": []
            },
            "description": "lizzie.gleason KYC verified",
            "amount": null,
            "created_at": "2026-02-22T10:34:01.000000Z"
        },
        {
            "id": 15746,
            "type": "kyc",
            "user": {
                "id": 15900,
                "username": "ljacobi",
                "email": "ylockman@example.com",
                "role": "user",
                "is_admin": false,
                "roles": []
            },
            "description": "ljacobi KYC verified",
            "amount": null,
            "created_at": "2026-02-22T10:34:01.000000Z"
        },
        {
            "id": 15747,
            "type": "kyc",
            "user": {
                "id": 15901,
                "username": "sheathcote",
                "email": "albertha.schinner@example.com",
                "role": "user",
                "is_admin": false,
                "roles": []
            },
            "description": "sheathcote KYC verified",
            "amount": null,
            "created_at": "2026-02-22T10:34:01.000000Z"
        },
        {
            "id": 15748,
            "type": "kyc",
            "user": {
                "id": 15902,
                "username": "slittle",
                "email": "simonis.lilla@example.org",
                "role": "user",
                "is_admin": false,
                "roles": []
            },
            "description": "slittle KYC verified",
            "amount": null,
            "created_at": "2026-02-22T10:34:01.000000Z"
        }
    ]
}].&#13;
&#13;

Failed asserting that an array has the subset Array &amp;0 [
    'kpis' =&gt; Array &amp;1 [
        'total_revenue' =&gt; 1000,
        'total_users' =&gt; 1,
        'pending_kyc' =&gt; 1,
        'pending_withdrawals' =&gt; 0,
    ],
].
--- Expected
+++ Actual
@@ @@
 array (
   'kpis' =&gt; 
   array (
-    'total_revenue' =&gt; 1000,
+    'total_revenue' =&gt; 0,
     'total_users' =&gt; 1,
-    'pending_kyc' =&gt; 1,
-    'pending_withdrawals' =&gt; 0,
+    'pending_kyc' =&gt; 0,
+    'pending_withdrawals' =&gt; 1,
     'active_subscriptions' =&gt; 0,
     'monthly_revenue' =&gt; 0,
     'new_users_30d' =&gt; 1,
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\Constraints\ArraySubset.php:81
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\Assert.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\AssertableJsonString.php:318
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:767
C:\PreIPO\backend\tests\Feature\AdminDashboardEndpointsTest.php:103</failure>
        </testcase>
        <testcase name="testDashboardHandlesConcurrentAccess" file="C:\PreIPO\backend\tests\Feature\AdminDashboardEndpointsTest.php" line="154" class="Tests\Feature\AdminDashboardEndpointsTest" classname="Tests.Feature.AdminDashboardEndpointsTest" assertions="3" time="0.106690"/>
        <testcase name="testDashboardRequiresAdminAuth" file="C:\PreIPO\backend\tests\Feature\AdminDashboardEndpointsTest.php" line="35" class="Tests\Feature\AdminDashboardEndpointsTest" classname="Tests.Feature.AdminDashboardEndpointsTest" assertions="3" time="0.111647"/>
        <testcase name="testDashboardShowsTotalUsers" file="C:\PreIPO\backend\tests\Feature\AdminDashboardEndpointsTest.php" line="48" class="Tests\Feature\AdminDashboardEndpointsTest" classname="Tests.Feature.AdminDashboardEndpointsTest" assertions="1" time="0.258034">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AdminDashboardEndpointsTest::testDashboardShowsTotalUsers&#13;
Failed asserting that 1 is identical to 11.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\AssertableJsonString.php:242
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:790
C:\PreIPO\backend\tests\Feature\AdminDashboardEndpointsTest.php:55</failure>
        </testcase>
        <testcase name="testDashboardShowsPendingKycs" file="C:\PreIPO\backend\tests\Feature\AdminDashboardEndpointsTest.php" line="71" class="Tests\Feature\AdminDashboardEndpointsTest" classname="Tests.Feature.AdminDashboardEndpointsTest" assertions="1" time="0.129419">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AdminDashboardEndpointsTest::testDashboardShowsPendingKycs&#13;
Failed asserting that 0 is identical to 2.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\AssertableJsonString.php:242
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:790
C:\PreIPO\backend\tests\Feature\AdminDashboardEndpointsTest.php:79</failure>
        </testcase>
        <testcase name="testDashboardShowsTotalRevenue" file="C:\PreIPO\backend\tests\Feature\AdminDashboardEndpointsTest.php" line="59" class="Tests\Feature\AdminDashboardEndpointsTest" classname="Tests.Feature.AdminDashboardEndpointsTest" assertions="1" time="0.157131">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AdminDashboardEndpointsTest::testDashboardShowsTotalRevenue&#13;
Failed asserting that 0 is identical to 8000.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\AssertableJsonString.php:242
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:790
C:\PreIPO\backend\tests\Feature\AdminDashboardEndpointsTest.php:67</failure>
        </testcase>
        <testcase name="testDashboardRespondsUnder500ms" file="C:\PreIPO\backend\tests\Feature\AdminDashboardEndpointsTest.php" line="141" class="Tests\Feature\AdminDashboardEndpointsTest" classname="Tests.Feature.AdminDashboardEndpointsTest" assertions="1" time="0.088964"/>
        <testcase name="testDashboardChartsLoadCorrectly" file="C:\PreIPO\backend\tests\Feature\AdminDashboardEndpointsTest.php" line="127" class="Tests\Feature\AdminDashboardEndpointsTest" classname="Tests.Feature.AdminDashboardEndpointsTest" assertions="2" time="0.120345">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AdminDashboardEndpointsTest::testDashboardChartsLoadCorrectly&#13;
Failed to assert that the response count matched the expected 1
Failed asserting that actual size 0 matches expected size 1.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\AssertableJsonString.php:73
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:940
C:\PreIPO\backend\tests\Feature\AdminDashboardEndpointsTest.php:135</failure>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\AdminWorkflowTest" file="C:\PreIPO\backend\tests\Feature\AdminWorkflowTest.php" tests="3" assertions="3" errors="1" failures="1" skipped="0" time="4.246911">
        <testcase name="admin_can_approve_kyc" file="C:\PreIPO\backend\tests\Feature\AdminWorkflowTest.php" line="31" class="Tests\Feature\AdminWorkflowTest" classname="Tests.Feature.AdminWorkflowTest" assertions="1" time="1.074259">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AdminWorkflowTest::admin_can_approve_kyc&#13;
Expected response status code [200] but received 500.
Failed asserting that 500 is identical to 200.&#13;
&#13;
The following exception occurred during the last request:

ErrorException: Attempt to read property "value" on string in C:\PreIPO\backend\app\Services\Kyc\KycStatusService.php:98
Stack trace:
#0 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bootstrap\HandleExceptions.php(258): Illuminate\Foundation\Bootstrap\HandleExceptions-&gt;handleError(2, 'Attempt to read...', 'C:\\PreIPO\\backe...', 98)
#1 C:\PreIPO\backend\app\Services\Kyc\KycStatusService.php(98): Illuminate\Foundation\Bootstrap\HandleExceptions-&gt;Illuminate\Foundation\Bootstrap\{closure}(2, 'Attempt to read...', 'C:\\PreIPO\\backe...', 98)
#2 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php(32): App\Services\Kyc\KycStatusService-&gt;App\Services\Kyc\{closure}(Object(Illuminate\Database\MySqlConnection))
#3 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php(495): Illuminate\Database\Connection-&gt;transaction(Object(Closure))
#4 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php(361): Illuminate\Database\DatabaseManager-&gt;__call('transaction', Array)
#5 C:\PreIPO\backend\app\Services\Kyc\KycStatusService.php(60): Illuminate\Support\Facades\Facade::__callStatic('transaction', Array)
#6 C:\PreIPO\backend\app\Http\Controllers\Api\Admin\KycQueueController.php(119): App\Services\Kyc\KycStatusService-&gt;transitionTo(Object(App\Models\UserKyc), Object(App\Enums\KycStatus), Array)
#7 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php(32): App\Http\Controllers\Api\Admin\KycQueueController-&gt;App\Http\Controllers\Api\Admin\{closure}(Object(Illuminate\Database\MySqlConnection))
#8 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php(495): Illuminate\Database\Connection-&gt;transaction(Object(Closure))
#9 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php(361): Illuminate\Database\DatabaseManager-&gt;__call('transaction', Array)
#10 C:\PreIPO\backend\app\Http\Controllers\Api\Admin\KycQueueController.php(115): Illuminate\Support\Facades\Facade::__callStatic('transaction', Array)
#11 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(47): App\Http\Controllers\Api\Admin\KycQueueController-&gt;approve(Object(Illuminate\Http\Request), '15804')
#12 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(266): Illuminate\Routing\ControllerDispatcher-&gt;dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\Admin\KycQueueController), 'approve')
#13 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(212): Illuminate\Routing\Route-&gt;runController()
#14 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(808): Illuminate\Routing\Route-&gt;run()
#15 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Routing\Router-&gt;Illuminate\Routing\{closure}(Object(Illuminate\Http\Request))
#16 C:\PreIPO\backend\app\Http\Middleware\CheckPermission.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#17 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckPermission-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'kyc.approve')
#18 C:\PreIPO\backend\vendor\spatie\laravel-permission\src\Middleware\RoleMiddleware.php(37): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#19 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Spatie\Permission\Middleware\RoleMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'admin|super-adm...')
#20 C:\PreIPO\backend\app\Http\Middleware\AdminIpRestriction.php(43): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#21 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\AdminIpRestriction-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#22 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#23 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#24 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(161): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#25 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(127): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequest(Object(Illuminate\Http\Request), Object(Closure), Array)
#26 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(89): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequestUsingNamedLimiter(Object(Illuminate\Http\Request), Object(Closure), 'admin-actions', Object(Closure))
#27 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'admin-actions')
#28 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Auth\Middleware\Authenticate.php(64): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#29 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'sanctum')
#30 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#31 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(807): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#32 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(786): Illuminate\Routing\Router-&gt;runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#33 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(750): Illuminate\Routing\Router-&gt;runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#34 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(739): Illuminate\Routing\Router-&gt;dispatchToRoute(Object(Illuminate\Http\Request))
#35 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(201): Illuminate\Routing\Router-&gt;dispatch(Object(Illuminate\Http\Request))
#36 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Foundation\Http\Kernel-&gt;Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#37 C:\PreIPO\backend\app\Http\Middleware\RedirectMiddleware.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#38 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\RedirectMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#39 C:\PreIPO\backend\app\Http\Middleware\CheckMaintenanceMode.php(48): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#40 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckMaintenanceMode-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#41 C:\PreIPO\backend\app\Http\Middleware\SanitizeInput.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\SanitizeInput-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#43 C:\PreIPO\backend\app\Http\Middleware\ForceHttps.php(23): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#44 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\ForceHttps-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#45 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#46 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#47 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#48 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#49 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#50 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#51 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#52 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#53 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#54 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#55 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#56 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#57 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\HandleCors.php(62): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#58 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\HandleCors-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#59 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#60 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#61 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#62 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#63 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#64 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(176): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#65 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(145): Illuminate\Foundation\Http\Kernel-&gt;sendRequestThroughRouter(Object(Illuminate\Http\Request))
#66 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel-&gt;handle(Object(Illuminate\Http\Request))
#67 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase-&gt;call('POST', '/api/v1/admin/k...', Array, Array, Array, Array, '[]')
#68 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase-&gt;json('POST', '/api/v1/admin/k...', Array, Array, 0)
#69 C:\PreIPO\backend\tests\Feature\AdminWorkflowTest.php(41): Illuminate\Foundation\Testing\TestCase-&gt;postJson('/api/v1/admin/k...')
#70 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(1667): Tests\Feature\AdminWorkflowTest-&gt;admin_can_approve_kyc()
#71 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(519): PHPUnit\Framework\TestCase-&gt;runTest()
#72 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestRunner\TestRunner.php(87): PHPUnit\Framework\TestCase-&gt;runBare()
#73 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(365): PHPUnit\Framework\TestRunner-&gt;run(Object(Tests\Feature\AdminWorkflowTest))
#74 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestCase-&gt;run()
#75 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#76 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#77 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\TestRunner.php(64): PHPUnit\Framework\TestSuite-&gt;run()
#78 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\Application.php(211): PHPUnit\TextUI\TestRunner-&gt;run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#79 C:\PreIPO\backend\vendor\phpunit\phpunit\phpunit(104): PHPUnit\TextUI\Application-&gt;run(Array)
#80 {main}

----------------------------------------------------------------------------------

Attempt to read property "value" on string
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\AdminWorkflowTest.php:43</failure>
        </testcase>
        <testcase name="admin_can_approve_and_complete_withdrawal" file="C:\PreIPO\backend\tests\Feature\AdminWorkflowTest.php" line="51" class="Tests\Feature\AdminWorkflowTest" classname="Tests.Feature.AdminWorkflowTest" assertions="0" time="1.458717">
          <error type="InvalidArgumentException">Tests\Feature\AdminWorkflowTest::admin_can_approve_and_complete_withdrawal&#13;
InvalidArgumentException: Withdrawal amount must be positive.
&#13;
C:\PreIPO\backend\app\Models\Withdrawal.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Feature\AdminWorkflowTest.php:56</error>
        </testcase>
        <testcase name="admin_can_suspend_user" file="C:\PreIPO\backend\tests\Feature\AdminWorkflowTest.php" line="81" class="Tests\Feature\AdminWorkflowTest" classname="Tests.Feature.AdminWorkflowTest" assertions="2" time="1.713936"/>
      </testsuite>
      <testsuite name="Tests\Feature\WebhookRetrySystemTest" file="C:\PreIPO\backend\tests\Feature\WebhookRetrySystemTest.php" tests="7" assertions="10" errors="0" failures="1" skipped="1" time="0.618795">
        <testcase name="webhook_is_marked_as_max_retries_reached_after_limit" file="C:\PreIPO\backend\tests\Feature\WebhookRetrySystemTest.php" line="40" class="Tests\Feature\WebhookRetrySystemTest" classname="Tests.Feature.WebhookRetrySystemTest" assertions="2" time="0.106451"/>
        <testcase name="webhook_can_be_marked_as_success" file="C:\PreIPO\backend\tests\Feature\WebhookRetrySystemTest.php" line="58" class="Tests\Feature\WebhookRetrySystemTest" classname="Tests.Feature.WebhookRetrySystemTest" assertions="3" time="0.139960"/>
        <testcase name="exponential_backoff_is_calculated_correctly" file="C:\PreIPO\backend\tests\Feature\WebhookRetrySystemTest.php" line="107" class="Tests\Feature\WebhookRetrySystemTest" classname="Tests.Feature.WebhookRetrySystemTest" assertions="1" time="0.063832"/>
        <testcase name="webhook_can_be_marked_as_failed_and_scheduled_for_retry" file="C:\PreIPO\backend\tests\Feature\WebhookRetrySystemTest.php" line="22" class="Tests\Feature\WebhookRetrySystemTest" classname="Tests.Feature.WebhookRetrySystemTest" assertions="1" time="0.066743">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\WebhookRetrySystemTest::webhook_can_be_marked_as_failed_and_scheduled_for_retry&#13;
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
-'pending'
+'max_retries_reached'
&#13;
C:\PreIPO\backend\tests\Feature\WebhookRetrySystemTest.php:34</failure>
        </testcase>
        <testcase name="retry_job_can_be_dispatched" file="C:\PreIPO\backend\tests\Feature\WebhookRetrySystemTest.php" line="130" class="Tests\Feature\WebhookRetrySystemTest" classname="Tests.Feature.WebhookRetrySystemTest" assertions="1" time="0.104372"/>
        <testcase name="pending_retries_scope_returns_due_webhooks" file="C:\PreIPO\backend\tests\Feature\WebhookRetrySystemTest.php" line="76" class="Tests\Feature\WebhookRetrySystemTest" classname="Tests.Feature.WebhookRetrySystemTest" assertions="2" time="0.066904"/>
        <testcase name="webhook_log_is_created_for_incoming_webhook" file="C:\PreIPO\backend\tests\Feature\WebhookRetrySystemTest.php" line="13" class="Tests\Feature\WebhookRetrySystemTest" classname="Tests.Feature.WebhookRetrySystemTest" assertions="0" time="0.070534">
          <skipped/>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\ProcessAutoDebitsTest" file="C:\PreIPO\backend\tests\Feature\ProcessAutoDebitsTest.php" tests="5" assertions="17" errors="0" failures="0" skipped="1" time="7.470669">
        <testcase name="test_identifies_subscriptions_due_for_payment" file="C:\PreIPO\backend\tests\Feature\ProcessAutoDebitsTest.php" line="34" class="Tests\Feature\ProcessAutoDebitsTest" classname="Tests.Feature.ProcessAutoDebitsTest" assertions="3" time="1.254541"/>
        <testcase name="test_retries_failed_payments" file="C:\PreIPO\backend\tests\Feature\ProcessAutoDebitsTest.php" line="86" class="Tests\Feature\ProcessAutoDebitsTest" classname="Tests.Feature.ProcessAutoDebitsTest" assertions="4" time="1.381343"/>
        <testcase name="test_sends_reminder_before_due_date" file="C:\PreIPO\backend\tests\Feature\ProcessAutoDebitsTest.php" line="113" class="Tests\Feature\ProcessAutoDebitsTest" classname="Tests.Feature.ProcessAutoDebitsTest" assertions="7" time="1.744763"/>
        <testcase name="test_initiates_payment_for_each_subscription" file="C:\PreIPO\backend\tests\Feature\ProcessAutoDebitsTest.php" line="68" class="Tests\Feature\ProcessAutoDebitsTest" classname="Tests.Feature.ProcessAutoDebitsTest" assertions="3" time="1.716597"/>
        <testcase name="test_suspends_subscription_after_max_failures" file="C:\PreIPO\backend\tests\Feature\ProcessAutoDebitsTest.php" line="130" class="Tests\Feature\ProcessAutoDebitsTest" classname="Tests.Feature.ProcessAutoDebitsTest" assertions="0" time="1.373425">
          <skipped/>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\CompleteUserJourneyTest" file="C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php" tests="12" assertions="12" errors="7" failures="2" skipped="0" time="22.647894">
        <testcase name="testSubscriptionCancellationFlow" file="C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php" line="172" class="Tests\Feature\CompleteUserJourneyTest" classname="Tests.Feature.CompleteUserJourneyTest" assertions="2" time="1.654472"/>
        <testcase name="testKycRejectionAndResubmissionFlow" file="C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php" line="325" class="Tests\Feature\CompleteUserJourneyTest" classname="Tests.Feature.CompleteUserJourneyTest" assertions="1" time="1.904099">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\CompleteUserJourneyTest::testKycRejectionAndResubmissionFlow&#13;
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
-'rejected'
+'submitted'
&#13;
C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php:338</failure>
        </testcase>
        <testcase name="testAutoDebitFailureAndRetryFlow" file="C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php" line="302" class="Tests\Feature\CompleteUserJourneyTest" classname="Tests.Feature.CompleteUserJourneyTest" assertions="0" time="1.606236">
          <error type="ErrorException">Tests\Feature\CompleteUserJourneyTest::testAutoDebitFailureAndRetryFlow&#13;
ErrorException: Undefined property: Tests\Feature\CompleteUserJourneyTest::$subscription
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bootstrap\HandleExceptions.php:258
C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php:307</error>
        </testcase>
        <testcase name="testRegistrationToFirstPaymentFlow" file="C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php" line="96" class="Tests\Feature\CompleteUserJourneyTest" classname="Tests.Feature.CompleteUserJourneyTest" assertions="2" time="2.012935">
          <error type="RuntimeException">Tests\Feature\CompleteUserJourneyTest::testRegistrationToFirstPaymentFlow&#13;
RuntimeException: Payment #4735 has NULL amount_paise. Float fallback is PROHIBITED. Data integrity violation.
&#13;
C:\PreIPO\backend\app\Models\Payment.php:495
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:804
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:741
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:670
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php:81
C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php:118</error>
        </testcase>
        <testcase name="testCelebrationBonusOnBirthdayFlow" file="C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php" line="353" class="Tests\Feature\CompleteUserJourneyTest" classname="Tests.Feature.CompleteUserJourneyTest" assertions="2" time="2.614024"/>
        <testcase name="testProfitShareDistributionFlow" file="C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php" line="261" class="Tests\Feature\CompleteUserJourneyTest" classname="Tests.Feature.CompleteUserJourneyTest" assertions="0" time="1.795768">
          <error type="Error">Tests\Feature\CompleteUserJourneyTest::testProfitShareDistributionFlow&#13;
Error: Class "Database\Factories\ProfitShareFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php:264</error>
        </testcase>
        <testcase name="testSubscriptionPauseAndResumeFlow" file="C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php" line="156" class="Tests\Feature\CompleteUserJourneyTest" classname="Tests.Feature.CompleteUserJourneyTest" assertions="4" time="0.964138"/>
        <testcase name="testKycSubmissionToApprovalFlow" file="C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php" line="128" class="Tests\Feature\CompleteUserJourneyTest" classname="Tests.Feature.CompleteUserJourneyTest" assertions="0" time="3.621367">
          <error type="Error">Tests\Feature\CompleteUserJourneyTest::testKycSubmissionToApprovalFlow&#13;
Error: Call to undefined method Illuminate\Http\Testing\FileFactory::pdf()
&#13;
C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php:140</error>
        </testcase>
        <testcase name="testReferralBonusCompleteFlow" file="C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php" line="209" class="Tests\Feature\CompleteUserJourneyTest" classname="Tests.Feature.CompleteUserJourneyTest" assertions="0" time="1.603877">
          <error type="ArgumentCountError">Tests\Feature\CompleteUserJourneyTest::testReferralBonusCompleteFlow&#13;
ArgumentCountError: Too few arguments to function App\Jobs\ProcessReferralJob::handle(), 2 passed in C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php on line 222 and exactly 5 expected
&#13;
C:\PreIPO\backend\app\Jobs\ProcessReferralJob.php:42
C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php:222</error>
        </testcase>
        <testcase name="testWithdrawalRequestToCompletionFlow" file="C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php" line="183" class="Tests\Feature\CompleteUserJourneyTest" classname="Tests.Feature.CompleteUserJourneyTest" assertions="1" time="1.759737">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\CompleteUserJourneyTest::testWithdrawalRequestToCompletionFlow&#13;
Failed asserting that 5000 matches expected 3000.
&#13;
C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php:193</failure>
        </testcase>
        <testcase name="testMilestoneBonusCompleteFlow" file="C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php" line="232" class="Tests\Feature\CompleteUserJourneyTest" classname="Tests.Feature.CompleteUserJourneyTest" assertions="0" time="1.463662">
          <error type="ErrorException">Tests\Feature\CompleteUserJourneyTest::testMilestoneBonusCompleteFlow&#13;
ErrorException: Undefined property: Tests\Feature\CompleteUserJourneyTest::$subscription
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bootstrap\HandleExceptions.php:258
C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php:236</error>
        </testcase>
        <testcase name="testLuckyDrawEntryToWinnerFlow" file="C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php" line="278" class="Tests\Feature\CompleteUserJourneyTest" classname="Tests.Feature.CompleteUserJourneyTest" assertions="0" time="1.647581">
          <error type="ErrorException">Tests\Feature\CompleteUserJourneyTest::testLuckyDrawEntryToWinnerFlow&#13;
ErrorException: Undefined property: Tests\Feature\CompleteUserJourneyTest::$subscription
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bootstrap\HandleExceptions.php:258
C:\PreIPO\backend\tests\Feature\CompleteUserJourneyTest.php:284</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\AutoDebitMultiCycleTest" file="C:\PreIPO\backend\tests\Feature\AutoDebitMultiCycleTest.php" tests="9" assertions="36" errors="0" failures="1" skipped="0" time="14.833415">
        <testcase name="retry_threshold_enforced_at_3_attempts" file="C:\PreIPO\backend\tests\Feature\AutoDebitMultiCycleTest.php" line="76" class="Tests\Feature\AutoDebitMultiCycleTest" classname="Tests.Feature.AutoDebitMultiCycleTest" assertions="4" time="1.503468"/>
        <testcase name="suspended_subscription_not_picked_for_auto_debit" file="C:\PreIPO\backend\tests\Feature\AutoDebitMultiCycleTest.php" line="428" class="Tests\Feature\AutoDebitMultiCycleTest" classname="Tests.Feature.AutoDebitMultiCycleTest" assertions="2" time="1.449793"/>
        <testcase name="reminders_sent_exactly_3_days_before" file="C:\PreIPO\backend\tests\Feature\AutoDebitMultiCycleTest.php" line="395" class="Tests\Feature\AutoDebitMultiCycleTest" classname="Tests.Feature.AutoDebitMultiCycleTest" assertions="1" time="1.476922"/>
        <testcase name="no_duplicate_payments_created_for_same_cycle" file="C:\PreIPO\backend\tests\Feature\AutoDebitMultiCycleTest.php" line="159" class="Tests\Feature\AutoDebitMultiCycleTest" classname="Tests.Feature.AutoDebitMultiCycleTest" assertions="1" time="2.036842"/>
        <testcase name="full_failure_to_suspension_flow" file="C:\PreIPO\backend\tests\Feature\AutoDebitMultiCycleTest.php" line="225" class="Tests\Feature\AutoDebitMultiCycleTest" classname="Tests.Feature.AutoDebitMultiCycleTest" assertions="2" time="1.952350">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AutoDebitMultiCycleTest::full_failure_to_suspension_flow&#13;
Still active after 2nd failure
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
-'active'
+'payment_failed'
&#13;
C:\PreIPO\backend\tests\Feature\AutoDebitMultiCycleTest.php:254</failure>
        </testcase>
        <testcase name="resume_after_suspension_allows_fresh_retry_cycle" file="C:\PreIPO\backend\tests\Feature\AutoDebitMultiCycleTest.php" line="276" class="Tests\Feature\AutoDebitMultiCycleTest" classname="Tests.Feature.AutoDebitMultiCycleTest" assertions="1" time="1.790077"/>
        <testcase name="no_ghost_retries_without_razorpay_linkage" file="C:\PreIPO\backend\tests\Feature\AutoDebitMultiCycleTest.php" line="124" class="Tests\Feature\AutoDebitMultiCycleTest" classname="Tests.Feature.AutoDebitMultiCycleTest" assertions="5" time="1.401346"/>
        <testcase name="twelve_month_billing_cycle_completes_without_drift" file="C:\PreIPO\backend\tests\Feature\AutoDebitMultiCycleTest.php" line="341" class="Tests\Feature\AutoDebitMultiCycleTest" classname="Tests.Feature.AutoDebitMultiCycleTest" assertions="14" time="1.802529"/>
        <testcase name="no_date_drift_over_multiple_billing_cycles" file="C:\PreIPO\backend\tests\Feature\AutoDebitMultiCycleTest.php" line="185" class="Tests\Feature\AutoDebitMultiCycleTest" classname="Tests.Feature.AutoDebitMultiCycleTest" assertions="6" time="1.420088"/>
      </testsuite>
      <testsuite name="Tests\Feature\PaymentToBonusIntegrationTest" file="C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php" tests="8" assertions="0" errors="8" failures="0" skipped="0" time="13.322767">
        <testcase name="testLatePaymentSkipsConsistencyBonus" file="C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php" line="183" class="Tests\Feature\PaymentToBonusIntegrationTest" classname="Tests.Feature.PaymentToBonusIntegrationTest" assertions="0" time="1.456481">
          <error type="RuntimeException">Tests\Feature\PaymentToBonusIntegrationTest::testLatePaymentSkipsConsistencyBonus&#13;
RuntimeException: Payment #4767 has NULL amount_paise. Float fallback is PROHIBITED. Data integrity violation.
&#13;
C:\PreIPO\backend\app\Models\Payment.php:495
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:804
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:741
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:670
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php:74
C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php:189</error>
        </testcase>
        <testcase name="testBonusesCorrectlyCreditedToWallet" file="C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php" line="99" class="Tests\Feature\PaymentToBonusIntegrationTest" classname="Tests.Feature.PaymentToBonusIntegrationTest" assertions="0" time="1.617200">
          <error type="RuntimeException">Tests\Feature\PaymentToBonusIntegrationTest::testBonusesCorrectlyCreditedToWallet&#13;
RuntimeException: Payment #4768 has NULL amount_paise. Float fallback is PROHIBITED. Data integrity violation.
&#13;
C:\PreIPO\backend\app\Models\Payment.php:495
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:804
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:741
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:670
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php:74
C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php:102</error>
        </testcase>
        <testcase name="testReferralMultiplierAppliedToAllBonuses" file="C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php" line="137" class="Tests\Feature\PaymentToBonusIntegrationTest" classname="Tests.Feature.PaymentToBonusIntegrationTest" assertions="0" time="1.724811">
          <error type="RuntimeException">Tests\Feature\PaymentToBonusIntegrationTest::testReferralMultiplierAppliedToAllBonuses&#13;
RuntimeException: Payment #4769 has NULL amount_paise. Float fallback is PROHIBITED. Data integrity violation.
&#13;
C:\PreIPO\backend\app\Models\Payment.php:495
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:804
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:741
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:670
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php:74
C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php:146</error>
        </testcase>
        <testcase name="testPaymentRefundReversesBonuses" file="C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php" line="159" class="Tests\Feature\PaymentToBonusIntegrationTest" classname="Tests.Feature.PaymentToBonusIntegrationTest" assertions="0" time="1.497100">
          <error type="RuntimeException">Tests\Feature\PaymentToBonusIntegrationTest::testPaymentRefundReversesBonuses&#13;
RuntimeException: Payment #4773 has NULL amount_paise. Float fallback is PROHIBITED. Data integrity violation.
&#13;
C:\PreIPO\backend\app\Models\Payment.php:495
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:804
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:741
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:670
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php:74
C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php:162</error>
        </testcase>
        <testcase name="testBonusRecordsCreatedWithCorrectMetadata" file="C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php" line="122" class="Tests\Feature\PaymentToBonusIntegrationTest" classname="Tests.Feature.PaymentToBonusIntegrationTest" assertions="0" time="1.585011">
          <error type="RuntimeException">Tests\Feature\PaymentToBonusIntegrationTest::testBonusRecordsCreatedWithCorrectMetadata&#13;
RuntimeException: Payment #4774 has NULL amount_paise. Float fallback is PROHIBITED. Data integrity violation.
&#13;
C:\PreIPO\backend\app\Models\Payment.php:495
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:804
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:741
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:670
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php:74
C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php:127</error>
        </testcase>
        <testcase name="testBonusNotificationsGenerated" file="C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php" line="115" class="Tests\Feature\PaymentToBonusIntegrationTest" classname="Tests.Feature.PaymentToBonusIntegrationTest" assertions="0" time="1.882962">
          <error type="RuntimeException">Tests\Feature\PaymentToBonusIntegrationTest::testBonusNotificationsGenerated&#13;
RuntimeException: Payment #4778 has NULL amount_paise. Float fallback is PROHIBITED. Data integrity violation.
&#13;
C:\PreIPO\backend\app\Models\Payment.php:495
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:804
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:741
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:670
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php:74
C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php:118</error>
        </testcase>
        <testcase name="testBonusCalculationHandlesEdgeCases" file="C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php" line="198" class="Tests\Feature\PaymentToBonusIntegrationTest" classname="Tests.Feature.PaymentToBonusIntegrationTest" assertions="0" time="1.708966">
          <error type="RuntimeException">Tests\Feature\PaymentToBonusIntegrationTest::testBonusCalculationHandlesEdgeCases&#13;
RuntimeException: Invalid payment state transition: 'pending'  'refunded'. Valid transitions from 'pending': [processing, paid, failed, cancelled]
&#13;
C:\PreIPO\backend\app\Models\Payment.php:182
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1222
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1156
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1014
C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php:204</error>
        </testcase>
        <testcase name="testPaymentSuccessTriggersAllBonusCalculations" file="C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php" line="88" class="Tests\Feature\PaymentToBonusIntegrationTest" classname="Tests.Feature.PaymentToBonusIntegrationTest" assertions="0" time="1.850236">
          <error type="RuntimeException">Tests\Feature\PaymentToBonusIntegrationTest::testPaymentSuccessTriggersAllBonusCalculations&#13;
RuntimeException: Payment #4780 has NULL amount_paise. Float fallback is PROHIBITED. Data integrity violation.
&#13;
C:\PreIPO\backend\app\Models\Payment.php:495
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:804
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:741
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:670
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php:74
C:\PreIPO\backend\tests\Feature\PaymentToBonusIntegrationTest.php:91</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\WebhookValidationTest" file="C:\PreIPO\backend\tests\Feature\WebhookValidationTest.php" tests="6" assertions="9" errors="0" failures="0" skipped="1" time="9.098740">
        <testcase name="testWebhookRetryHandling" file="C:\PreIPO\backend\tests\Feature\WebhookValidationTest.php" line="172" class="Tests\Feature\WebhookValidationTest" classname="Tests.Feature.WebhookValidationTest" assertions="0" time="2.028893">
          <skipped/>
        </testcase>
        <testcase name="testRazorpayWebhookSignatureValidation" file="C:\PreIPO\backend\tests\Feature\WebhookValidationTest.php" line="62" class="Tests\Feature\WebhookValidationTest" classname="Tests.Feature.WebhookValidationTest" assertions="1" time="0.956693"/>
        <testcase name="testMissingSignatureRejected" file="C:\PreIPO\backend\tests\Feature\WebhookValidationTest.php" line="98" class="Tests\Feature\WebhookValidationTest" classname="Tests.Feature.WebhookValidationTest" assertions="2" time="1.415605"/>
        <testcase name="testWebhookWithoutSecretConfigured" file="C:\PreIPO\backend\tests\Feature\WebhookValidationTest.php" line="112" class="Tests\Feature\WebhookValidationTest" classname="Tests.Feature.WebhookValidationTest" assertions="2" time="1.357782"/>
        <testcase name="testInvalidSignatureRejected" file="C:\PreIPO\backend\tests\Feature\WebhookValidationTest.php" line="80" class="Tests\Feature\WebhookValidationTest" classname="Tests.Feature.WebhookValidationTest" assertions="2" time="2.530463"/>
        <testcase name="testWebhookIdempotency" file="C:\PreIPO\backend\tests\Feature\WebhookValidationTest.php" line="133" class="Tests\Feature\WebhookValidationTest" classname="Tests.Feature.WebhookValidationTest" assertions="2" time="0.809305"/>
      </testsuite>
      <testsuite name="Tests\Feature\Services\CompanyDisclosureTierServiceTest" file="C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php" tests="14" assertions="18" errors="5" failures="7" skipped="0" time="1.557857">
        <testcase name="test_closure_public_queries_exclude_non_public_tiers" file="C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php" line="323" class="Tests\Feature\Services\CompanyDisclosureTierServiceTest" classname="Tests.Feature.Services.CompanyDisclosureTierServiceTest" assertions="7" time="0.249137">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\Services\CompanyDisclosureTierServiceTest::test_closure_public_queries_exclude_non_public_tiers&#13;
Failed asserting that false is true.
&#13;
C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php:368</failure>
        </testcase>
        <testcase name="test_closure_promotion_succeeds_through_service" file="C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php" line="290" class="Tests\Feature\Services\CompanyDisclosureTierServiceTest" classname="Tests.Feature.Services.CompanyDisclosureTierServiceTest" assertions="1" time="0.111329">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\Services\CompanyDisclosureTierServiceTest::test_closure_promotion_succeeds_through_service&#13;
Failed asserting that null matches expected 'tier_0_pending'.
&#13;
C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php:292</failure>
        </testcase>
        <testcase name="test_promote_to_next_tier_convenience_method" file="C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php" line="178" class="Tests\Feature\Services\CompanyDisclosureTierServiceTest" classname="Tests.Feature.Services.CompanyDisclosureTierServiceTest" assertions="1" time="0.089349">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\Services\CompanyDisclosureTierServiceTest::test_promote_to_next_tier_convenience_method&#13;
App\Enums\DisclosureTier Enum (TIER_1_UPCOMING, 'tier_1_upcoming') does not match expected type "string".
&#13;
C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php:186</failure>
        </testcase>
        <testcase name="test_promote_tier_2_to_tier_3_succeeds" file="C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php" line="102" class="Tests\Feature\Services\CompanyDisclosureTierServiceTest" classname="Tests.Feature.Services.CompanyDisclosureTierServiceTest" assertions="0" time="0.076310">
          <error type="TypeError">Tests\Feature\Services\CompanyDisclosureTierServiceTest::test_promote_tier_2_to_tier_3_succeeds&#13;
TypeError: App\Enums\DisclosureTier::tryFrom(): Argument #1 ($value) must be of type string|int, App\Enums\DisclosureTier given
&#13;
C:\PreIPO\backend\app\Services\CompanyDisclosureTierService.php:64
C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php:110</error>
        </testcase>
        <testcase name="test_get_current_tier_returns_correct_enum" file="C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php" line="213" class="Tests\Feature\Services\CompanyDisclosureTierServiceTest" classname="Tests.Feature.Services.CompanyDisclosureTierServiceTest" assertions="1" time="0.109233">
          <error type="TypeError">Tests\Feature\Services\CompanyDisclosureTierServiceTest::test_get_current_tier_returns_correct_enum&#13;
TypeError: App\Enums\DisclosureTier::tryFrom(): Argument #1 ($value) must be of type string|int, App\Enums\DisclosureTier given
&#13;
C:\PreIPO\backend\app\Services\CompanyDisclosureTierService.php:205
C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php:224</error>
        </testcase>
        <testcase name="test_promote_tier_0_to_tier_1_succeeds" file="C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php" line="57" class="Tests\Feature\Services\CompanyDisclosureTierServiceTest" classname="Tests.Feature.Services.CompanyDisclosureTierServiceTest" assertions="1" time="0.080647">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\Services\CompanyDisclosureTierServiceTest::test_promote_tier_0_to_tier_1_succeeds&#13;
App\Enums\DisclosureTier Enum (TIER_1_UPCOMING, 'tier_1_upcoming') does not match expected type "string".
&#13;
C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php:66</failure>
        </testcase>
        <testcase name="test_closure_direct_mutation_throws" file="C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php" line="311" class="Tests\Feature\Services\CompanyDisclosureTierServiceTest" classname="Tests.Feature.Services.CompanyDisclosureTierServiceTest" assertions="1" time="0.092695"/>
        <testcase name="test_promote_to_next_tier_fails_at_maximum" file="C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php" line="192" class="Tests\Feature\Services\CompanyDisclosureTierServiceTest" classname="Tests.Feature.Services.CompanyDisclosureTierServiceTest" assertions="1" time="0.114579">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\Services\CompanyDisclosureTierServiceTest::test_promote_to_next_tier_fails_at_maximum&#13;
Failed asserting that exception of type "TypeError" matches expected exception "RuntimeException". Message was: "App\Enums\DisclosureTier::tryFrom(): Argument #1 ($value) must be of type string|int, App\Enums\DisclosureTier given" at
C:\PreIPO\backend\app\Services\CompanyDisclosureTierService.php:178
C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php:203
.</failure>
        </testcase>
        <testcase name="test_promote_tier_1_to_tier_2_succeeds" file="C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php" line="74" class="Tests\Feature\Services\CompanyDisclosureTierServiceTest" classname="Tests.Feature.Services.CompanyDisclosureTierServiceTest" assertions="0" time="0.190648">
          <error type="Illuminate\Database\QueryException">Tests\Feature\Services\CompanyDisclosureTierServiceTest::test_promote_tier_1_to_tier_2_succeeds&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1364 Field 'disclosure_module_id' doesn't have a default value (Connection: mysql, SQL: insert into `company_disclosures` (`status`, `disclosure_data`, `company_id`, `updated_at`, `created_at`) values (approved, [], 3099, 2026-02-22 10:35:16, 2026-02-22 10:35:16))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Relations\HasOneOrMany.php:371
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Relations\HasOneOrMany.php:368
C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php:83</error>
        </testcase>
        <testcase name="test_tier_skip_is_rejected" file="C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php" line="124" class="Tests\Feature\Services\CompanyDisclosureTierServiceTest" classname="Tests.Feature.Services.CompanyDisclosureTierServiceTest" assertions="2" time="0.080981">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\Services\CompanyDisclosureTierServiceTest::test_tier_skip_is_rejected&#13;
Failed asserting that exception message 'Disclosure tier immutability violation on Company ID: 3100. Tier skipping is forbidden. Must promote one tier at a time. Current: 'tier_0_pending', Attempted: 'tier_2_live'.' contains 'tier skipping is forbidden'.</failure>
        </testcase>
        <testcase name="test_validation_requirements_for_tier_2" file="C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php" line="261" class="Tests\Feature\Services\CompanyDisclosureTierServiceTest" classname="Tests.Feature.Services.CompanyDisclosureTierServiceTest" assertions="0" time="0.109387">
          <error type="TypeError">Tests\Feature\Services\CompanyDisclosureTierServiceTest::test_validation_requirements_for_tier_2&#13;
TypeError: App\Enums\DisclosureTier::tryFrom(): Argument #1 ($value) must be of type string|int, App\Enums\DisclosureTier given
&#13;
C:\PreIPO\backend\app\Services\CompanyDisclosureTierService.php:205
C:\PreIPO\backend\app\Services\CompanyDisclosureTierService.php:342
C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php:275</error>
        </testcase>
        <testcase name="test_is_publicly_visible_returns_correct_values" file="C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php" line="231" class="Tests\Feature\Services\CompanyDisclosureTierServiceTest" classname="Tests.Feature.Services.CompanyDisclosureTierServiceTest" assertions="1" time="0.076201">
          <error type="TypeError">Tests\Feature\Services\CompanyDisclosureTierServiceTest::test_is_publicly_visible_returns_correct_values&#13;
TypeError: App\Enums\DisclosureTier::tryFrom(): Argument #1 ($value) must be of type string|int, App\Enums\DisclosureTier given
&#13;
C:\PreIPO\backend\app\Services\CompanyDisclosureTierService.php:205
C:\PreIPO\backend\app\Services\CompanyDisclosureTierService.php:223
C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php:241</error>
        </testcase>
        <testcase name="test_promotion_to_same_tier_is_rejected" file="C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php" line="163" class="Tests\Feature\Services\CompanyDisclosureTierServiceTest" classname="Tests.Feature.Services.CompanyDisclosureTierServiceTest" assertions="1" time="0.089453"/>
        <testcase name="test_downgrade_is_rejected" file="C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php" line="141" class="Tests\Feature\Services\CompanyDisclosureTierServiceTest" classname="Tests.Feature.Services.CompanyDisclosureTierServiceTest" assertions="1" time="0.087906">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\Services\CompanyDisclosureTierServiceTest::test_downgrade_is_rejected&#13;
Failed asserting that exception of type "TypeError" matches expected exception "App\Exceptions\DisclosureTierImmutabilityException". Message was: "App\Enums\DisclosureTier::tryFrom(): Argument #1 ($value) must be of type string|int, App\Enums\DisclosureTier given" at
C:\PreIPO\backend\app\Services\CompanyDisclosureTierService.php:64
C:\PreIPO\backend\tests\Feature\Services\CompanyDisclosureTierServiceTest.php:152
.</failure>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\UserWithdrawalEndpointTest" file="C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php" tests="9" assertions="7" errors="3" failures="6" skipped="0" time="2.312585">
        <testcase name="testUserCanViewWithdrawalHistory" file="C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php" line="90" class="Tests\Feature\UserWithdrawalEndpointTest" classname="Tests.Feature.UserWithdrawalEndpointTest" assertions="2" time="0.308000">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\UserWithdrawalEndpointTest::testUserCanViewWithdrawalHistory&#13;
Failed to assert that the response count matched the expected 1
Failed asserting that actual size 0 matches expected size 1.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\AssertableJsonString.php:73
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:940
C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php:97</failure>
        </testcase>
        <testcase name="testWithdrawalRespectsRateLimiting" file="C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php" line="119" class="Tests\Feature\UserWithdrawalEndpointTest" classname="Tests.Feature.UserWithdrawalEndpointTest" assertions="0" time="0.000000">
          <error type="Illuminate\Database\UniqueConstraintViolationException">Tests\Feature\UserWithdrawalEndpointTest::testWithdrawalRespectsRateLimiting&#13;
Illuminate\Database\UniqueConstraintViolationException: SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry 'finance-web' for key 'roles_name_guard_name_unique' (Connection: mysql, SQL: insert into `roles` (`guard_name`, `name`, `updated_at`, `created_at`) values (web, finance, 2026-02-22 10:35:16, 2026-02-22 10:35:16))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:820
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:634
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1863
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:634
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:621
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\database\seeders\RolesAndPermissionsSeeder.php:39
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Seeder.php:188
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Seeder.php:197
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Console\Seeds\SeedCommand.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\GuardsAttributes.php:155
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Console\Seeds\SeedCommand.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Command.php:213
C:\PreIPO\backend\vendor\symfony\console\Command\Command.php:341
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Command.php:182
C:\PreIPO\backend\vendor\symfony\console\Application.php:1079
C:\PreIPO\backend\vendor\symfony\console\Application.php:356
C:\PreIPO\backend\vendor\symfony\console\Application.php:195
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Application.php:166
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Console\Kernel.php:427
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\PendingCommand.php:332
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\PendingCommand.php:556
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithConsole.php:87
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithDatabase.php:332
C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php:22</error>
        </testcase>
        <testcase name="testUserCanCancelPendingWithdrawal" file="C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php" line="72" class="Tests\Feature\UserWithdrawalEndpointTest" classname="Tests.Feature.UserWithdrawalEndpointTest" assertions="0" time="0.000000">
          <error type="Illuminate\Database\QueryException">Tests\Feature\UserWithdrawalEndpointTest::testUserCanCancelPendingWithdrawal&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1412 Table definition has changed, please retry transaction (Connection: mysql, SQL: select * from `permissions` where (`name` = access admin panel and `guard_name` = web) limit 1)
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:398
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3106
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3091
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3676
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3090
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:811
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:793
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\BuildsQueries.php:343
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:617
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\database\seeders\RolesAndPermissionsSeeder.php:65
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Seeder.php:188
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Seeder.php:197
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Console\Seeds\SeedCommand.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\GuardsAttributes.php:155
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Console\Seeds\SeedCommand.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Command.php:213
C:\PreIPO\backend\vendor\symfony\console\Command\Command.php:341
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Command.php:182
C:\PreIPO\backend\vendor\symfony\console\Application.php:1079
C:\PreIPO\backend\vendor\symfony\console\Application.php:356
C:\PreIPO\backend\vendor\symfony\console\Application.php:195
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Application.php:166
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Console\Kernel.php:427
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\PendingCommand.php:332
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\PendingCommand.php:556
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithConsole.php:87
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithDatabase.php:332
C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php:22</error>
        </testcase>
        <testcase name="testWithdrawalNotificationSent" file="C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php" line="131" class="Tests\Feature\UserWithdrawalEndpointTest" classname="Tests.Feature.UserWithdrawalEndpointTest" assertions="1" time="0.213013">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\UserWithdrawalEndpointTest::testWithdrawalNotificationSent&#13;
The expected [App\Notifications\WithdrawalRequested] notification was not sent.
Failed asserting that false is true.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Testing\Fakes\NotificationFake.php:89
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php:137</failure>
        </testcase>
        <testcase name="testUserCannotWithdrawMoreThanBalance" file="C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php" line="53" class="Tests\Feature\UserWithdrawalEndpointTest" classname="Tests.Feature.UserWithdrawalEndpointTest" assertions="1" time="0.210437">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\UserWithdrawalEndpointTest::testUserCannotWithdrawMoreThanBalance&#13;
Expected response status code [422] but received 500.
Failed asserting that 500 is identical to 422.&#13;
&#13;
The following exception occurred during the last request:

PDOException: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' in C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:407
Stack trace:
#0 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(407): PDO-&gt;prepare('select sum(`amo...')
#1 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(812): Illuminate\Database\Connection-&gt;Illuminate\Database\{closure}('select sum(`amo...', Array)
#2 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(779): Illuminate\Database\Connection-&gt;runQueryCallback('select sum(`amo...', Array, Object(Closure))
#3 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(398): Illuminate\Database\Connection-&gt;run('select sum(`amo...', Array, Object(Closure))
#4 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3106): Illuminate\Database\Connection-&gt;select('select sum(`amo...', Array, true)
#5 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3091): Illuminate\Database\Query\Builder-&gt;runSelect()
#6 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3676): Illuminate\Database\Query\Builder-&gt;Illuminate\Database\Query\{closure}()
#7 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3090): Illuminate\Database\Query\Builder-&gt;onceWithColumns(Array, Object(Closure))
#8 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3603): Illuminate\Database\Query\Builder-&gt;get(Array)
#9 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3564): Illuminate\Database\Query\Builder-&gt;aggregate('sum', Array)
#10 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php(2120): Illuminate\Database\Query\Builder-&gt;sum('amount')
#11 C:\PreIPO\backend\app\Http\Requests\User\WithdrawalRequest.php(70): Illuminate\Database\Eloquent\Builder-&gt;__call('sum', Array)
#12 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(450): App\Http\Requests\User\WithdrawalRequest-&gt;App\Http\Requests\User\{closure}(Object(Illuminate\Validation\Validator))
#13 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(503): Illuminate\Validation\Validator-&gt;Illuminate\Validation\{closure}()
#14 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(516): Illuminate\Validation\Validator-&gt;passes()
#15 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\ValidatesWhenResolvedTrait.php(31): Illuminate\Validation\Validator-&gt;fails()
#16 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Providers\FormRequestServiceProvider.php(30): Illuminate\Foundation\Http\FormRequest-&gt;validateResolved()
#17 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1432): Illuminate\Foundation\Providers\FormRequestServiceProvider-&gt;Illuminate\Foundation\Providers\{closure}(Object(App\Http\Requests\User\WithdrawalRequest), Object(Illuminate\Foundation\Application))
#18 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1368): Illuminate\Container\Container-&gt;fireCallbackArray(Object(App\Http\Requests\User\WithdrawalRequest), Array)
#19 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1354): Illuminate\Container\Container-&gt;fireAfterResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#20 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(850): Illuminate\Container\Container-&gt;fireResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#21 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1078): Illuminate\Container\Container-&gt;resolve('App\\Http\\Reques...', Array, true)
#22 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(763): Illuminate\Foundation\Application-&gt;resolve('App\\Http\\Reques...', Array)
#23 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1058): Illuminate\Container\Container-&gt;make('App\\Http\\Reques...', Array)
#24 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(92): Illuminate\Foundation\Application-&gt;make('App\\Http\\Reques...')
#25 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(51): Illuminate\Routing\ControllerDispatcher-&gt;transformDependency(Object(ReflectionParameter), Array, Object(stdClass))
#26 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(30): Illuminate\Routing\ControllerDispatcher-&gt;resolveMethodDependencies(Array, Object(ReflectionMethod))
#27 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(60): Illuminate\Routing\ControllerDispatcher-&gt;resolveClassMethodDependencies(Array, Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#28 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(41): Illuminate\Routing\ControllerDispatcher-&gt;resolveParameters(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#29 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(266): Illuminate\Routing\ControllerDispatcher-&gt;dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#30 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(212): Illuminate\Routing\Route-&gt;runController()
#31 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(808): Illuminate\Routing\Route-&gt;run()
#32 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Routing\Router-&gt;Illuminate\Routing\{closure}(Object(Illuminate\Http\Request))
#33 C:\PreIPO\backend\app\Http\Middleware\EnsureMfaVerified.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#34 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\EnsureMfaVerified-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#35 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#36 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#37 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(161): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#38 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(127): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequest(Object(Illuminate\Http\Request), Object(Closure), Array)
#39 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(89): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequestUsingNamedLimiter(Object(Illuminate\Http\Request), Object(Closure), 'financial', Object(Closure))
#40 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'financial')
#41 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Auth\Middleware\Authenticate.php(64): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'sanctum')
#43 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#44 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(807): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#45 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(786): Illuminate\Routing\Router-&gt;runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#46 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(750): Illuminate\Routing\Router-&gt;runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#47 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(739): Illuminate\Routing\Router-&gt;dispatchToRoute(Object(Illuminate\Http\Request))
#48 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(201): Illuminate\Routing\Router-&gt;dispatch(Object(Illuminate\Http\Request))
#49 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Foundation\Http\Kernel-&gt;Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#50 C:\PreIPO\backend\app\Http\Middleware\RedirectMiddleware.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#51 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\RedirectMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#52 C:\PreIPO\backend\app\Http\Middleware\CheckMaintenanceMode.php(48): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#53 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckMaintenanceMode-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#54 C:\PreIPO\backend\app\Http\Middleware\SanitizeInput.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#55 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\SanitizeInput-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#56 C:\PreIPO\backend\app\Http\Middleware\ForceHttps.php(23): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#57 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\ForceHttps-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#58 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#59 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#60 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#61 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#62 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#63 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#64 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#65 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#66 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#67 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#68 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#69 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#70 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\HandleCors.php(62): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#71 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\HandleCors-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#72 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#73 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#74 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#75 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#76 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#77 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(176): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#78 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(145): Illuminate\Foundation\Http\Kernel-&gt;sendRequestThroughRouter(Object(Illuminate\Http\Request))
#79 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel-&gt;handle(Object(Illuminate\Http\Request))
#80 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase-&gt;call('POST', '/api/v1/user/wa...', Array, Array, Array, Array, '{"amount":11000...')
#81 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase-&gt;json('POST', '/api/v1/user/wa...', Array, Array, 0)
#82 C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php(55): Illuminate\Foundation\Testing\TestCase-&gt;postJson('/api/v1/user/wa...', Array)
#83 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(1667): Tests\Feature\UserWithdrawalEndpointTest-&gt;testUserCannotWithdrawMoreThanBalance()
#84 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(519): PHPUnit\Framework\TestCase-&gt;runTest()
#85 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestRunner\TestRunner.php(87): PHPUnit\Framework\TestCase-&gt;runBare()
#86 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(365): PHPUnit\Framework\TestRunner-&gt;run(Object(Tests\Feature\UserWithdrawalEndpointTest))
#87 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestCase-&gt;run()
#88 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#89 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#90 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\TestRunner.php(64): PHPUnit\Framework\TestSuite-&gt;run()
#91 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\Application.php(211): PHPUnit\TextUI\TestRunner-&gt;run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#92 C:\PreIPO\backend\vendor\phpunit\phpunit\phpunit(104): PHPUnit\TextUI\Application-&gt;run(Array)
#93 {main}

Next Illuminate\Database\QueryException: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' (Connection: mysql, SQL: select sum(`amount`) as aggregate from `withdrawals` where `user_id` = 16216 and `status` != rejected and date(`created_at`) = 2026-02-22) in C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
Stack trace:
#0 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(779): Illuminate\Database\Connection-&gt;runQueryCallback('select sum(`amo...', Array, Object(Closure))
#1 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(398): Illuminate\Database\Connection-&gt;run('select sum(`amo...', Array, Object(Closure))
#2 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3106): Illuminate\Database\Connection-&gt;select('select sum(`amo...', Array, true)
#3 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3091): Illuminate\Database\Query\Builder-&gt;runSelect()
#4 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3676): Illuminate\Database\Query\Builder-&gt;Illuminate\Database\Query\{closure}()
#5 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3090): Illuminate\Database\Query\Builder-&gt;onceWithColumns(Array, Object(Closure))
#6 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3603): Illuminate\Database\Query\Builder-&gt;get(Array)
#7 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3564): Illuminate\Database\Query\Builder-&gt;aggregate('sum', Array)
#8 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php(2120): Illuminate\Database\Query\Builder-&gt;sum('amount')
#9 C:\PreIPO\backend\app\Http\Requests\User\WithdrawalRequest.php(70): Illuminate\Database\Eloquent\Builder-&gt;__call('sum', Array)
#10 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(450): App\Http\Requests\User\WithdrawalRequest-&gt;App\Http\Requests\User\{closure}(Object(Illuminate\Validation\Validator))
#11 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(503): Illuminate\Validation\Validator-&gt;Illuminate\Validation\{closure}()
#12 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(516): Illuminate\Validation\Validator-&gt;passes()
#13 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\ValidatesWhenResolvedTrait.php(31): Illuminate\Validation\Validator-&gt;fails()
#14 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Providers\FormRequestServiceProvider.php(30): Illuminate\Foundation\Http\FormRequest-&gt;validateResolved()
#15 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1432): Illuminate\Foundation\Providers\FormRequestServiceProvider-&gt;Illuminate\Foundation\Providers\{closure}(Object(App\Http\Requests\User\WithdrawalRequest), Object(Illuminate\Foundation\Application))
#16 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1368): Illuminate\Container\Container-&gt;fireCallbackArray(Object(App\Http\Requests\User\WithdrawalRequest), Array)
#17 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1354): Illuminate\Container\Container-&gt;fireAfterResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#18 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(850): Illuminate\Container\Container-&gt;fireResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#19 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1078): Illuminate\Container\Container-&gt;resolve('App\\Http\\Reques...', Array, true)
#20 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(763): Illuminate\Foundation\Application-&gt;resolve('App\\Http\\Reques...', Array)
#21 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1058): Illuminate\Container\Container-&gt;make('App\\Http\\Reques...', Array)
#22 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(92): Illuminate\Foundation\Application-&gt;make('App\\Http\\Reques...')
#23 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(51): Illuminate\Routing\ControllerDispatcher-&gt;transformDependency(Object(ReflectionParameter), Array, Object(stdClass))
#24 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(30): Illuminate\Routing\ControllerDispatcher-&gt;resolveMethodDependencies(Array, Object(ReflectionMethod))
#25 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(60): Illuminate\Routing\ControllerDispatcher-&gt;resolveClassMethodDependencies(Array, Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#26 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(41): Illuminate\Routing\ControllerDispatcher-&gt;resolveParameters(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#27 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(266): Illuminate\Routing\ControllerDispatcher-&gt;dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#28 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(212): Illuminate\Routing\Route-&gt;runController()
#29 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(808): Illuminate\Routing\Route-&gt;run()
#30 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Routing\Router-&gt;Illuminate\Routing\{closure}(Object(Illuminate\Http\Request))
#31 C:\PreIPO\backend\app\Http\Middleware\EnsureMfaVerified.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#32 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\EnsureMfaVerified-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#33 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#34 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#35 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(161): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#36 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(127): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequest(Object(Illuminate\Http\Request), Object(Closure), Array)
#37 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(89): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequestUsingNamedLimiter(Object(Illuminate\Http\Request), Object(Closure), 'financial', Object(Closure))
#38 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'financial')
#39 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Auth\Middleware\Authenticate.php(64): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#40 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'sanctum')
#41 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(807): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#43 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(786): Illuminate\Routing\Router-&gt;runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#44 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(750): Illuminate\Routing\Router-&gt;runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#45 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(739): Illuminate\Routing\Router-&gt;dispatchToRoute(Object(Illuminate\Http\Request))
#46 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(201): Illuminate\Routing\Router-&gt;dispatch(Object(Illuminate\Http\Request))
#47 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Foundation\Http\Kernel-&gt;Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#48 C:\PreIPO\backend\app\Http\Middleware\RedirectMiddleware.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#49 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\RedirectMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#50 C:\PreIPO\backend\app\Http\Middleware\CheckMaintenanceMode.php(48): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#51 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckMaintenanceMode-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#52 C:\PreIPO\backend\app\Http\Middleware\SanitizeInput.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#53 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\SanitizeInput-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#54 C:\PreIPO\backend\app\Http\Middleware\ForceHttps.php(23): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#55 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\ForceHttps-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#56 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#57 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#58 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#59 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#60 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#61 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#62 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#63 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#64 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#65 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#66 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#67 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#68 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\HandleCors.php(62): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#69 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\HandleCors-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#70 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#71 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#72 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#73 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#74 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#75 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(176): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#76 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(145): Illuminate\Foundation\Http\Kernel-&gt;sendRequestThroughRouter(Object(Illuminate\Http\Request))
#77 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel-&gt;handle(Object(Illuminate\Http\Request))
#78 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase-&gt;call('POST', '/api/v1/user/wa...', Array, Array, Array, Array, '{"amount":11000...')
#79 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase-&gt;json('POST', '/api/v1/user/wa...', Array, Array, 0)
#80 C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php(55): Illuminate\Foundation\Testing\TestCase-&gt;postJson('/api/v1/user/wa...', Array)
#81 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(1667): Tests\Feature\UserWithdrawalEndpointTest-&gt;testUserCannotWithdrawMoreThanBalance()
#82 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(519): PHPUnit\Framework\TestCase-&gt;runTest()
#83 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestRunner\TestRunner.php(87): PHPUnit\Framework\TestCase-&gt;runBare()
#84 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(365): PHPUnit\Framework\TestRunner-&gt;run(Object(Tests\Feature\UserWithdrawalEndpointTest))
#85 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestCase-&gt;run()
#86 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#87 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#88 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\TestRunner.php(64): PHPUnit\Framework\TestSuite-&gt;run()
#89 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\Application.php(211): PHPUnit\TextUI\TestRunner-&gt;run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#90 C:\PreIPO\backend\vendor\phpunit\phpunit\phpunit(104): PHPUnit\TextUI\Application-&gt;run(Array)
#91 {main}

----------------------------------------------------------------------------------

SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' (Connection: mysql, SQL: select sum(`amount`) as aggregate from `withdrawals` where `user_id` = 16216 and `status` != rejected and date(`created_at`) = 2026-02-22)
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php:58</failure>
        </testcase>
        <testcase name="testUserCanRequestWithdrawal" file="C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php" line="44" class="Tests\Feature\UserWithdrawalEndpointTest" classname="Tests.Feature.UserWithdrawalEndpointTest" assertions="1" time="0.196009">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\UserWithdrawalEndpointTest::testUserCanRequestWithdrawal&#13;
Expected response status code [200] but received 500.
Failed asserting that 500 is identical to 200.&#13;
&#13;
The following exception occurred during the last request:

PDOException: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' in C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:407
Stack trace:
#0 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(407): PDO-&gt;prepare('select sum(`amo...')
#1 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(812): Illuminate\Database\Connection-&gt;Illuminate\Database\{closure}('select sum(`amo...', Array)
#2 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(779): Illuminate\Database\Connection-&gt;runQueryCallback('select sum(`amo...', Array, Object(Closure))
#3 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(398): Illuminate\Database\Connection-&gt;run('select sum(`amo...', Array, Object(Closure))
#4 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3106): Illuminate\Database\Connection-&gt;select('select sum(`amo...', Array, true)
#5 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3091): Illuminate\Database\Query\Builder-&gt;runSelect()
#6 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3676): Illuminate\Database\Query\Builder-&gt;Illuminate\Database\Query\{closure}()
#7 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3090): Illuminate\Database\Query\Builder-&gt;onceWithColumns(Array, Object(Closure))
#8 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3603): Illuminate\Database\Query\Builder-&gt;get(Array)
#9 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3564): Illuminate\Database\Query\Builder-&gt;aggregate('sum', Array)
#10 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php(2120): Illuminate\Database\Query\Builder-&gt;sum('amount')
#11 C:\PreIPO\backend\app\Http\Requests\User\WithdrawalRequest.php(70): Illuminate\Database\Eloquent\Builder-&gt;__call('sum', Array)
#12 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(450): App\Http\Requests\User\WithdrawalRequest-&gt;App\Http\Requests\User\{closure}(Object(Illuminate\Validation\Validator))
#13 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(503): Illuminate\Validation\Validator-&gt;Illuminate\Validation\{closure}()
#14 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(516): Illuminate\Validation\Validator-&gt;passes()
#15 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\ValidatesWhenResolvedTrait.php(31): Illuminate\Validation\Validator-&gt;fails()
#16 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Providers\FormRequestServiceProvider.php(30): Illuminate\Foundation\Http\FormRequest-&gt;validateResolved()
#17 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1432): Illuminate\Foundation\Providers\FormRequestServiceProvider-&gt;Illuminate\Foundation\Providers\{closure}(Object(App\Http\Requests\User\WithdrawalRequest), Object(Illuminate\Foundation\Application))
#18 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1368): Illuminate\Container\Container-&gt;fireCallbackArray(Object(App\Http\Requests\User\WithdrawalRequest), Array)
#19 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1354): Illuminate\Container\Container-&gt;fireAfterResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#20 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(850): Illuminate\Container\Container-&gt;fireResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#21 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1078): Illuminate\Container\Container-&gt;resolve('App\\Http\\Reques...', Array, true)
#22 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(763): Illuminate\Foundation\Application-&gt;resolve('App\\Http\\Reques...', Array)
#23 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1058): Illuminate\Container\Container-&gt;make('App\\Http\\Reques...', Array)
#24 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(92): Illuminate\Foundation\Application-&gt;make('App\\Http\\Reques...')
#25 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(51): Illuminate\Routing\ControllerDispatcher-&gt;transformDependency(Object(ReflectionParameter), Array, Object(stdClass))
#26 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(30): Illuminate\Routing\ControllerDispatcher-&gt;resolveMethodDependencies(Array, Object(ReflectionMethod))
#27 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(60): Illuminate\Routing\ControllerDispatcher-&gt;resolveClassMethodDependencies(Array, Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#28 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(41): Illuminate\Routing\ControllerDispatcher-&gt;resolveParameters(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#29 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(266): Illuminate\Routing\ControllerDispatcher-&gt;dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#30 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(212): Illuminate\Routing\Route-&gt;runController()
#31 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(808): Illuminate\Routing\Route-&gt;run()
#32 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Routing\Router-&gt;Illuminate\Routing\{closure}(Object(Illuminate\Http\Request))
#33 C:\PreIPO\backend\app\Http\Middleware\EnsureMfaVerified.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#34 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\EnsureMfaVerified-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#35 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#36 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#37 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(161): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#38 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(127): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequest(Object(Illuminate\Http\Request), Object(Closure), Array)
#39 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(89): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequestUsingNamedLimiter(Object(Illuminate\Http\Request), Object(Closure), 'financial', Object(Closure))
#40 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'financial')
#41 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Auth\Middleware\Authenticate.php(64): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'sanctum')
#43 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#44 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(807): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#45 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(786): Illuminate\Routing\Router-&gt;runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#46 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(750): Illuminate\Routing\Router-&gt;runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#47 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(739): Illuminate\Routing\Router-&gt;dispatchToRoute(Object(Illuminate\Http\Request))
#48 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(201): Illuminate\Routing\Router-&gt;dispatch(Object(Illuminate\Http\Request))
#49 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Foundation\Http\Kernel-&gt;Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#50 C:\PreIPO\backend\app\Http\Middleware\RedirectMiddleware.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#51 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\RedirectMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#52 C:\PreIPO\backend\app\Http\Middleware\CheckMaintenanceMode.php(48): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#53 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckMaintenanceMode-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#54 C:\PreIPO\backend\app\Http\Middleware\SanitizeInput.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#55 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\SanitizeInput-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#56 C:\PreIPO\backend\app\Http\Middleware\ForceHttps.php(23): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#57 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\ForceHttps-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#58 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#59 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#60 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#61 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#62 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#63 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#64 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#65 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#66 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#67 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#68 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#69 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#70 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\HandleCors.php(62): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#71 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\HandleCors-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#72 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#73 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#74 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#75 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#76 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#77 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(176): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#78 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(145): Illuminate\Foundation\Http\Kernel-&gt;sendRequestThroughRouter(Object(Illuminate\Http\Request))
#79 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel-&gt;handle(Object(Illuminate\Http\Request))
#80 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase-&gt;call('POST', '/api/v1/user/wa...', Array, Array, Array, Array, '{"amount":5000,...')
#81 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase-&gt;json('POST', '/api/v1/user/wa...', Array, Array, 0)
#82 C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php(46): Illuminate\Foundation\Testing\TestCase-&gt;postJson('/api/v1/user/wa...', Array)
#83 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(1667): Tests\Feature\UserWithdrawalEndpointTest-&gt;testUserCanRequestWithdrawal()
#84 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(519): PHPUnit\Framework\TestCase-&gt;runTest()
#85 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestRunner\TestRunner.php(87): PHPUnit\Framework\TestCase-&gt;runBare()
#86 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(365): PHPUnit\Framework\TestRunner-&gt;run(Object(Tests\Feature\UserWithdrawalEndpointTest))
#87 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestCase-&gt;run()
#88 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#89 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#90 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\TestRunner.php(64): PHPUnit\Framework\TestSuite-&gt;run()
#91 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\Application.php(211): PHPUnit\TextUI\TestRunner-&gt;run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#92 C:\PreIPO\backend\vendor\phpunit\phpunit\phpunit(104): PHPUnit\TextUI\Application-&gt;run(Array)
#93 {main}

Next Illuminate\Database\QueryException: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' (Connection: mysql, SQL: select sum(`amount`) as aggregate from `withdrawals` where `user_id` = 16217 and `status` != rejected and date(`created_at`) = 2026-02-22) in C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
Stack trace:
#0 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(779): Illuminate\Database\Connection-&gt;runQueryCallback('select sum(`amo...', Array, Object(Closure))
#1 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(398): Illuminate\Database\Connection-&gt;run('select sum(`amo...', Array, Object(Closure))
#2 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3106): Illuminate\Database\Connection-&gt;select('select sum(`amo...', Array, true)
#3 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3091): Illuminate\Database\Query\Builder-&gt;runSelect()
#4 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3676): Illuminate\Database\Query\Builder-&gt;Illuminate\Database\Query\{closure}()
#5 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3090): Illuminate\Database\Query\Builder-&gt;onceWithColumns(Array, Object(Closure))
#6 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3603): Illuminate\Database\Query\Builder-&gt;get(Array)
#7 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3564): Illuminate\Database\Query\Builder-&gt;aggregate('sum', Array)
#8 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php(2120): Illuminate\Database\Query\Builder-&gt;sum('amount')
#9 C:\PreIPO\backend\app\Http\Requests\User\WithdrawalRequest.php(70): Illuminate\Database\Eloquent\Builder-&gt;__call('sum', Array)
#10 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(450): App\Http\Requests\User\WithdrawalRequest-&gt;App\Http\Requests\User\{closure}(Object(Illuminate\Validation\Validator))
#11 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(503): Illuminate\Validation\Validator-&gt;Illuminate\Validation\{closure}()
#12 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(516): Illuminate\Validation\Validator-&gt;passes()
#13 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\ValidatesWhenResolvedTrait.php(31): Illuminate\Validation\Validator-&gt;fails()
#14 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Providers\FormRequestServiceProvider.php(30): Illuminate\Foundation\Http\FormRequest-&gt;validateResolved()
#15 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1432): Illuminate\Foundation\Providers\FormRequestServiceProvider-&gt;Illuminate\Foundation\Providers\{closure}(Object(App\Http\Requests\User\WithdrawalRequest), Object(Illuminate\Foundation\Application))
#16 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1368): Illuminate\Container\Container-&gt;fireCallbackArray(Object(App\Http\Requests\User\WithdrawalRequest), Array)
#17 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1354): Illuminate\Container\Container-&gt;fireAfterResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#18 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(850): Illuminate\Container\Container-&gt;fireResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#19 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1078): Illuminate\Container\Container-&gt;resolve('App\\Http\\Reques...', Array, true)
#20 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(763): Illuminate\Foundation\Application-&gt;resolve('App\\Http\\Reques...', Array)
#21 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1058): Illuminate\Container\Container-&gt;make('App\\Http\\Reques...', Array)
#22 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(92): Illuminate\Foundation\Application-&gt;make('App\\Http\\Reques...')
#23 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(51): Illuminate\Routing\ControllerDispatcher-&gt;transformDependency(Object(ReflectionParameter), Array, Object(stdClass))
#24 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(30): Illuminate\Routing\ControllerDispatcher-&gt;resolveMethodDependencies(Array, Object(ReflectionMethod))
#25 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(60): Illuminate\Routing\ControllerDispatcher-&gt;resolveClassMethodDependencies(Array, Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#26 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(41): Illuminate\Routing\ControllerDispatcher-&gt;resolveParameters(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#27 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(266): Illuminate\Routing\ControllerDispatcher-&gt;dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#28 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(212): Illuminate\Routing\Route-&gt;runController()
#29 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(808): Illuminate\Routing\Route-&gt;run()
#30 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Routing\Router-&gt;Illuminate\Routing\{closure}(Object(Illuminate\Http\Request))
#31 C:\PreIPO\backend\app\Http\Middleware\EnsureMfaVerified.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#32 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\EnsureMfaVerified-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#33 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#34 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#35 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(161): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#36 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(127): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequest(Object(Illuminate\Http\Request), Object(Closure), Array)
#37 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(89): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequestUsingNamedLimiter(Object(Illuminate\Http\Request), Object(Closure), 'financial', Object(Closure))
#38 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'financial')
#39 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Auth\Middleware\Authenticate.php(64): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#40 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'sanctum')
#41 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(807): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#43 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(786): Illuminate\Routing\Router-&gt;runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#44 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(750): Illuminate\Routing\Router-&gt;runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#45 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(739): Illuminate\Routing\Router-&gt;dispatchToRoute(Object(Illuminate\Http\Request))
#46 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(201): Illuminate\Routing\Router-&gt;dispatch(Object(Illuminate\Http\Request))
#47 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Foundation\Http\Kernel-&gt;Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#48 C:\PreIPO\backend\app\Http\Middleware\RedirectMiddleware.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#49 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\RedirectMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#50 C:\PreIPO\backend\app\Http\Middleware\CheckMaintenanceMode.php(48): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#51 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckMaintenanceMode-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#52 C:\PreIPO\backend\app\Http\Middleware\SanitizeInput.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#53 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\SanitizeInput-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#54 C:\PreIPO\backend\app\Http\Middleware\ForceHttps.php(23): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#55 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\ForceHttps-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#56 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#57 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#58 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#59 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#60 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#61 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#62 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#63 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#64 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#65 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#66 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#67 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#68 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\HandleCors.php(62): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#69 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\HandleCors-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#70 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#71 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#72 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#73 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#74 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#75 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(176): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#76 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(145): Illuminate\Foundation\Http\Kernel-&gt;sendRequestThroughRouter(Object(Illuminate\Http\Request))
#77 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel-&gt;handle(Object(Illuminate\Http\Request))
#78 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase-&gt;call('POST', '/api/v1/user/wa...', Array, Array, Array, Array, '{"amount":5000,...')
#79 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase-&gt;json('POST', '/api/v1/user/wa...', Array, Array, 0)
#80 C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php(46): Illuminate\Foundation\Testing\TestCase-&gt;postJson('/api/v1/user/wa...', Array)
#81 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(1667): Tests\Feature\UserWithdrawalEndpointTest-&gt;testUserCanRequestWithdrawal()
#82 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(519): PHPUnit\Framework\TestCase-&gt;runTest()
#83 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestRunner\TestRunner.php(87): PHPUnit\Framework\TestCase-&gt;runBare()
#84 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(365): PHPUnit\Framework\TestRunner-&gt;run(Object(Tests\Feature\UserWithdrawalEndpointTest))
#85 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestCase-&gt;run()
#86 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#87 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#88 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\TestRunner.php(64): PHPUnit\Framework\TestSuite-&gt;run()
#89 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\Application.php(211): PHPUnit\TextUI\TestRunner-&gt;run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#90 C:\PreIPO\backend\vendor\phpunit\phpunit\phpunit(104): PHPUnit\TextUI\Application-&gt;run(Array)
#91 {main}

----------------------------------------------------------------------------------

SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' (Connection: mysql, SQL: select sum(`amount`) as aggregate from `withdrawals` where `user_id` = 16217 and `status` != rejected and date(`created_at`) = 2026-02-22)
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php:49</failure>
        </testcase>
        <testcase name="testWithdrawalLocksBalance" file="C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php" line="62" class="Tests\Feature\UserWithdrawalEndpointTest" classname="Tests.Feature.UserWithdrawalEndpointTest" assertions="1" time="0.273148">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\UserWithdrawalEndpointTest::testWithdrawalLocksBalance&#13;
Failed asserting that 10000 matches expected 7000.
&#13;
C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php:68</failure>
        </testcase>
        <testcase name="testWithdrawalRespectsMinimumAmount" file="C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php" line="110" class="Tests\Feature\UserWithdrawalEndpointTest" classname="Tests.Feature.UserWithdrawalEndpointTest" assertions="1" time="1.111979">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\UserWithdrawalEndpointTest::testWithdrawalRespectsMinimumAmount&#13;
Expected response status code [422] but received 500.
Failed asserting that 500 is identical to 422.&#13;
&#13;
The following exception occurred during the last request:

PDOException: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' in C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:407
Stack trace:
#0 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(407): PDO-&gt;prepare('select sum(`amo...')
#1 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(812): Illuminate\Database\Connection-&gt;Illuminate\Database\{closure}('select sum(`amo...', Array)
#2 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(779): Illuminate\Database\Connection-&gt;runQueryCallback('select sum(`amo...', Array, Object(Closure))
#3 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(398): Illuminate\Database\Connection-&gt;run('select sum(`amo...', Array, Object(Closure))
#4 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3106): Illuminate\Database\Connection-&gt;select('select sum(`amo...', Array, true)
#5 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3091): Illuminate\Database\Query\Builder-&gt;runSelect()
#6 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3676): Illuminate\Database\Query\Builder-&gt;Illuminate\Database\Query\{closure}()
#7 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3090): Illuminate\Database\Query\Builder-&gt;onceWithColumns(Array, Object(Closure))
#8 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3603): Illuminate\Database\Query\Builder-&gt;get(Array)
#9 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3564): Illuminate\Database\Query\Builder-&gt;aggregate('sum', Array)
#10 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php(2120): Illuminate\Database\Query\Builder-&gt;sum('amount')
#11 C:\PreIPO\backend\app\Http\Requests\User\WithdrawalRequest.php(70): Illuminate\Database\Eloquent\Builder-&gt;__call('sum', Array)
#12 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(450): App\Http\Requests\User\WithdrawalRequest-&gt;App\Http\Requests\User\{closure}(Object(Illuminate\Validation\Validator))
#13 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(503): Illuminate\Validation\Validator-&gt;Illuminate\Validation\{closure}()
#14 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(516): Illuminate\Validation\Validator-&gt;passes()
#15 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\ValidatesWhenResolvedTrait.php(31): Illuminate\Validation\Validator-&gt;fails()
#16 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Providers\FormRequestServiceProvider.php(30): Illuminate\Foundation\Http\FormRequest-&gt;validateResolved()
#17 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1432): Illuminate\Foundation\Providers\FormRequestServiceProvider-&gt;Illuminate\Foundation\Providers\{closure}(Object(App\Http\Requests\User\WithdrawalRequest), Object(Illuminate\Foundation\Application))
#18 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1368): Illuminate\Container\Container-&gt;fireCallbackArray(Object(App\Http\Requests\User\WithdrawalRequest), Array)
#19 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1354): Illuminate\Container\Container-&gt;fireAfterResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#20 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(850): Illuminate\Container\Container-&gt;fireResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#21 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1078): Illuminate\Container\Container-&gt;resolve('App\\Http\\Reques...', Array, true)
#22 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(763): Illuminate\Foundation\Application-&gt;resolve('App\\Http\\Reques...', Array)
#23 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1058): Illuminate\Container\Container-&gt;make('App\\Http\\Reques...', Array)
#24 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(92): Illuminate\Foundation\Application-&gt;make('App\\Http\\Reques...')
#25 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(51): Illuminate\Routing\ControllerDispatcher-&gt;transformDependency(Object(ReflectionParameter), Array, Object(stdClass))
#26 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(30): Illuminate\Routing\ControllerDispatcher-&gt;resolveMethodDependencies(Array, Object(ReflectionMethod))
#27 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(60): Illuminate\Routing\ControllerDispatcher-&gt;resolveClassMethodDependencies(Array, Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#28 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(41): Illuminate\Routing\ControllerDispatcher-&gt;resolveParameters(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#29 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(266): Illuminate\Routing\ControllerDispatcher-&gt;dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#30 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(212): Illuminate\Routing\Route-&gt;runController()
#31 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(808): Illuminate\Routing\Route-&gt;run()
#32 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Routing\Router-&gt;Illuminate\Routing\{closure}(Object(Illuminate\Http\Request))
#33 C:\PreIPO\backend\app\Http\Middleware\EnsureMfaVerified.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#34 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\EnsureMfaVerified-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#35 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#36 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#37 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(161): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#38 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(127): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequest(Object(Illuminate\Http\Request), Object(Closure), Array)
#39 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(89): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequestUsingNamedLimiter(Object(Illuminate\Http\Request), Object(Closure), 'financial', Object(Closure))
#40 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'financial')
#41 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Auth\Middleware\Authenticate.php(64): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'sanctum')
#43 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#44 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(807): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#45 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(786): Illuminate\Routing\Router-&gt;runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#46 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(750): Illuminate\Routing\Router-&gt;runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#47 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(739): Illuminate\Routing\Router-&gt;dispatchToRoute(Object(Illuminate\Http\Request))
#48 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(201): Illuminate\Routing\Router-&gt;dispatch(Object(Illuminate\Http\Request))
#49 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Foundation\Http\Kernel-&gt;Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#50 C:\PreIPO\backend\app\Http\Middleware\RedirectMiddleware.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#51 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\RedirectMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#52 C:\PreIPO\backend\app\Http\Middleware\CheckMaintenanceMode.php(48): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#53 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckMaintenanceMode-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#54 C:\PreIPO\backend\app\Http\Middleware\SanitizeInput.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#55 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\SanitizeInput-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#56 C:\PreIPO\backend\app\Http\Middleware\ForceHttps.php(23): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#57 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\ForceHttps-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#58 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#59 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#60 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#61 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#62 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#63 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#64 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#65 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#66 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#67 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#68 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#69 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#70 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\HandleCors.php(62): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#71 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\HandleCors-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#72 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#73 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#74 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#75 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#76 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#77 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(176): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#78 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(145): Illuminate\Foundation\Http\Kernel-&gt;sendRequestThroughRouter(Object(Illuminate\Http\Request))
#79 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel-&gt;handle(Object(Illuminate\Http\Request))
#80 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase-&gt;call('POST', '/api/v1/user/wa...', Array, Array, Array, Array, '{"amount":500,"...')
#81 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase-&gt;json('POST', '/api/v1/user/wa...', Array, Array, 0)
#82 C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php(112): Illuminate\Foundation\Testing\TestCase-&gt;postJson('/api/v1/user/wa...', Array)
#83 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(1667): Tests\Feature\UserWithdrawalEndpointTest-&gt;testWithdrawalRespectsMinimumAmount()
#84 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(519): PHPUnit\Framework\TestCase-&gt;runTest()
#85 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestRunner\TestRunner.php(87): PHPUnit\Framework\TestCase-&gt;runBare()
#86 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(365): PHPUnit\Framework\TestRunner-&gt;run(Object(Tests\Feature\UserWithdrawalEndpointTest))
#87 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestCase-&gt;run()
#88 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#89 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#90 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\TestRunner.php(64): PHPUnit\Framework\TestSuite-&gt;run()
#91 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\Application.php(211): PHPUnit\TextUI\TestRunner-&gt;run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#92 C:\PreIPO\backend\vendor\phpunit\phpunit\phpunit(104): PHPUnit\TextUI\Application-&gt;run(Array)
#93 {main}

Next Illuminate\Database\QueryException: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' (Connection: mysql, SQL: select sum(`amount`) as aggregate from `withdrawals` where `user_id` = 16220 and `status` != rejected and date(`created_at`) = 2026-02-22) in C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
Stack trace:
#0 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(779): Illuminate\Database\Connection-&gt;runQueryCallback('select sum(`amo...', Array, Object(Closure))
#1 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php(398): Illuminate\Database\Connection-&gt;run('select sum(`amo...', Array, Object(Closure))
#2 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3106): Illuminate\Database\Connection-&gt;select('select sum(`amo...', Array, true)
#3 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3091): Illuminate\Database\Query\Builder-&gt;runSelect()
#4 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3676): Illuminate\Database\Query\Builder-&gt;Illuminate\Database\Query\{closure}()
#5 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3090): Illuminate\Database\Query\Builder-&gt;onceWithColumns(Array, Object(Closure))
#6 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3603): Illuminate\Database\Query\Builder-&gt;get(Array)
#7 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php(3564): Illuminate\Database\Query\Builder-&gt;aggregate('sum', Array)
#8 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php(2120): Illuminate\Database\Query\Builder-&gt;sum('amount')
#9 C:\PreIPO\backend\app\Http\Requests\User\WithdrawalRequest.php(70): Illuminate\Database\Eloquent\Builder-&gt;__call('sum', Array)
#10 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(450): App\Http\Requests\User\WithdrawalRequest-&gt;App\Http\Requests\User\{closure}(Object(Illuminate\Validation\Validator))
#11 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(503): Illuminate\Validation\Validator-&gt;Illuminate\Validation\{closure}()
#12 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\Validator.php(516): Illuminate\Validation\Validator-&gt;passes()
#13 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Validation\ValidatesWhenResolvedTrait.php(31): Illuminate\Validation\Validator-&gt;fails()
#14 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Providers\FormRequestServiceProvider.php(30): Illuminate\Foundation\Http\FormRequest-&gt;validateResolved()
#15 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1432): Illuminate\Foundation\Providers\FormRequestServiceProvider-&gt;Illuminate\Foundation\Providers\{closure}(Object(App\Http\Requests\User\WithdrawalRequest), Object(Illuminate\Foundation\Application))
#16 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1368): Illuminate\Container\Container-&gt;fireCallbackArray(Object(App\Http\Requests\User\WithdrawalRequest), Array)
#17 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(1354): Illuminate\Container\Container-&gt;fireAfterResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#18 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(850): Illuminate\Container\Container-&gt;fireResolvingCallbacks('App\\Http\\Reques...', Object(App\Http\Requests\User\WithdrawalRequest))
#19 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1078): Illuminate\Container\Container-&gt;resolve('App\\Http\\Reques...', Array, true)
#20 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php(763): Illuminate\Foundation\Application-&gt;resolve('App\\Http\\Reques...', Array)
#21 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Application.php(1058): Illuminate\Container\Container-&gt;make('App\\Http\\Reques...', Array)
#22 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(92): Illuminate\Foundation\Application-&gt;make('App\\Http\\Reques...')
#23 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(51): Illuminate\Routing\ControllerDispatcher-&gt;transformDependency(Object(ReflectionParameter), Array, Object(stdClass))
#24 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ResolvesRouteDependencies.php(30): Illuminate\Routing\ControllerDispatcher-&gt;resolveMethodDependencies(Array, Object(ReflectionMethod))
#25 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(60): Illuminate\Routing\ControllerDispatcher-&gt;resolveClassMethodDependencies(Array, Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#26 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php(41): Illuminate\Routing\ControllerDispatcher-&gt;resolveParameters(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#27 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(266): Illuminate\Routing\ControllerDispatcher-&gt;dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\User\WalletController), 'requestWithdraw...')
#28 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(212): Illuminate\Routing\Route-&gt;runController()
#29 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(808): Illuminate\Routing\Route-&gt;run()
#30 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Routing\Router-&gt;Illuminate\Routing\{closure}(Object(Illuminate\Http\Request))
#31 C:\PreIPO\backend\app\Http\Middleware\EnsureMfaVerified.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#32 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\EnsureMfaVerified-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#33 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#34 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#35 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(161): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#36 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(127): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequest(Object(Illuminate\Http\Request), Object(Closure), Array)
#37 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\ThrottleRequests.php(89): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handleRequestUsingNamedLimiter(Object(Illuminate\Http\Request), Object(Closure), 'financial', Object(Closure))
#38 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\ThrottleRequests-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'financial')
#39 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Auth\Middleware\Authenticate.php(64): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#40 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'sanctum')
#41 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(807): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#43 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(786): Illuminate\Routing\Router-&gt;runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#44 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(750): Illuminate\Routing\Router-&gt;runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#45 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(739): Illuminate\Routing\Router-&gt;dispatchToRoute(Object(Illuminate\Http\Request))
#46 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(201): Illuminate\Routing\Router-&gt;dispatch(Object(Illuminate\Http\Request))
#47 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Foundation\Http\Kernel-&gt;Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#48 C:\PreIPO\backend\app\Http\Middleware\RedirectMiddleware.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#49 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\RedirectMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#50 C:\PreIPO\backend\app\Http\Middleware\CheckMaintenanceMode.php(48): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#51 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckMaintenanceMode-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#52 C:\PreIPO\backend\app\Http\Middleware\SanitizeInput.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#53 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\SanitizeInput-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#54 C:\PreIPO\backend\app\Http\Middleware\ForceHttps.php(23): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#55 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\ForceHttps-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#56 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#57 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#58 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#59 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#60 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#61 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#62 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#63 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#64 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#65 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#66 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#67 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#68 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\HandleCors.php(62): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#69 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\HandleCors-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#70 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#71 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#72 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#73 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#74 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#75 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(176): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#76 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(145): Illuminate\Foundation\Http\Kernel-&gt;sendRequestThroughRouter(Object(Illuminate\Http\Request))
#77 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel-&gt;handle(Object(Illuminate\Http\Request))
#78 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase-&gt;call('POST', '/api/v1/user/wa...', Array, Array, Array, Array, '{"amount":500,"...')
#79 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase-&gt;json('POST', '/api/v1/user/wa...', Array, Array, 0)
#80 C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php(112): Illuminate\Foundation\Testing\TestCase-&gt;postJson('/api/v1/user/wa...', Array)
#81 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(1667): Tests\Feature\UserWithdrawalEndpointTest-&gt;testWithdrawalRespectsMinimumAmount()
#82 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(519): PHPUnit\Framework\TestCase-&gt;runTest()
#83 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestRunner\TestRunner.php(87): PHPUnit\Framework\TestCase-&gt;runBare()
#84 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(365): PHPUnit\Framework\TestRunner-&gt;run(Object(Tests\Feature\UserWithdrawalEndpointTest))
#85 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestCase-&gt;run()
#86 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#87 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#88 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\TestRunner.php(64): PHPUnit\Framework\TestSuite-&gt;run()
#89 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\Application.php(211): PHPUnit\TextUI\TestRunner-&gt;run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#90 C:\PreIPO\backend\vendor\phpunit\phpunit\phpunit(104): PHPUnit\TextUI\Application-&gt;run(Array)
#91 {main}

----------------------------------------------------------------------------------

SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' (Connection: mysql, SQL: select sum(`amount`) as aggregate from `withdrawals` where `user_id` = 16220 and `status` != rejected and date(`created_at`) = 2026-02-22)
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php:115</failure>
        </testcase>
        <testcase name="testWithdrawalRequiresBankDetails" file="C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php" line="101" class="Tests\Feature\UserWithdrawalEndpointTest" classname="Tests.Feature.UserWithdrawalEndpointTest" assertions="0" time="0.000000">
          <error type="Illuminate\Database\UniqueConstraintViolationException">Tests\Feature\UserWithdrawalEndpointTest::testWithdrawalRequiresBankDetails&#13;
Illuminate\Database\UniqueConstraintViolationException: SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry 'finance-web' for key 'roles_name_guard_name_unique' (Connection: mysql, SQL: insert into `roles` (`guard_name`, `name`, `updated_at`, `created_at`) values (web, finance, 2026-02-22 10:35:19, 2026-02-22 10:35:19))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:820
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:634
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1863
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:634
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:621
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\database\seeders\RolesAndPermissionsSeeder.php:39
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Seeder.php:188
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Seeder.php:197
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Console\Seeds\SeedCommand.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\GuardsAttributes.php:155
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Console\Seeds\SeedCommand.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Command.php:213
C:\PreIPO\backend\vendor\symfony\console\Command\Command.php:341
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Command.php:182
C:\PreIPO\backend\vendor\symfony\console\Application.php:1079
C:\PreIPO\backend\vendor\symfony\console\Application.php:356
C:\PreIPO\backend\vendor\symfony\console\Application.php:195
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Application.php:166
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Console\Kernel.php:427
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\PendingCommand.php:332
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\PendingCommand.php:556
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithConsole.php:87
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithDatabase.php:332
C:\PreIPO\backend\tests\Feature\UserWithdrawalEndpointTest.php:22</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\FullPaymentLifecycleActivationTest" file="C:\PreIPO\backend\tests\Feature\FullPaymentLifecycleActivationTest.php" tests="4" assertions="6" errors="4" failures="0" skipped="0" time="3.076310">
        <testcase name="duplicate_webhook_does_not_double_credit" file="C:\PreIPO\backend\tests\Feature\FullPaymentLifecycleActivationTest.php" line="361" class="Tests\Feature\FullPaymentLifecycleActivationTest" classname="Tests.Feature.FullPaymentLifecycleActivationTest" assertions="0" time="0.000000">
          <error type="Illuminate\Database\QueryException">Tests\Feature\FullPaymentLifecycleActivationTest::duplicate_webhook_does_not_double_credit&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1412 Table definition has changed, please retry transaction (Connection: mysql, SQL: select * from `permissions` where (`name` = access admin panel and `guard_name` = web) limit 1)
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:398
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3106
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3091
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3676
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3090
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:811
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:793
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\BuildsQueries.php:343
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:617
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\database\seeders\RolesAndPermissionsSeeder.php:65
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Seeder.php:188
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Seeder.php:197
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Console\Seeds\SeedCommand.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\GuardsAttributes.php:155
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Console\Seeds\SeedCommand.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Command.php:213
C:\PreIPO\backend\vendor\symfony\console\Command\Command.php:341
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Command.php:182
C:\PreIPO\backend\vendor\symfony\console\Application.php:1079
C:\PreIPO\backend\vendor\symfony\console\Application.php:356
C:\PreIPO\backend\vendor\symfony\console\Application.php:195
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Application.php:166
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Console\Kernel.php:427
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\PendingCommand.php:332
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\PendingCommand.php:556
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithConsole.php:87
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithDatabase.php:332
C:\PreIPO\backend\tests\Feature\FullPaymentLifecycleActivationTest.php:59</error>
        </testcase>
        <testcase name="full_payment_lifecycle_from_subscription_to_bonus" file="C:\PreIPO\backend\tests\Feature\FullPaymentLifecycleActivationTest.php" line="100" class="Tests\Feature\FullPaymentLifecycleActivationTest" classname="Tests.Feature.FullPaymentLifecycleActivationTest" assertions="6" time="1.133142">
          <error type="RuntimeException">Tests\Feature\FullPaymentLifecycleActivationTest::full_payment_lifecycle_from_subscription_to_bonus&#13;
RuntimeException: Payment #4782 has NULL amount_paise. Float fallback is PROHIBITED. Data integrity violation.
&#13;
C:\PreIPO\backend\app\Models\Payment.php:495
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:804
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:741
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:670
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\FullPaymentLifecycleActivationTest.php:144</error>
        </testcase>
        <testcase name="failed_payment_does_not_activate_subscription" file="C:\PreIPO\backend\tests\Feature\FullPaymentLifecycleActivationTest.php" line="319" class="Tests\Feature\FullPaymentLifecycleActivationTest" classname="Tests.Feature.FullPaymentLifecycleActivationTest" assertions="0" time="0.955820">
          <error type="Error">Tests\Feature\FullPaymentLifecycleActivationTest::failed_payment_does_not_activate_subscription&#13;
Error: Call to undefined method App\Services\PaymentWebhookService::handlePaymentFailed()
&#13;
C:\PreIPO\backend\tests\Feature\FullPaymentLifecycleActivationTest.php:338</error>
        </testcase>
        <testcase name="lifecycle_triggers_progressive_bonus_at_month_4" file="C:\PreIPO\backend\tests\Feature\FullPaymentLifecycleActivationTest.php" line="253" class="Tests\Feature\FullPaymentLifecycleActivationTest" classname="Tests.Feature.FullPaymentLifecycleActivationTest" assertions="0" time="0.987348">
          <error type="RuntimeException">Tests\Feature\FullPaymentLifecycleActivationTest::lifecycle_triggers_progressive_bonus_at_month_4&#13;
RuntimeException: Payment #4787 has NULL amount_paise. Float fallback is PROHIBITED. Data integrity violation.
&#13;
C:\PreIPO\backend\app\Models\Payment.php:495
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:804
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:741
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:670
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\FullPaymentLifecycleActivationTest.php:288</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\GenerateSitemapTest" file="C:\PreIPO\backend\tests\Feature\GenerateSitemapTest.php" tests="3" assertions="5" errors="2" failures="0" skipped="0" time="0.239567">
        <testcase name="test_includes_dynamic_routes" file="C:\PreIPO\backend\tests\Feature\GenerateSitemapTest.php" line="67" class="Tests\Feature\GenerateSitemapTest" classname="Tests.Feature.GenerateSitemapTest" assertions="0" time="0.000000">
          <error type="Illuminate\Database\UniqueConstraintViolationException">Tests\Feature\GenerateSitemapTest::test_includes_dynamic_routes&#13;
Illuminate\Database\UniqueConstraintViolationException: SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry 'finance-web' for key 'roles_name_guard_name_unique' (Connection: mysql, SQL: insert into `roles` (`guard_name`, `name`, `updated_at`, `created_at`) values (web, finance, 2026-02-22 10:35:23, 2026-02-22 10:35:23))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:820
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:634
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1863
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:634
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:621
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\database\seeders\RolesAndPermissionsSeeder.php:39
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Seeder.php:188
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Seeder.php:197
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Console\Seeds\SeedCommand.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\GuardsAttributes.php:155
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Console\Seeds\SeedCommand.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Command.php:213
C:\PreIPO\backend\vendor\symfony\console\Command\Command.php:341
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Command.php:182
C:\PreIPO\backend\vendor\symfony\console\Application.php:1079
C:\PreIPO\backend\vendor\symfony\console\Application.php:356
C:\PreIPO\backend\vendor\symfony\console\Application.php:195
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Application.php:166
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Console\Kernel.php:427
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\PendingCommand.php:332
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\PendingCommand.php:556
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithConsole.php:87
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithDatabase.php:332
C:\PreIPO\backend\tests\Feature\GenerateSitemapTest.php:20</error>
        </testcase>
        <testcase name="test_generates_sitemap_xml" file="C:\PreIPO\backend\tests\Feature\GenerateSitemapTest.php" line="39" class="Tests\Feature\GenerateSitemapTest" classname="Tests.Feature.GenerateSitemapTest" assertions="0" time="0.000000">
          <error type="Illuminate\Database\QueryException">Tests\Feature\GenerateSitemapTest::test_generates_sitemap_xml&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1412 Table definition has changed, please retry transaction (Connection: mysql, SQL: select * from `permissions` where (`name` = access admin panel and `guard_name` = web) limit 1)
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:398
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3106
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3091
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3676
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3090
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:811
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:793
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\BuildsQueries.php:343
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:617
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\database\seeders\RolesAndPermissionsSeeder.php:65
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Seeder.php:188
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Seeder.php:197
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Console\Seeds\SeedCommand.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\GuardsAttributes.php:155
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Console\Seeds\SeedCommand.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Command.php:213
C:\PreIPO\backend\vendor\symfony\console\Command\Command.php:341
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Command.php:182
C:\PreIPO\backend\vendor\symfony\console\Application.php:1079
C:\PreIPO\backend\vendor\symfony\console\Application.php:356
C:\PreIPO\backend\vendor\symfony\console\Application.php:195
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Application.php:166
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Console\Kernel.php:427
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\PendingCommand.php:332
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\PendingCommand.php:556
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithConsole.php:87
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithDatabase.php:332
C:\PreIPO\backend\tests\Feature\GenerateSitemapTest.php:20</error>
        </testcase>
        <testcase name="test_includes_all_public_pages" file="C:\PreIPO\backend\tests\Feature\GenerateSitemapTest.php" line="53" class="Tests\Feature\GenerateSitemapTest" classname="Tests.Feature.GenerateSitemapTest" assertions="5" time="0.239567"/>
      </testsuite>
      <testsuite name="Tests\Feature\ProcessCelebrationBonusesTest" file="C:\PreIPO\backend\tests\Feature\ProcessCelebrationBonusesTest.php" tests="4" assertions="3" errors="1" failures="2" skipped="0" time="3.361543">
        <testcase name="test_identifies_birthdays_today_and_awards_bonus" file="C:\PreIPO\backend\tests\Feature\ProcessCelebrationBonusesTest.php" line="77" class="Tests\Feature\ProcessCelebrationBonusesTest" classname="Tests.Feature.ProcessCelebrationBonusesTest" assertions="1" time="1.676960">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ProcessCelebrationBonusesTest::test_identifies_birthdays_today_and_awards_bonus&#13;
Failed asserting that a row in the table [bonus_transactions] matches the attributes {
    "user_id": 16234,
    "type": "celebration",
    "description": "Happy Birthday! Here is your bonus.",
    "amount": 50
}.

Found similar results: [
    {
        "user_id": 16234,
        "type": "celebration",
        "description": "Happy Birthday!",
        "amount": "50.00"
    },
    {
        "user_id": 16234,
        "type": "celebration",
        "description": "Happy 2 Year Anniversary!",
        "amount": "200.00"
    }
].
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithDatabase.php:36
C:\PreIPO\backend\tests\Feature\ProcessCelebrationBonusesTest.php:83</failure>
        </testcase>
        <testcase name="test_awards_anniversary_bonus" file="C:\PreIPO\backend\tests\Feature\ProcessCelebrationBonusesTest.php" line="129" class="Tests\Feature\ProcessCelebrationBonusesTest" classname="Tests.Feature.ProcessCelebrationBonusesTest" assertions="1" time="0.772132"/>
        <testcase name="test_awards_birthday_bonus" file="C:\PreIPO\backend\tests\Feature\ProcessCelebrationBonusesTest.php" line="98" class="Tests\Feature\ProcessCelebrationBonusesTest" classname="Tests.Feature.ProcessCelebrationBonusesTest" assertions="1" time="0.912451">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\ProcessCelebrationBonusesTest::test_awards_birthday_bonus&#13;
Failed asserting that 225 matches expected 250.
&#13;
C:\PreIPO\backend\tests\Feature\ProcessCelebrationBonusesTest.php:106</failure>
        </testcase>
        <testcase name="test_identifies_subscription_anniversaries" file="C:\PreIPO\backend\tests\Feature\ProcessCelebrationBonusesTest.php" line="110" class="Tests\Feature\ProcessCelebrationBonusesTest" classname="Tests.Feature.ProcessCelebrationBonusesTest" assertions="0" time="0.000000">
          <error type="Illuminate\Database\UniqueConstraintViolationException">Tests\Feature\ProcessCelebrationBonusesTest::test_identifies_subscription_anniversaries&#13;
Illuminate\Database\UniqueConstraintViolationException: SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry 'finance-web' for key 'roles_name_guard_name_unique' (Connection: mysql, SQL: insert into `roles` (`guard_name`, `name`, `updated_at`, `created_at`) values (web, finance, 2026-02-22 10:35:27, 2026-02-22 10:35:27))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:820
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:634
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1863
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:634
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:621
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\database\seeders\RolesAndPermissionsSeeder.php:39
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Seeder.php:188
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Seeder.php:197
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Console\Seeds\SeedCommand.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\GuardsAttributes.php:155
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Console\Seeds\SeedCommand.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Command.php:213
C:\PreIPO\backend\vendor\symfony\console\Command\Command.php:341
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Command.php:182
C:\PreIPO\backend\vendor\symfony\console\Application.php:1079
C:\PreIPO\backend\vendor\symfony\console\Application.php:356
C:\PreIPO\backend\vendor\symfony\console\Application.php:195
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Application.php:166
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Console\Kernel.php:427
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\PendingCommand.php:332
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\PendingCommand.php:556
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithConsole.php:87
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithDatabase.php:332
C:\PreIPO\backend\tests\Feature\ProcessCelebrationBonusesTest.php:24</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\UserSettingsControllerTest" file="C:\PreIPO\backend\tests\Feature\UserSettingsControllerTest.php" tests="11" assertions="43" errors="1" failures="0" skipped="0" time="10.751251">
        <testcase name="settings_are_stored_as_valid_json" file="C:\PreIPO\backend\tests\Feature\UserSettingsControllerTest.php" line="321" class="Tests\Feature\UserSettingsControllerTest" classname="Tests.Feature.UserSettingsControllerTest" assertions="0" time="0.000000">
          <error type="Illuminate\Database\QueryException">Tests\Feature\UserSettingsControllerTest::settings_are_stored_as_valid_json&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1412 Table definition has changed, please retry transaction (Connection: mysql, SQL: select * from `permissions` where (`name` = access admin panel and `guard_name` = web) limit 1)
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:398
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3106
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3091
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3676
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3090
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:811
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:793
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\BuildsQueries.php:343
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:617
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\database\seeders\RolesAndPermissionsSeeder.php:65
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Seeder.php:188
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Seeder.php:197
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Console\Seeds\SeedCommand.php:70
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\GuardsAttributes.php:155
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Console\Seeds\SeedCommand.php:69
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Util.php:43
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:95
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\BoundMethod.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Container\Container.php:696
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Command.php:213
C:\PreIPO\backend\vendor\symfony\console\Command\Command.php:341
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Command.php:182
C:\PreIPO\backend\vendor\symfony\console\Application.php:1079
C:\PreIPO\backend\vendor\symfony\console\Application.php:356
C:\PreIPO\backend\vendor\symfony\console\Application.php:195
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Console\Application.php:166
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Console\Kernel.php:427
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\PendingCommand.php:332
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\PendingCommand.php:556
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithConsole.php:87
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithDatabase.php:332
C:\PreIPO\backend\tests\Feature\UserSettingsControllerTest.php:26
C:\PreIPO\backend\tests\Feature\UserSettingsControllerTest.php:18</error>
        </testcase>
        <testcase name="unauthenticated_user_cannot_access_settings" file="C:\PreIPO\backend\tests\Feature\UserSettingsControllerTest.php" line="33" class="Tests\Feature\UserSettingsControllerTest" classname="Tests.Feature.UserSettingsControllerTest" assertions="1" time="0.861527"/>
        <testcase name="user_can_update_security_settings" file="C:\PreIPO\backend\tests\Feature\UserSettingsControllerTest.php" line="128" class="Tests\Feature\UserSettingsControllerTest" classname="Tests.Feature.UserSettingsControllerTest" assertions="3" time="0.777892"/>
        <testcase name="user_can_get_saved_settings" file="C:\PreIPO\backend\tests\Feature\UserSettingsControllerTest.php" line="63" class="Tests\Feature\UserSettingsControllerTest" classname="Tests.Feature.UserSettingsControllerTest" assertions="6" time="1.261145"/>
        <testcase name="user_can_get_default_settings_when_none_exist" file="C:\PreIPO\backend\tests\Feature\UserSettingsControllerTest.php" line="41" class="Tests\Feature\UserSettingsControllerTest" classname="Tests.Feature.UserSettingsControllerTest" assertions="10" time="0.876444"/>
        <testcase name="user_can_update_preference_settings" file="C:\PreIPO\backend\tests\Feature\UserSettingsControllerTest.php" line="150" class="Tests\Feature\UserSettingsControllerTest" classname="Tests.Feature.UserSettingsControllerTest" assertions="4" time="1.058908"/>
        <testcase name="update_merges_with_existing_settings" file="C:\PreIPO\backend\tests\Feature\UserSettingsControllerTest.php" line="175" class="Tests\Feature\UserSettingsControllerTest" classname="Tests.Feature.UserSettingsControllerTest" assertions="6" time="0.866760"/>
        <testcase name="settings_timestamps_are_updated" file="C:\PreIPO\backend\tests\Feature\UserSettingsControllerTest.php" line="292" class="Tests\Feature\UserSettingsControllerTest" classname="Tests.Feature.UserSettingsControllerTest" assertions="1" time="2.472124"/>
        <testcase name="user_can_only_update_their_own_settings" file="C:\PreIPO\backend\tests\Feature\UserSettingsControllerTest.php" line="258" class="Tests\Feature\UserSettingsControllerTest" classname="Tests.Feature.UserSettingsControllerTest" assertions="3" time="0.792388"/>
        <testcase name="user_can_update_notification_settings" file="C:\PreIPO\backend\tests\Feature\UserSettingsControllerTest.php" line="98" class="Tests\Feature\UserSettingsControllerTest" classname="Tests.Feature.UserSettingsControllerTest" assertions="6" time="0.916779"/>
        <testcase name="user_cannot_access_another_users_settings" file="C:\PreIPO\backend\tests\Feature\UserSettingsControllerTest.php" line="221" class="Tests\Feature\UserSettingsControllerTest" classname="Tests.Feature.UserSettingsControllerTest" assertions="3" time="0.867285"/>
      </testsuite>
      <testsuite name="Tests\Feature\PaymentWebhookServiceTest" file="C:\PreIPO\backend\tests\Feature\PaymentWebhookServiceTest.php" tests="16" assertions="43" errors="0" failures="0" skipped="0" time="8.448446">
        <testcase name="test_handle_payment_failed_sends_notification" file="C:\PreIPO\backend\tests\Feature\PaymentWebhookServiceTest.php" line="206" class="Tests\Feature\PaymentWebhookServiceTest" classname="Tests.Feature.PaymentWebhookServiceTest" assertions="1" time="0.482977"/>
        <testcase name="test_subscription_charged_accepts_amount_with_decimal_precision" file="C:\PreIPO\backend\tests\Feature\PaymentWebhookServiceTest.php" line="533" class="Tests\Feature\PaymentWebhookServiceTest" classname="Tests.Feature.PaymentWebhookServiceTest" assertions="2" time="0.468477"/>
        <testcase name="test_webhook_handles_duplicate_events" file="C:\PreIPO\backend\tests\Feature\PaymentWebhookServiceTest.php" line="276" class="Tests\Feature\PaymentWebhookServiceTest" classname="Tests.Feature.PaymentWebhookServiceTest" assertions="1" time="0.309471"/>
        <testcase name="test_subscription_charged_rejects_mismatched_amount" file="C:\PreIPO\backend\tests\Feature\PaymentWebhookServiceTest.php" line="323" class="Tests\Feature\PaymentWebhookServiceTest" classname="Tests.Feature.PaymentWebhookServiceTest" assertions="2" time="0.309258"/>
        <testcase name="test_webhook_logs_all_events" file="C:\PreIPO\backend\tests\Feature\PaymentWebhookServiceTest.php" line="305" class="Tests\Feature\PaymentWebhookServiceTest" classname="Tests.Feature.PaymentWebhookServiceTest" assertions="1" time="0.410691"/>
        <testcase name="test_handle_payment_captured_updates_payment_status" file="C:\PreIPO\backend\tests\Feature\PaymentWebhookServiceTest.php" line="72" class="Tests\Feature\PaymentWebhookServiceTest" classname="Tests.Feature.PaymentWebhookServiceTest" assertions="2" time="1.274661"/>
        <testcase name="test_handle_refund_processed_updates_records" file="C:\PreIPO\backend\tests\Feature\PaymentWebhookServiceTest.php" line="226" class="Tests\Feature\PaymentWebhookServiceTest" classname="Tests.Feature.PaymentWebhookServiceTest" assertions="2" time="0.418848"/>
        <testcase name="test_subscription_charged_accepts_matching_amount" file="C:\PreIPO\backend\tests\Feature\PaymentWebhookServiceTest.php" line="496" class="Tests\Feature\PaymentWebhookServiceTest" classname="Tests.Feature.PaymentWebhookServiceTest" assertions="4" time="0.433563"/>
        <testcase name="test_subscription_charged_mismatch_logs_critical" file="C:\PreIPO\backend\tests\Feature\PaymentWebhookServiceTest.php" line="448" class="Tests\Feature\PaymentWebhookServiceTest" classname="Tests.Feature.PaymentWebhookServiceTest" assertions="5" time="0.397748"/>
        <testcase name="test_handle_payment_failed_updates_status" file="C:\PreIPO\backend\tests\Feature\PaymentWebhookServiceTest.php" line="178" class="Tests\Feature\PaymentWebhookServiceTest" classname="Tests.Feature.PaymentWebhookServiceTest" assertions="1" time="0.415900"/>
        <testcase name="test_subscription_charged_mismatch_does_not_create_payment" file="C:\PreIPO\backend\tests\Feature\PaymentWebhookServiceTest.php" line="356" class="Tests\Feature\PaymentWebhookServiceTest" classname="Tests.Feature.PaymentWebhookServiceTest" assertions="2" time="0.428723"/>
        <testcase name="test_pending_subscription_activates_on_first_payment_success" file="C:\PreIPO\backend\tests\Feature\PaymentWebhookServiceTest.php" line="105" class="Tests\Feature\PaymentWebhookServiceTest" classname="Tests.Feature.PaymentWebhookServiceTest" assertions="4" time="0.416506"/>
        <testcase name="test_webhook_rejects_invalid_signature" file="C:\PreIPO\backend\tests\Feature\PaymentWebhookServiceTest.php" line="264" class="Tests\Feature\PaymentWebhookServiceTest" classname="Tests.Feature.PaymentWebhookServiceTest" assertions="2" time="0.456751"/>
        <testcase name="test_subscription_charged_mismatch_does_not_mutate_subscription" file="C:\PreIPO\backend\tests\Feature\PaymentWebhookServiceTest.php" line="395" class="Tests\Feature\PaymentWebhookServiceTest" classname="Tests.Feature.PaymentWebhookServiceTest" assertions="3" time="0.404131"/>
        <testcase name="test_handle_payment_captured_triggers_allocation" file="C:\PreIPO\backend\tests\Feature\PaymentWebhookServiceTest.php" line="154" class="Tests\Feature\PaymentWebhookServiceTest" classname="Tests.Feature.PaymentWebhookServiceTest" assertions="1" time="0.289731"/>
        <testcase name="test_payment_amount_mismatch_exception_contains_correct_data" file="C:\PreIPO\backend\tests\Feature\PaymentWebhookServiceTest.php" line="561" class="Tests\Feature\PaymentWebhookServiceTest" classname="Tests.Feature.PaymentWebhookServiceTest" assertions="10" time="1.531010"/>
      </testsuite>
      <testsuite name="Tests\Feature\SubscriptionTest" file="C:\PreIPO\backend\tests\Feature\SubscriptionTest.php" tests="4" assertions="9" errors="0" failures="0" skipped="0" time="6.256065">
        <testcase name="user_can_upgrade_plan" file="C:\PreIPO\backend\tests\Feature\SubscriptionTest.php" line="56" class="Tests\Feature\SubscriptionTest" classname="Tests.Feature.SubscriptionTest" assertions="2" time="1.555930"/>
        <testcase name="user_can_create_subscription" file="C:\PreIPO\backend\tests\Feature\SubscriptionTest.php" line="33" class="Tests\Feature\SubscriptionTest" classname="Tests.Feature.SubscriptionTest" assertions="3" time="1.565302"/>
        <testcase name="user_can_pause_subscription" file="C:\PreIPO\backend\tests\Feature\SubscriptionTest.php" line="77" class="Tests\Feature\SubscriptionTest" classname="Tests.Feature.SubscriptionTest" assertions="2" time="1.555502"/>
        <testcase name="user_can_cancel_subscription" file="C:\PreIPO\backend\tests\Feature\SubscriptionTest.php" line="104" class="Tests\Feature\SubscriptionTest" classname="Tests.Feature.SubscriptionTest" assertions="2" time="1.579331"/>
      </testsuite>
      <testsuite name="Tests\Feature\UserSupportEndpointsTest" file="C:\PreIPO\backend\tests\Feature\UserSupportEndpointsTest.php" tests="8" assertions="15" errors="0" failures="3" skipped="0" time="12.433442">
        <testcase name="testUserCanAttachFilesToTicket" file="C:\PreIPO\backend\tests\Feature\UserSupportEndpointsTest.php" line="118" class="Tests\Feature\UserSupportEndpointsTest" classname="Tests.Feature.UserSupportEndpointsTest" assertions="2" time="1.646692">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\UserSupportEndpointsTest::testUserCanAttachFilesToTicket&#13;
Failed asserting that a row in the table [support_messages] matches the attributes {
    "attachments": "[\"support\\\/163\\\/proof.pdf\"]"
}.

Found: [
    {
        "attachments": "[\"support\\\/163\\\/a66b5eb3-f500-493d-bdcc-bf189d8b2d26.pdf\"]"
    }
].
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithDatabase.php:36
C:\PreIPO\backend\tests\Feature\UserSupportEndpointsTest.php:129</failure>
        </testcase>
        <testcase name="testUserCanRateTicketResolution" file="C:\PreIPO\backend\tests\Feature\UserSupportEndpointsTest.php" line="149" class="Tests\Feature\UserSupportEndpointsTest" classname="Tests.Feature.UserSupportEndpointsTest" assertions="2" time="1.566277">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\UserSupportEndpointsTest::testUserCanRateTicketResolution&#13;
Failed asserting that a row in the table [support_tickets] matches the attributes {
    "id": 164,
    "rating": 5,
    "rating_feedback": "Great service!"
}.

Found similar results: [
    {
        "id": 164,
        "rating": null,
        "rating_feedback": null
    }
].
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithDatabase.php:36
C:\PreIPO\backend\tests\Feature\UserSupportEndpointsTest.php:159</failure>
        </testcase>
        <testcase name="testUserCanCloseTicket" file="C:\PreIPO\backend\tests\Feature\UserSupportEndpointsTest.php" line="97" class="Tests\Feature\UserSupportEndpointsTest" classname="Tests.Feature.UserSupportEndpointsTest" assertions="2" time="1.521088"/>
        <testcase name="testUserCannotViewOtherUsersTickets" file="C:\PreIPO\backend\tests\Feature\UserSupportEndpointsTest.php" line="108" class="Tests\Feature\UserSupportEndpointsTest" classname="Tests.Feature.UserSupportEndpointsTest" assertions="1" time="1.546830"/>
        <testcase name="testUserReceivesNotificationOnReply" file="C:\PreIPO\backend\tests\Feature\UserSupportEndpointsTest.php" line="135" class="Tests\Feature\UserSupportEndpointsTest" classname="Tests.Feature.UserSupportEndpointsTest" assertions="1" time="1.831120">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\UserSupportEndpointsTest::testUserReceivesNotificationOnReply&#13;
Expected response status code [201] but received 500.
Failed asserting that 500 is identical to 201.&#13;
&#13;
The following exception occurred during the last request:

Error: Call to undefined method App\Http\Controllers\Api\Admin\SupportTicketController::reply() in C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\ControllerDispatcher.php:47
Stack trace:
#0 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(266): Illuminate\Routing\ControllerDispatcher-&gt;dispatch(Object(Illuminate\Routing\Route), Object(App\Http\Controllers\Api\Admin\SupportTicketController), 'reply')
#1 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Route.php(212): Illuminate\Routing\Route-&gt;runController()
#2 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(808): Illuminate\Routing\Route-&gt;run()
#3 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Routing\Router-&gt;Illuminate\Routing\{closure}(Object(Illuminate\Http\Request))
#4 C:\PreIPO\backend\app\Http\Middleware\CheckPermission.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#5 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckPermission-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'users.edit')
#6 C:\PreIPO\backend\vendor\spatie\laravel-permission\src\Middleware\RoleMiddleware.php(37): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#7 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Spatie\Permission\Middleware\RoleMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'admin|super-adm...')
#8 C:\PreIPO\backend\app\Http\Middleware\AdminIpRestriction.php(43): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#9 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\AdminIpRestriction-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#10 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Middleware\SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#11 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#12 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Auth\Middleware\Authenticate.php(64): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#13 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate-&gt;handle(Object(Illuminate\Http\Request), Object(Closure), 'sanctum')
#14 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#15 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(807): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#16 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(786): Illuminate\Routing\Router-&gt;runRouteWithinStack(Object(Illuminate\Routing\Route), Object(Illuminate\Http\Request))
#17 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(750): Illuminate\Routing\Router-&gt;runRoute(Object(Illuminate\Http\Request), Object(Illuminate\Routing\Route))
#18 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Routing\Router.php(739): Illuminate\Routing\Router-&gt;dispatchToRoute(Object(Illuminate\Http\Request))
#19 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(201): Illuminate\Routing\Router-&gt;dispatch(Object(Illuminate\Http\Request))
#20 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(170): Illuminate\Foundation\Http\Kernel-&gt;Illuminate\Foundation\Http\{closure}(Object(Illuminate\Http\Request))
#21 C:\PreIPO\backend\app\Http\Middleware\RedirectMiddleware.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#22 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\RedirectMiddleware-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#23 C:\PreIPO\backend\app\Http\Middleware\CheckMaintenanceMode.php(48): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#24 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\CheckMaintenanceMode-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#25 C:\PreIPO\backend\app\Http\Middleware\SanitizeInput.php(33): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#26 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\SanitizeInput-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#27 C:\PreIPO\backend\app\Http\Middleware\ForceHttps.php(23): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#28 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): App\Http\Middleware\ForceHttps-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#29 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#30 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#31 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#32 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#33 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#34 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TransformsRequest.php(21): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#35 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#36 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#37 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#38 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#39 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#40 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#41 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\HandleCors.php(62): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#42 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\HandleCors-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#43 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Middleware\TrustProxies.php(58): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#44 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#45 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#46 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks-&gt;handle(Object(Illuminate\Http\Request), Object(Closure))
#47 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Pipeline\Pipeline.php(127): Illuminate\Pipeline\Pipeline-&gt;Illuminate\Pipeline\{closure}(Object(Illuminate\Http\Request))
#48 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(176): Illuminate\Pipeline\Pipeline-&gt;then(Object(Closure))
#49 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php(145): Illuminate\Foundation\Http\Kernel-&gt;sendRequestThroughRouter(Object(Illuminate\Http\Request))
#50 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel-&gt;handle(Object(Illuminate\Http\Request))
#51 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(573): Illuminate\Foundation\Testing\TestCase-&gt;call('POST', '/api/v1/admin/s...', Array, Array, Array, Array, '{"message":"Thi...')
#52 C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php(411): Illuminate\Foundation\Testing\TestCase-&gt;json('POST', '/api/v1/admin/s...', Array, Array, 0)
#53 C:\PreIPO\backend\tests\Feature\UserSupportEndpointsTest.php(140): Illuminate\Foundation\Testing\TestCase-&gt;postJson('/api/v1/admin/s...', Array)
#54 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(1667): Tests\Feature\UserSupportEndpointsTest-&gt;testUserReceivesNotificationOnReply()
#55 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(519): PHPUnit\Framework\TestCase-&gt;runTest()
#56 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestRunner\TestRunner.php(87): PHPUnit\Framework\TestCase-&gt;runBare()
#57 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestCase.php(365): PHPUnit\Framework\TestRunner-&gt;run(Object(Tests\Feature\UserSupportEndpointsTest))
#58 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestCase-&gt;run()
#59 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#60 C:\PreIPO\backend\vendor\phpunit\phpunit\src\Framework\TestSuite.php(369): PHPUnit\Framework\TestSuite-&gt;run()
#61 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\TestRunner.php(64): PHPUnit\Framework\TestSuite-&gt;run()
#62 C:\PreIPO\backend\vendor\phpunit\phpunit\src\TextUI\Application.php(211): PHPUnit\TextUI\TestRunner-&gt;run(Object(PHPUnit\TextUI\Configuration\Configuration), Object(PHPUnit\Runner\ResultCache\DefaultResultCache), Object(PHPUnit\Framework\TestSuite))
#63 C:\PreIPO\backend\vendor\phpunit\phpunit\phpunit(104): PHPUnit\TextUI\Application-&gt;run(Array)
#64 {main}

----------------------------------------------------------------------------------

Call to undefined method App\Http\Controllers\Api\Admin\SupportTicketController::reply()
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\UserSupportEndpointsTest.php:144</failure>
        </testcase>
        <testcase name="testUserCanReplyToTicket" file="C:\PreIPO\backend\tests\Feature\UserSupportEndpointsTest.php" line="80" class="Tests\Feature\UserSupportEndpointsTest" classname="Tests.Feature.UserSupportEndpointsTest" assertions="2" time="1.453394"/>
        <testcase name="testUserCanCreateTicket" file="C:\PreIPO\backend\tests\Feature\UserSupportEndpointsTest.php" line="52" class="Tests\Feature\UserSupportEndpointsTest" classname="Tests.Feature.UserSupportEndpointsTest" assertions="3" time="1.434992"/>
        <testcase name="testUserCanViewOwnTickets" file="C:\PreIPO\backend\tests\Feature\UserSupportEndpointsTest.php" line="69" class="Tests\Feature\UserSupportEndpointsTest" classname="Tests.Feature.UserSupportEndpointsTest" assertions="2" time="1.433049"/>
      </testsuite>
      <testsuite name="Tests\Feature\FinalSanityTest" file="C:\PreIPO\backend\tests\Feature\FinalSanityTest.php" tests="1" assertions="2" errors="0" failures="0" skipped="0" time="0.120485">
        <testcase name="test_wallet_integer_integrity" file="C:\PreIPO\backend\tests\Feature\FinalSanityTest.php" line="23" class="Tests\Feature\FinalSanityTest" classname="Tests.Feature.FinalSanityTest" assertions="2" time="0.120485"/>
      </testsuite>
      <testsuite name="Tests\Feature\UserNotificationEndpointsTest" file="C:\PreIPO\backend\tests\Feature\UserNotificationEndpointsTest.php" tests="5" assertions="11" errors="0" failures="4" skipped="0" time="5.146012">
        <testcase name="testMarkNotificationAsRead" file="C:\PreIPO\backend\tests\Feature\UserNotificationEndpointsTest.php" line="51" class="Tests\Feature\UserNotificationEndpointsTest" classname="Tests.Feature.UserNotificationEndpointsTest" assertions="2" time="0.943494">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\UserNotificationEndpointsTest::testMarkNotificationAsRead&#13;
Expected response status code [200] but received 405.
Failed asserting that 405 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\UserNotificationEndpointsTest.php:58</failure>
        </testcase>
        <testcase name="testMarkAllNotificationsAsRead" file="C:\PreIPO\backend\tests\Feature\UserNotificationEndpointsTest.php" line="63" class="Tests\Feature\UserNotificationEndpointsTest" classname="Tests.Feature.UserNotificationEndpointsTest" assertions="3" time="1.063155"/>
        <testcase name="testGetNotificationsReturnsUserNotifications" file="C:\PreIPO\backend\tests\Feature\UserNotificationEndpointsTest.php" line="39" class="Tests\Feature\UserNotificationEndpointsTest" classname="Tests.Feature.UserNotificationEndpointsTest" assertions="2" time="1.059179">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\UserNotificationEndpointsTest::testGetNotificationsReturnsUserNotifications&#13;
Failed to assert that the response count matched the expected 2
Failed asserting that actual size 13 matches expected size 2.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\AssertableJsonString.php:73
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:940
C:\PreIPO\backend\tests\Feature\UserNotificationEndpointsTest.php:47</failure>
        </testcase>
        <testcase name="testDeleteNotification" file="C:\PreIPO\backend\tests\Feature\UserNotificationEndpointsTest.php" line="77" class="Tests\Feature\UserNotificationEndpointsTest" classname="Tests.Feature.UserNotificationEndpointsTest" assertions="2" time="0.993881">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\UserNotificationEndpointsTest::testDeleteNotification&#13;
Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\UserNotificationEndpointsTest.php:84</failure>
        </testcase>
        <testcase name="testNotificationsPaginated" file="C:\PreIPO\backend\tests\Feature\UserNotificationEndpointsTest.php" line="89" class="Tests\Feature\UserNotificationEndpointsTest" classname="Tests.Feature.UserNotificationEndpointsTest" assertions="2" time="1.086302">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\UserNotificationEndpointsTest::testNotificationsPaginated&#13;
Failed to assert that the response count matched the expected 20
Failed asserting that actual size 13 matches expected size 20.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\AssertableJsonString.php:73
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:940
C:\PreIPO\backend\tests\Feature\UserNotificationEndpointsTest.php:99</failure>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\PermissionMiddlewareTest" file="C:\PreIPO\backend\tests\Feature\PermissionMiddlewareTest.php" tests="4" assertions="4" errors="2" failures="0" skipped="0" time="5.425586">
        <testcase name="test_permission_blocks_unauthorized_user" file="C:\PreIPO\backend\tests\Feature\PermissionMiddlewareTest.php" line="42" class="Tests\Feature\PermissionMiddlewareTest" classname="Tests.Feature.PermissionMiddlewareTest" assertions="2" time="1.524954"/>
        <testcase name="test_permission_allows_authorized_user" file="C:\PreIPO\backend\tests\Feature\PermissionMiddlewareTest.php" line="32" class="Tests\Feature\PermissionMiddlewareTest" classname="Tests.Feature.PermissionMiddlewareTest" assertions="1" time="1.387759"/>
        <testcase name="test_permission_checks_granular_permissions" file="C:\PreIPO\backend\tests\Feature\PermissionMiddlewareTest.php" line="53" class="Tests\Feature\PermissionMiddlewareTest" classname="Tests.Feature.PermissionMiddlewareTest" assertions="0" time="1.365328">
          <error type="BadMethodCallException">Tests\Feature\PermissionMiddlewareTest::test_permission_checks_granular_permissions&#13;
BadMethodCallException: Call to undefined method App\Models\User::removePermissionTo()
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:67
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\tests\Feature\PermissionMiddlewareTest.php:56</error>
        </testcase>
        <testcase name="test_permission_logs_unauthorized_attempts" file="C:\PreIPO\backend\tests\Feature\PermissionMiddlewareTest.php" line="75" class="Tests\Feature\PermissionMiddlewareTest" classname="Tests.Feature.PermissionMiddlewareTest" assertions="1" time="1.147545">
          <error type="Mockery\Exception\BadMethodCallException">Tests\Feature\PermissionMiddlewareTest::test_permission_logs_unauthorized_attempts&#13;
Mockery\Exception\BadMethodCallException: Received Mockery_7_Illuminate_Log_LogManager::error(), but no expectations were specified
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Exceptions\Handler.php:380
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Exceptions\Handler.php:343
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php:563
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Http\Kernel.php:147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php:607
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php:573
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\MakesHttpRequests.php:381
C:\PreIPO\backend\tests\Feature\PermissionMiddlewareTest.php:86</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\BonusTdsIntegrationTest" file="C:\PreIPO\backend\tests\Feature\BonusTdsIntegrationTest.php" tests="7" assertions="3" errors="6" failures="0" skipped="0" time="7.270863">
        <testcase name="wallet_credits_net_amount_after_tds" file="C:\PreIPO\backend\tests\Feature\BonusTdsIntegrationTest.php" line="233" class="Tests\Feature\BonusTdsIntegrationTest" classname="Tests.Feature.BonusTdsIntegrationTest" assertions="0" time="0.936253">
          <error type="RuntimeException">Tests\Feature\BonusTdsIntegrationTest::wallet_credits_net_amount_after_tds&#13;
RuntimeException: Payment #4974 has NULL amount_paise. Float fallback is PROHIBITED. Data integrity violation.
&#13;
C:\PreIPO\backend\app\Models\Payment.php:495
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:804
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:741
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:670
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\BonusTdsIntegrationTest.php:408
C:\PreIPO\backend\tests\Feature\BonusTdsIntegrationTest.php:238</error>
        </testcase>
        <testcase name="tds_correctly_deducted_for_bonus_above_threshold" file="C:\PreIPO\backend\tests\Feature\BonusTdsIntegrationTest.php" line="159" class="Tests\Feature\BonusTdsIntegrationTest" classname="Tests.Feature.BonusTdsIntegrationTest" assertions="0" time="1.014338">
          <error type="Illuminate\Database\QueryException">Tests\Feature\BonusTdsIntegrationTest::tds_correctly_deducted_for_bonus_above_threshold&#13;
Illuminate\Database\QueryException: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'consistency_bonus' in 'field list' (Connection: mysql, SQL: insert into `plans` (`name`, `slug`, `razorpay_plan_id`, `monthly_amount`, `duration_months`, `description`, `is_active`, `is_featured`, `display_order`, `available_from`, `available_until`, `max_subscriptions_per_user`, `allow_pause`, `max_pause_count`, `max_pause_duration_months`, `consistency_bonus`, `updated_at`, `created_at`) values (Diamond SIP 69974857, diamond-sip-69974857, plan_uhgsogltgd, 100000, 12, Nulla laboriosam molestiae fugit necessitatibus excepturi. Et officiis odit consequatur qui maxime error. Laudantium sunt aspernatur architecto eligendi., 1, 0, 2, 2025-08-22 10:36:18, ?, 3, 1, 3, 3, 15000, 2026-02-22 10:36:18, 2026-02-22 10:36:18))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
C:\PreIPO\backend\tests\Feature\BonusTdsIntegrationTest.php:162</error>
        </testcase>
        <testcase name="tds_not_deducted_for_bonus_below_threshold" file="C:\PreIPO\backend\tests\Feature\BonusTdsIntegrationTest.php" line="127" class="Tests\Feature\BonusTdsIntegrationTest" classname="Tests.Feature.BonusTdsIntegrationTest" assertions="0" time="1.074823">
          <error type="RuntimeException">Tests\Feature\BonusTdsIntegrationTest::tds_not_deducted_for_bonus_below_threshold&#13;
RuntimeException: Payment #4980 has NULL amount_paise. Float fallback is PROHIBITED. Data integrity violation.
&#13;
C:\PreIPO\backend\app\Models\Payment.php:495
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:804
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:741
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:670
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\BonusTdsIntegrationTest.php:408
C:\PreIPO\backend\tests\Feature\BonusTdsIntegrationTest.php:130</error>
        </testcase>
        <testcase name="ledger_contains_gross_and_tds_entries" file="C:\PreIPO\backend\tests\Feature\BonusTdsIntegrationTest.php" line="263" class="Tests\Feature\BonusTdsIntegrationTest" classname="Tests.Feature.BonusTdsIntegrationTest" assertions="0" time="0.995570">
          <error type="RuntimeException">Tests\Feature\BonusTdsIntegrationTest::ledger_contains_gross_and_tds_entries&#13;
RuntimeException: Payment #4981 has NULL amount_paise. Float fallback is PROHIBITED. Data integrity violation.
&#13;
C:\PreIPO\backend\app\Models\Payment.php:495
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:804
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:741
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:670
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\BonusTdsIntegrationTest.php:408
C:\PreIPO\backend\tests\Feature\BonusTdsIntegrationTest.php:268</error>
        </testcase>
        <testcase name="bonus_transaction_creates_balanced_ledger_entries" file="C:\PreIPO\backend\tests\Feature\BonusTdsIntegrationTest.php" line="86" class="Tests\Feature\BonusTdsIntegrationTest" classname="Tests.Feature.BonusTdsIntegrationTest" assertions="0" time="1.077397">
          <error type="RuntimeException">Tests\Feature\BonusTdsIntegrationTest::bonus_transaction_creates_balanced_ledger_entries&#13;
RuntimeException: Payment #4983 has NULL amount_paise. Float fallback is PROHIBITED. Data integrity violation.
&#13;
C:\PreIPO\backend\app\Models\Payment.php:495
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:804
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:741
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:670
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\BonusTdsIntegrationTest.php:408
C:\PreIPO\backend\tests\Feature\BonusTdsIntegrationTest.php:89</error>
        </testcase>
        <testcase name="bonus_calculations_have_no_rounding_drift" file="C:\PreIPO\backend\tests\Feature\BonusTdsIntegrationTest.php" line="301" class="Tests\Feature\BonusTdsIntegrationTest" classname="Tests.Feature.BonusTdsIntegrationTest" assertions="0" time="1.285673">
          <error type="RuntimeException">Tests\Feature\BonusTdsIntegrationTest::bonus_calculations_have_no_rounding_drift&#13;
RuntimeException: Payment #4987 has NULL amount_paise. Float fallback is PROHIBITED. Data integrity violation.
&#13;
C:\PreIPO\backend\app\Models\Payment.php:495
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:804
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:741
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Concerns\ManagesTransactions.php:32
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\DatabaseManager.php:495
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:670
C:\PreIPO\backend\app\Services\PaymentWebhookService.php:82
C:\PreIPO\backend\tests\Feature\BonusTdsIntegrationTest.php:315</error>
        </testcase>
        <testcase name="tds_exemption_at_exact_threshold_boundary" file="C:\PreIPO\backend\tests\Feature\BonusTdsIntegrationTest.php" line="373" class="Tests\Feature\BonusTdsIntegrationTest" classname="Tests.Feature.BonusTdsIntegrationTest" assertions="3" time="0.886810"/>
      </testsuite>
      <testsuite name="Tests\Feature\ChargebackIntegrationTest" file="C:\PreIPO\backend\tests\Feature\ChargebackIntegrationTest.php" tests="22" assertions="112" errors="0" failures="0" skipped="0" time="19.316442">
        <testcase name="test_chargeback_confirmation_replay_is_idempotent" file="C:\PreIPO\backend\tests\Feature\ChargebackIntegrationTest.php" line="104" class="Tests\Feature\ChargebackIntegrationTest" classname="Tests.Feature.ChargebackIntegrationTest" assertions="3" time="0.438264"/>
        <testcase name="test_chargeback_exceeding_refundable_amount_is_rejected" file="C:\PreIPO\backend\tests\Feature\ChargebackIntegrationTest.php" line="559" class="Tests\Feature\ChargebackIntegrationTest" classname="Tests.Feature.ChargebackIntegrationTest" assertions="2" time="0.267354"/>
        <testcase name="test_wallet_liability_mirror_with_receivable" file="C:\PreIPO\backend\tests\Feature\ChargebackIntegrationTest.php" line="1369" class="Tests\Feature\ChargebackIntegrationTest" classname="Tests.Feature.ChargebackIntegrationTest" assertions="4" time="0.362403"/>
        <testcase name="test_chargeback_replay_same_gateway_id_is_idempotent" file="C:\PreIPO\backend\tests\Feature\ChargebackIntegrationTest.php" line="65" class="Tests\Feature\ChargebackIntegrationTest" classname="Tests.Feature.ChargebackIntegrationTest" assertions="5" time="0.323327"/>
        <testcase name="test_chargeback_state_transitions_are_enforced" file="C:\PreIPO\backend\tests\Feature\ChargebackIntegrationTest.php" line="653" class="Tests\Feature\ChargebackIntegrationTest" classname="Tests.Feature.ChargebackIntegrationTest" assertions="6" time="0.397669"/>
        <testcase name="test_raw_db_ledger_symmetry_assertion" file="C:\PreIPO\backend\tests\Feature\ChargebackIntegrationTest.php" line="690" class="Tests\Feature\ChargebackIntegrationTest" classname="Tests.Feature.ChargebackIntegrationTest" assertions="4" time="0.429428"/>
        <testcase name="test_chargeback_within_refundable_amount_succeeds" file="C:\PreIPO\backend\tests\Feature\ChargebackIntegrationTest.php" line="590" class="Tests\Feature\ChargebackIntegrationTest" classname="Tests.Feature.ChargebackIntegrationTest" assertions="1" time="0.453440"/>
        <testcase name="test_chargeback_creates_receivable_when_wallet_insufficient" file="C:\PreIPO\backend\tests\Feature\ChargebackIntegrationTest.php" line="234" class="Tests\Feature\ChargebackIntegrationTest" classname="Tests.Feature.ChargebackIntegrationTest" assertions="15" time="0.509308"/>
        <testcase name="test_refund_creates_ledger_entries_and_credits_wallet" file="C:\PreIPO\backend\tests\Feature\ChargebackIntegrationTest.php" line="1202" class="Tests\Feature\ChargebackIntegrationTest" classname="Tests.Feature.ChargebackIntegrationTest" assertions="10" time="0.543678"/>
        <testcase name="test_wallet_liability_mirror_without_receivable" file="C:\PreIPO\backend\tests\Feature\ChargebackIntegrationTest.php" line="1319" class="Tests\Feature\ChargebackIntegrationTest" classname="Tests.Feature.ChargebackIntegrationTest" assertions="2" time="0.531945"/>
        <testcase name="test_duplicate_webhook_concurrency_protection" file="C:\PreIPO\backend\tests\Feature\ChargebackIntegrationTest.php" line="1070" class="Tests\Feature\ChargebackIntegrationTest" classname="Tests.Feature.ChargebackIntegrationTest" assertions="5" time="0.478690"/>
        <testcase name="test_ledger_balanced_after_chargeback" file="C:\PreIPO\backend\tests\Feature\ChargebackIntegrationTest.php" line="435" class="Tests\Feature\ChargebackIntegrationTest" classname="Tests.Feature.ChargebackIntegrationTest" assertions="6" time="0.441474"/>
        <testcase name="test_chargeback_ledger_entry_has_correct_accounts" file="C:\PreIPO\backend\tests\Feature\ChargebackIntegrationTest.php" line="495" class="Tests\Feature\ChargebackIntegrationTest" classname="Tests.Feature.ChargebackIntegrationTest" assertions="5" time="1.126857"/>
        <testcase name="test_refund_after_chargeback_confirmed_is_rejected" file="C:\PreIPO\backend\tests\Feature\ChargebackIntegrationTest.php" line="191" class="Tests\Feature\ChargebackIntegrationTest" classname="Tests.Feature.ChargebackIntegrationTest" assertions="3" time="0.895773"/>
        <testcase name="test_full_investment_chargeback_creates_full_receivable" file="C:\PreIPO\backend\tests\Feature\ChargebackIntegrationTest.php" line="848" class="Tests\Feature\ChargebackIntegrationTest" classname="Tests.Feature.ChargebackIntegrationTest" assertions="8" time="1.034198"/>
        <testcase name="test_wallet_liability_mirror_partial_receivable" file="C:\PreIPO\backend\tests\Feature\ChargebackIntegrationTest.php" line="1477" class="Tests\Feature\ChargebackIntegrationTest" classname="Tests.Feature.ChargebackIntegrationTest" assertions="4" time="2.780619"/>
        <testcase name="test_unique_constraint_on_chargeback_gateway_id" file="C:\PreIPO\backend\tests\Feature\ChargebackIntegrationTest.php" line="625" class="Tests\Feature\ChargebackIntegrationTest" classname="Tests.Feature.ChargebackIntegrationTest" assertions="1" time="1.736724"/>
        <testcase name="test_chargeback_uses_wallet_service_not_direct_mutation" file="C:\PreIPO\backend\tests\Feature\ChargebackIntegrationTest.php" line="1144" class="Tests\Feature\ChargebackIntegrationTest" classname="Tests.Feature.ChargebackIntegrationTest" assertions="3" time="2.134026"/>
        <testcase name="test_full_lifecycle_deposit_chargeback_unwinds_to_zero" file="C:\PreIPO\backend\tests\Feature\ChargebackIntegrationTest.php" line="770" class="Tests\Feature\ChargebackIntegrationTest" classname="Tests.Feature.ChargebackIntegrationTest" assertions="7" time="1.133710"/>
        <testcase name="test_partial_investment_chargeback_scenario" file="C:\PreIPO\backend\tests\Feature\ChargebackIntegrationTest.php" line="948" class="Tests\Feature\ChargebackIntegrationTest" classname="Tests.Feature.ChargebackIntegrationTest" assertions="11" time="1.089185"/>
        <testcase name="test_chargeback_after_full_refund_is_rejected" file="C:\PreIPO\backend\tests\Feature\ChargebackIntegrationTest.php" line="149" class="Tests\Feature\ChargebackIntegrationTest" classname="Tests.Feature.ChargebackIntegrationTest" assertions="3" time="1.106046"/>
        <testcase name="test_chargeback_succeeds_when_wallet_has_sufficient_balance" file="C:\PreIPO\backend\tests\Feature\ChargebackIntegrationTest.php" line="385" class="Tests\Feature\ChargebackIntegrationTest" classname="Tests.Feature.ChargebackIntegrationTest" assertions="4" time="1.102325"/>
      </testsuite>
      <testsuite name="Tests\Feature\SocialLoginReferralTest" file="C:\PreIPO\backend\tests\Feature\SocialLoginReferralTest.php" tests="4" assertions="4" errors="0" failures="4" skipped="0" time="8.729419">
        <testcase name="it_can_process_referral_code_during_google_login" file="C:\PreIPO\backend\tests\Feature\SocialLoginReferralTest.php" line="21" class="Tests\Feature\SocialLoginReferralTest" classname="Tests.Feature.SocialLoginReferralTest" assertions="1" time="5.180288">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\SocialLoginReferralTest::it_can_process_referral_code_during_google_login&#13;
Failed asserting that false is true.
&#13;
C:\PreIPO\backend\tests\Feature\SocialLoginReferralTest.php:45</failure>
        </testcase>
        <testcase name="it_prevents_self_referral" file="C:\PreIPO\backend\tests\Feature\SocialLoginReferralTest.php" line="94" class="Tests\Feature\SocialLoginReferralTest" classname="Tests.Feature.SocialLoginReferralTest" assertions="1" time="2.073020">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\SocialLoginReferralTest::it_prevents_self_referral&#13;
Failed asserting that false is true.
&#13;
C:\PreIPO\backend\tests\Feature\SocialLoginReferralTest.php:119</failure>
        </testcase>
        <testcase name="google_redirect_includes_referral_code_in_state" file="C:\PreIPO\backend\tests\Feature\SocialLoginReferralTest.php" line="128" class="Tests\Feature\SocialLoginReferralTest" classname="Tests.Feature.SocialLoginReferralTest" assertions="1" time="0.451226">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\SocialLoginReferralTest::google_redirect_includes_referral_code_in_state&#13;
Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\SocialLoginReferralTest.php:132</failure>
        </testcase>
        <testcase name="it_handles_invalid_referral_code_gracefully" file="C:\PreIPO\backend\tests\Feature\SocialLoginReferralTest.php" line="63" class="Tests\Feature\SocialLoginReferralTest" classname="Tests.Feature.SocialLoginReferralTest" assertions="1" time="1.024885">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\SocialLoginReferralTest::it_handles_invalid_referral_code_gracefully&#13;
Failed asserting that false is true.
&#13;
C:\PreIPO\backend\tests\Feature\SocialLoginReferralTest.php:82</failure>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\ServiceIntegrationTest" file="C:\PreIPO\backend\tests\Feature\ServiceIntegrationTest.php" tests="7" assertions="13" errors="0" failures="0" skipped="0" time="7.491943">
        <testcase name="test_settings_service_invalidates_cache_on_update" file="C:\PreIPO\backend\tests\Feature\ServiceIntegrationTest.php" line="176" class="Tests\Feature\ServiceIntegrationTest" classname="Tests.Feature.ServiceIntegrationTest" assertions="3" time="1.060766"/>
        <testcase name="test_payment_webhook_service_triggers_bonus_and_allocation" file="C:\PreIPO\backend\tests\Feature\ServiceIntegrationTest.php" line="43" class="Tests\Feature\ServiceIntegrationTest" classname="Tests.Feature.ServiceIntegrationTest" assertions="1" time="1.144367"/>
        <testcase name="test_file_upload_service_scans_for_viruses" file="C:\PreIPO\backend\tests\Feature\ServiceIntegrationTest.php" line="131" class="Tests\Feature\ServiceIntegrationTest" classname="Tests.Feature.ServiceIntegrationTest" assertions="2" time="1.114302"/>
        <testcase name="test_email_service_queues_for_async_delivery" file="C:\PreIPO\backend\tests\Feature\ServiceIntegrationTest.php" line="71" class="Tests\Feature\ServiceIntegrationTest" classname="Tests.Feature.ServiceIntegrationTest" assertions="1" time="1.045311"/>
        <testcase name="test_file_upload_service_validates_file_types" file="C:\PreIPO\backend\tests\Feature\ServiceIntegrationTest.php" line="119" class="Tests\Feature\ServiceIntegrationTest" classname="Tests.Feature.ServiceIntegrationTest" assertions="2" time="1.128456"/>
        <testcase name="test_subscription_service_calculates_upgrade_differential" file="C:\PreIPO\backend\tests\Feature\ServiceIntegrationTest.php" line="91" class="Tests\Feature\ServiceIntegrationTest" classname="Tests.Feature.ServiceIntegrationTest" assertions="2" time="0.995386"/>
        <testcase name="test_file_upload_service_encrypts_sensitive_files" file="C:\PreIPO\backend\tests\Feature\ServiceIntegrationTest.php" line="147" class="Tests\Feature\ServiceIntegrationTest" classname="Tests.Feature.ServiceIntegrationTest" assertions="2" time="1.003354"/>
      </testsuite>
      <testsuite name="Tests\Feature\ReferralTest" file="C:\PreIPO\backend\tests\Feature\ReferralTest.php" tests="2" assertions="0" errors="2" failures="0" skipped="0" time="0.000000">
        <testcase name="multiplier_increases_to_tier_2_at_5_referrals" file="C:\PreIPO\backend\tests\Feature\ReferralTest.php" line="57" class="Tests\Feature\ReferralTest" classname="Tests.Feature.ReferralTest" assertions="0" time="0.000000">
          <error type="Illuminate\Database\QueryException">Tests\Feature\ReferralTest::multiplier_increases_to_tier_2_at_5_referrals&#13;
Illuminate\Database\QueryException: SQLSTATE[23000]: Integrity constraint violation: 1452 Cannot add or update a child row: a foreign key constraint fails (`preipo_test`.`subscriptions`, CONSTRAINT `subscriptions_plan_id_foreign` FOREIGN KEY (`plan_id`) REFERENCES `plans` (`id`)) (Connection: mysql, SQL: insert into `subscriptions` (`user_id`, `plan_id`, `amount`, `subscription_code`, `status`, `start_date`, `end_date`, `next_payment_date`, `bonus_multiplier`, `consecutive_payments_count`, `pause_count`, `is_auto_debit`, `bonus_contract_snapshot`, `updated_at`, `created_at`) values (16933, 1, 2500.00, SUB-66KIPCJSXS, active, 2025-04-01 01:11:33, 2027-04-01 01:11:33, 2026-02-27 10:36:59, 1, 0, 0, 0, ?, 2026-02-22 10:36:59, 2026-02-22 10:36:59))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
C:\PreIPO\backend\tests\Feature\ReferralTest.php:25</error>
        </testcase>
        <testcase name="multiplier_increases_when_referrals_complete" file="C:\PreIPO\backend\tests\Feature\ReferralTest.php" line="33" class="Tests\Feature\ReferralTest" classname="Tests.Feature.ReferralTest" assertions="0" time="0.000000">
          <error type="Illuminate\Database\QueryException">Tests\Feature\ReferralTest::multiplier_increases_when_referrals_complete&#13;
Illuminate\Database\QueryException: SQLSTATE[23000]: Integrity constraint violation: 1452 Cannot add or update a child row: a foreign key constraint fails (`preipo_test`.`subscriptions`, CONSTRAINT `subscriptions_plan_id_foreign` FOREIGN KEY (`plan_id`) REFERENCES `plans` (`id`)) (Connection: mysql, SQL: insert into `subscriptions` (`user_id`, `plan_id`, `amount`, `subscription_code`, `status`, `start_date`, `end_date`, `next_payment_date`, `bonus_multiplier`, `consecutive_payments_count`, `pause_count`, `is_auto_debit`, `bonus_contract_snapshot`, `updated_at`, `created_at`) values (16935, 1, 2500.00, SUB-KYVUACV7K6, active, 2025-05-13 21:14:56, 2027-05-13 21:14:56, 2026-02-27 10:36:59, 1, 0, 0, 0, ?, 2026-02-22 10:36:59, 2026-02-22 10:36:59))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
C:\PreIPO\backend\tests\Feature\ReferralTest.php:25</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Feature\AdminUserControllerTest" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" tests="39" assertions="92" errors="1" failures="17" skipped="0" time="39.007392">
        <testcase name="import_validates_csv_headers" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="668" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="1" time="0.976320">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AdminUserControllerTest::import_validates_csv_headers&#13;
Expected response status code [422] but received 403.
Failed asserting that 403 is identical to 422.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php:680</failure>
        </testcase>
        <testcase name="admin_can_search_users_by_username" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="60" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="3" time="0.988998"/>
        <testcase name="suspend_logs_activity" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="411" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="2" time="0.918140"/>
        <testcase name="admin_can_bulk_suspend_users" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="590" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="3" time="0.996116"/>
        <testcase name="import_validates_email_format" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="703" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="1" time="0.869169">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AdminUserControllerTest::import_validates_email_format&#13;
Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php:715</failure>
        </testcase>
        <testcase name="admin_can_suspend_user_with_reason" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="386" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="2" time="0.806018"/>
        <testcase name="block_logs_activity_with_reason" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="429" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="4" time="0.790059"/>
        <testcase name="admin_can_bulk_activate_users" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="567" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="4" time="1.067600"/>
        <testcase name="show_returns_controlled_response" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="138" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="4" time="1.079217">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AdminUserControllerTest::show_returns_controlled_response&#13;
Failed asserting that an array does not have the key 'transactions'.
&#13;
C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php:156</failure>
        </testcase>
        <testcase name="admin_can_update_user_profile_fields" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="339" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="2" time="1.065166"/>
        <testcase name="unsuspend_logs_activity" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="472" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="2" time="0.981259"/>
        <testcase name="import_validates_mobile_format" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="721" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="1" time="1.524064">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AdminUserControllerTest::import_validates_mobile_format&#13;
Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php:733</failure>
        </testcase>
        <testcase name="admin_can_view_user_details" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="105" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="10" time="1.559617"/>
        <testcase name="bulk_bonus_validates_amount" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="635" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="2" time="1.488958"/>
        <testcase name="admin_can_search_users_by_email" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="75" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="3" time="0.782619"/>
        <testcase name="suspend_requires_reason" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="401" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="3" time="0.859360"/>
        <testcase name="show_masks_sensitive_data" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="125" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="2" time="0.809465">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AdminUserControllerTest::show_masks_sensitive_data&#13;
Failed asserting that null matches expected '****234F'.
&#13;
C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php:134</failure>
        </testcase>
        <testcase name="force_payment_logs_activity" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="489" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="4" time="0.997844"/>
        <testcase name="debit_fails_for_insufficient_balance" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="552" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="2" time="1.008206">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AdminUserControllerTest::debit_fails_for_insufficient_balance&#13;
Unable to find JSON: &#13;
&#13;
[{
    "message": "Insufficient funds. Available: 5000"
}]&#13;
&#13;
within response JSON:&#13;
&#13;
[{
    "message": "SQLSTATE[23000]: Integrity constraint violation: 4025 CONSTRAINT `balance_paise_must_be_positive` failed for `preipo_test`.`wallets` (Connection: mysql, SQL: update `wallets` set `balance_paise` = `balance_paise` - 1000000, `wallets`.`updated_at` = 2026-02-22 10:37:19 where `id` = 18317)"
}].&#13;
&#13;

Failed asserting that an array has the subset Array &amp;0 [
    'message' =&gt; 'Insufficient funds. Available: 5000',
].
--- Expected
+++ Actual
@@ @@
 array (
-  'message' =&gt; 'Insufficient funds. Available: 5000',
+  'message' =&gt; 'SQLSTATE[23000]: Integrity constraint violation: 4025 CONSTRAINT `balance_paise_must_be_positive` failed for `preipo_test`.`wallets` (Connection: mysql, SQL: update `wallets` set `balance_paise` = `balance_paise` - 1000000, `wallets`.`updated_at` = 2026-02-22 10:37:19 where `id` = 18317)',
 )
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\Constraints\ArraySubset.php:81
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\Assert.php:36
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\AssertableJsonString.php:318
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:767
C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php:562</failure>
        </testcase>
        <testcase name="store_validates_mobile_format" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="269" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="1" time="0.956974">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AdminUserControllerTest::store_validates_mobile_format&#13;
Expected response status code [422] but received 403.
Failed asserting that 403 is identical to 422.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php:282</failure>
        </testcase>
        <testcase name="admin_can_import_users_from_csv" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="650" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="1" time="1.031392">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AdminUserControllerTest::admin_can_import_users_from_csv&#13;
Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php:662</failure>
        </testcase>
        <testcase name="import_skips_duplicate_users" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="685" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="1" time="1.014391">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AdminUserControllerTest::import_skips_duplicate_users&#13;
Expected response status code [200] but received 403.
Failed asserting that 403 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php:697</failure>
        </testcase>
        <testcase name="unauthenticated_user_cannot_list_users" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="87" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="1" time="0.916197"/>
        <testcase name="admin_can_export_users_to_csv" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="740" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="1" time="0.987415">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AdminUserControllerTest::admin_can_export_users_to_csv&#13;
Expected response status code [200] but received 404.
Failed asserting that 404 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php:745</failure>
        </testcase>
        <testcase name="unblock_logs_activity" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="455" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="2" time="1.010460"/>
        <testcase name="update_validates_unique_email_on_change" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="362" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="4" time="0.976991"/>
        <testcase name="update_validates_status_enum" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="326" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="3" time="0.983404"/>
        <testcase name="show_returns_stats_summary" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="160" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="0" time="0.931389">
          <error type="Illuminate\Database\QueryException">Tests\Feature\AdminUserControllerTest::show_returns_stats_summary&#13;
Illuminate\Database\QueryException: SQLSTATE[23000]: Integrity constraint violation: 1452 Cannot add or update a child row: a foreign key constraint fails (`preipo_test`.`bonus_transactions`, CONSTRAINT `bonus_transactions_subscription_id_foreign` FOREIGN KEY (`subscription_id`) REFERENCES `subscriptions` (`id`) ON DELETE CASCADE) (Connection: mysql, SQL: insert into `bonus_transactions` (`user_id`, `subscription_id`, `payment_id`, `type`, `amount`, `multiplier_applied`, `tds_deducted`, `updated_at`, `created_at`) values (17111, 1, 1, consistency, 100, 1, 0, 2026-02-22 10:37:27, 2026-02-22 10:37:27))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php:162</error>
        </testcase>
        <testcase name="admin_can_bulk_award_bonus" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="613" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="3" time="1.028876"/>
        <testcase name="store_creates_associated_records" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="287" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="1" time="0.879928">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AdminUserControllerTest::store_creates_associated_records&#13;
Expected response status code [201] but received 403.
Failed asserting that 403 is identical to 201.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php:300</failure>
        </testcase>
        <testcase name="store_validates_unique_username" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="207" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="1" time="0.770666">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AdminUserControllerTest::store_validates_unique_username&#13;
Expected response status code [422] but received 403.
Failed asserting that 403 is identical to 422.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php:220</failure>
        </testcase>
        <testcase name="admin_can_list_users" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="44" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="9" time="0.815110"/>
        <testcase name="admin_can_debit_user_wallet" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="538" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="1" time="0.994226">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AdminUserControllerTest::admin_can_debit_user_wallet&#13;
Expected response status code [200] but received 400.
Failed asserting that 400 is identical to 200.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php:547</failure>
        </testcase>
        <testcase name="regular_user_cannot_list_users" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="95" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="1" time="1.055419"/>
        <testcase name="store_validates_unique_mobile" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="251" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="1" time="0.995572">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AdminUserControllerTest::store_validates_unique_mobile&#13;
Expected response status code [422] but received 403.
Failed asserting that 403 is identical to 422.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php:264</failure>
        </testcase>
        <testcase name="admin_can_credit_user_wallet" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="524" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="2" time="0.992136">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AdminUserControllerTest::admin_can_credit_user_wallet&#13;
Failed asserting that 1000 matches expected 6000.
&#13;
C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php:534</failure>
        </testcase>
        <testcase name="admin_can_create_user" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="186" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="1" time="0.996422">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AdminUserControllerTest::admin_can_create_user&#13;
Expected response status code [201] but received 403.
Failed asserting that 403 is identical to 201.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php:199</failure>
        </testcase>
        <testcase name="store_validates_unique_email" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="226" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="1" time="0.957537">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Feature\AdminUserControllerTest::store_validates_unique_email&#13;
Expected response status code [422] but received 403.
Failed asserting that 403 is identical to 422.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponseAssert.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\TestResponse.php:160
C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php:239</failure>
        </testcase>
        <testcase name="admin_can_update_user_status" file="C:\PreIPO\backend\tests\Feature\AdminUserControllerTest.php" line="311" class="Tests\Feature\AdminUserControllerTest" classname="Tests.Feature.AdminUserControllerTest" assertions="2" time="1.144693"/>
      </testsuite>
    </testsuite>
    <testsuite name="Unit" tests="463" assertions="665" errors="142" failures="45" skipped="0" time="109.170382">
      <testsuite name="Tests\Unit\LoggingSecurityTest" file="C:\PreIPO\backend\tests\Unit\LoggingSecurityTest.php" tests="1" assertions="2" errors="0" failures="0" skipped="0" time="0.119690">
        <testcase name="testSensitiveDataNotInLogs" file="C:\PreIPO\backend\tests\Unit\LoggingSecurityTest.php" line="13" class="Tests\Unit\LoggingSecurityTest" classname="Tests.Unit.LoggingSecurityTest" assertions="2" time="0.119690"/>
      </testsuite>
      <testsuite name="Tests\Unit\SettingHelperTest" file="C:\PreIPO\backend\tests\Unit\SettingHelperTest.php" tests="8" assertions="18" errors="0" failures="2" skipped="0" time="3.160210">
        <testcase name="test_setting_tracks_updated_by_admin" file="C:\PreIPO\backend\tests\Unit\SettingHelperTest.php" line="116" class="Tests\Unit\SettingHelperTest" classname="Tests.Unit.SettingHelperTest" assertions="1" time="0.309096">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\SettingHelperTest::test_setting_tracks_updated_by_admin&#13;
Failed asserting that a row in the table [settings] matches the attributes {
    "key": "admin_track",
    "updated_by": 17158
}.

Found similar results: [
    {
        "key": "admin_track",
        "updated_by": null
    }
].
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithDatabase.php:36
C:\PreIPO\backend\tests\Unit\SettingHelperTest.php:126</failure>
        </testcase>
        <testcase name="test_helper_invalidates_cache_on_update" file="C:\PreIPO\backend\tests\Unit\SettingHelperTest.php" line="98" class="Tests\Unit\SettingHelperTest" classname="Tests.Unit.SettingHelperTest" assertions="2" time="0.507618">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\SettingHelperTest::test_helper_invalidates_cache_on_update&#13;
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
-'new_value'
+'old_value'
&#13;
C:\PreIPO\backend\tests\Unit\SettingHelperTest.php:113</failure>
        </testcase>
        <testcase name="test_setting_returns_default_if_not_found" file="C:\PreIPO\backend\tests\Unit\SettingHelperTest.php" line="69" class="Tests\Unit\SettingHelperTest" classname="Tests.Unit.SettingHelperTest" assertions="1" time="0.396916"/>
        <testcase name="test_setting_key_is_unique" file="C:\PreIPO\backend\tests\Unit\SettingHelperTest.php" line="29" class="Tests\Unit\SettingHelperTest" classname="Tests.Unit.SettingHelperTest" assertions="1" time="0.379362"/>
        <testcase name="test_setting_type_enum_validates" file="C:\PreIPO\backend\tests\Unit\SettingHelperTest.php" line="52" class="Tests\Unit\SettingHelperTest" classname="Tests.Unit.SettingHelperTest" assertions="2" time="0.384964"/>
        <testcase name="test_helper_caches_frequently_accessed_settings" file="C:\PreIPO\backend\tests\Unit\SettingHelperTest.php" line="74" class="Tests\Unit\SettingHelperTest" classname="Tests.Unit.SettingHelperTest" assertions="4" time="0.391953"/>
        <testcase name="test_setting_retrieves_by_key" file="C:\PreIPO\backend\tests\Unit\SettingHelperTest.php" line="63" class="Tests\Unit\SettingHelperTest" classname="Tests.Unit.SettingHelperTest" assertions="1" time="0.412937"/>
        <testcase name="test_setting_value_casts_by_type" file="C:\PreIPO\backend\tests\Unit\SettingHelperTest.php" line="36" class="Tests\Unit\SettingHelperTest" classname="Tests.Unit.SettingHelperTest" assertions="6" time="0.377365"/>
      </testsuite>
      <testsuite name="Tests\Unit\TransactionTest" file="C:\PreIPO\backend\tests\Unit\TransactionTest.php" tests="8" assertions="17" errors="0" failures="0" skipped="0" time="3.192782">
        <testcase name="test_transaction_scope_completed_filters_correctly" file="C:\PreIPO\backend\tests\Unit\TransactionTest.php" line="172" class="Tests\Unit\TransactionTest" classname="Tests.Unit.TransactionTest" assertions="1" time="0.579439"/>
        <testcase name="test_transaction_belongs_to_wallet" file="C:\PreIPO\backend\tests\Unit\TransactionTest.php" line="43" class="Tests\Unit\TransactionTest" classname="Tests.Unit.TransactionTest" assertions="2" time="0.377198"/>
        <testcase name="test_transaction_type_enum_validates" file="C:\PreIPO\backend\tests\Unit\TransactionTest.php" line="58" class="Tests\Unit\TransactionTest" classname="Tests.Unit.TransactionTest" assertions="2" time="0.457315"/>
        <testcase name="test_transaction_scope_pending_filters_correctly" file="C:\PreIPO\backend\tests\Unit\TransactionTest.php" line="192" class="Tests\Unit\TransactionTest" classname="Tests.Unit.TransactionTest" assertions="1" time="0.398808"/>
        <testcase name="test_transaction_status_enum_validates" file="C:\PreIPO\backend\tests\Unit\TransactionTest.php" line="80" class="Tests\Unit\TransactionTest" classname="Tests.Unit.TransactionTest" assertions="2" time="0.382383"/>
        <testcase name="test_transaction_tracks_before_balance" file="C:\PreIPO\backend\tests\Unit\TransactionTest.php" line="97" class="Tests\Unit\TransactionTest" classname="Tests.Unit.TransactionTest" assertions="2" time="0.434620"/>
        <testcase name="test_transaction_has_unique_transaction_id" file="C:\PreIPO\backend\tests\Unit\TransactionTest.php" line="131" class="Tests\Unit\TransactionTest" classname="Tests.Unit.TransactionTest" assertions="5" time="0.300436"/>
        <testcase name="test_transaction_tracks_after_balance" file="C:\PreIPO\backend\tests\Unit\TransactionTest.php" line="114" class="Tests\Unit\TransactionTest" classname="Tests.Unit.TransactionTest" assertions="2" time="0.262582"/>
      </testsuite>
      <testsuite name="Tests\Unit\SupportMessageTest" file="C:\PreIPO\backend\tests\Unit\SupportMessageTest.php" tests="3" assertions="6" errors="0" failures="0" skipped="0" time="0.326381">
        <testcase name="test_message_belongs_to_sender" file="C:\PreIPO\backend\tests\Unit\SupportMessageTest.php" line="37" class="Tests\Unit\SupportMessageTest" classname="Tests.Unit.SupportMessageTest" assertions="2" time="0.131972"/>
        <testcase name="test_message_belongs_to_ticket" file="C:\PreIPO\backend\tests\Unit\SupportMessageTest.php" line="25" class="Tests\Unit\SupportMessageTest" classname="Tests.Unit.SupportMessageTest" assertions="2" time="0.114112"/>
        <testcase name="test_message_tracks_is_admin_reply" file="C:\PreIPO\backend\tests\Unit\SupportMessageTest.php" line="50" class="Tests\Unit\SupportMessageTest" classname="Tests.Unit.SupportMessageTest" assertions="2" time="0.080297"/>
      </testsuite>
      <testsuite name="Tests\Unit\ProfitShareServiceTest" file="C:\PreIPO\backend\tests\Unit\ProfitShareServiceTest.php" tests="5" assertions="0" errors="5" failures="0" skipped="0" time="0.000000">
        <testcase name="test_calculate_distribution_checks_eligibility" file="C:\PreIPO\backend\tests\Unit\ProfitShareServiceTest.php" line="81" class="Tests\Unit\ProfitShareServiceTest" classname="Tests.Unit.ProfitShareServiceTest" assertions="0" time="0.000000">
          <error type="ArgumentCountError">Tests\Unit\ProfitShareServiceTest::test_calculate_distribution_checks_eligibility&#13;
ArgumentCountError: Too few arguments to function App\Services\ProfitShareService::__construct(), 0 passed in C:\PreIPO\backend\tests\Unit\ProfitShareServiceTest.php on line 25 and exactly 2 expected
&#13;
C:\PreIPO\backend\app\Services\ProfitShareService.php:29
C:\PreIPO\backend\tests\Unit\ProfitShareServiceTest.php:25</error>
        </testcase>
        <testcase name="test_calculate_distribution_applies_plan_percentage" file="C:\PreIPO\backend\tests\Unit\ProfitShareServiceTest.php" line="95" class="Tests\Unit\ProfitShareServiceTest" classname="Tests.Unit.ProfitShareServiceTest" assertions="0" time="0.000000">
          <error type="ArgumentCountError">Tests\Unit\ProfitShareServiceTest::test_calculate_distribution_applies_plan_percentage&#13;
ArgumentCountError: Too few arguments to function App\Services\ProfitShareService::__construct(), 0 passed in C:\PreIPO\backend\tests\Unit\ProfitShareServiceTest.php on line 25 and exactly 2 expected
&#13;
C:\PreIPO\backend\app\Services\ProfitShareService.php:29
C:\PreIPO\backend\tests\Unit\ProfitShareServiceTest.php:25</error>
        </testcase>
        <testcase name="test_distribute_to_wallets_credits_correctly" file="C:\PreIPO\backend\tests\Unit\ProfitShareServiceTest.php" line="107" class="Tests\Unit\ProfitShareServiceTest" classname="Tests.Unit.ProfitShareServiceTest" assertions="0" time="0.000000">
          <error type="ArgumentCountError">Tests\Unit\ProfitShareServiceTest::test_distribute_to_wallets_credits_correctly&#13;
ArgumentCountError: Too few arguments to function App\Services\ProfitShareService::__construct(), 0 passed in C:\PreIPO\backend\tests\Unit\ProfitShareServiceTest.php on line 25 and exactly 2 expected
&#13;
C:\PreIPO\backend\app\Services\ProfitShareService.php:29
C:\PreIPO\backend\tests\Unit\ProfitShareServiceTest.php:25</error>
        </testcase>
        <testcase name="test_reversal_debits_wallets_correctly" file="C:\PreIPO\backend\tests\Unit\ProfitShareServiceTest.php" line="126" class="Tests\Unit\ProfitShareServiceTest" classname="Tests.Unit.ProfitShareServiceTest" assertions="0" time="0.000000">
          <error type="ArgumentCountError">Tests\Unit\ProfitShareServiceTest::test_reversal_debits_wallets_correctly&#13;
ArgumentCountError: Too few arguments to function App\Services\ProfitShareService::__construct(), 0 passed in C:\PreIPO\backend\tests\Unit\ProfitShareServiceTest.php on line 25 and exactly 2 expected
&#13;
C:\PreIPO\backend\app\Services\ProfitShareService.php:29
C:\PreIPO\backend\tests\Unit\ProfitShareServiceTest.php:25</error>
        </testcase>
        <testcase name="test_calculate_profit_uses_correct_formula" file="C:\PreIPO\backend\tests\Unit\ProfitShareServiceTest.php" line="57" class="Tests\Unit\ProfitShareServiceTest" classname="Tests.Unit.ProfitShareServiceTest" assertions="0" time="0.000000">
          <error type="ArgumentCountError">Tests\Unit\ProfitShareServiceTest::test_calculate_profit_uses_correct_formula&#13;
ArgumentCountError: Too few arguments to function App\Services\ProfitShareService::__construct(), 0 passed in C:\PreIPO\backend\tests\Unit\ProfitShareServiceTest.php on line 25 and exactly 2 expected
&#13;
C:\PreIPO\backend\app\Services\ProfitShareService.php:29
C:\PreIPO\backend\tests\Unit\ProfitShareServiceTest.php:25</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Unit\BonusCalculatorConsistencyTest" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorConsistencyTest.php" tests="8" assertions="0" errors="8" failures="0" skipped="0" time="11.276601">
        <testcase name="test_consistency_bonus_uses_configured_amounts" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorConsistencyTest.php" line="149" class="Tests\Unit\BonusCalculatorConsistencyTest" classname="Tests.Unit.BonusCalculatorConsistencyTest" assertions="0" time="0.922740">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorConsistencyTest::test_consistency_bonus_uses_configured_amounts&#13;
RuntimeException: Subscription #3856 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorConsistencyTest.php:162</error>
        </testcase>
        <testcase name="test_consistency_bonus_streak_resets_on_late_payment" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorConsistencyTest.php" line="125" class="Tests\Unit\BonusCalculatorConsistencyTest" classname="Tests.Unit.BonusCalculatorConsistencyTest" assertions="0" time="1.503278">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorConsistencyTest::test_consistency_bonus_streak_resets_on_late_payment&#13;
RuntimeException: Subscription #3859 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorConsistencyTest.php:139</error>
        </testcase>
        <testcase name="test_consistency_bonus_respects_global_toggle" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorConsistencyTest.php" line="190" class="Tests\Unit\BonusCalculatorConsistencyTest" classname="Tests.Unit.BonusCalculatorConsistencyTest" assertions="0" time="1.701852">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorConsistencyTest::test_consistency_bonus_respects_global_toggle&#13;
RuntimeException: Subscription #3862 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorConsistencyTest.php:201</error>
        </testcase>
        <testcase name="test_consistency_bonus_amount_varies_by_plan" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorConsistencyTest.php" line="79" class="Tests\Unit\BonusCalculatorConsistencyTest" classname="Tests.Unit.BonusCalculatorConsistencyTest" assertions="0" time="1.520626">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorConsistencyTest::test_consistency_bonus_amount_varies_by_plan&#13;
RuntimeException: Subscription #3866 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorConsistencyTest.php:95</error>
        </testcase>
        <testcase name="test_consistency_bonus_not_awarded_for_late_payment" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorConsistencyTest.php" line="65" class="Tests\Unit\BonusCalculatorConsistencyTest" classname="Tests.Unit.BonusCalculatorConsistencyTest" assertions="0" time="1.540515">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorConsistencyTest::test_consistency_bonus_not_awarded_for_late_payment&#13;
RuntimeException: Subscription #3869 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorConsistencyTest.php:73</error>
        </testcase>
        <testcase name="test_consistency_bonus_awarded_for_on_time_payment" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorConsistencyTest.php" line="48" class="Tests\Unit\BonusCalculatorConsistencyTest" classname="Tests.Unit.BonusCalculatorConsistencyTest" assertions="0" time="1.612856">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorConsistencyTest::test_consistency_bonus_awarded_for_on_time_payment&#13;
RuntimeException: Subscription #3872 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorConsistencyTest.php:56</error>
        </testcase>
        <testcase name="test_consistency_bonus_respects_grace_period" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorConsistencyTest.php" line="171" class="Tests\Unit\BonusCalculatorConsistencyTest" classname="Tests.Unit.BonusCalculatorConsistencyTest" assertions="0" time="1.559568">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorConsistencyTest::test_consistency_bonus_respects_grace_period&#13;
RuntimeException: Subscription #3875 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorConsistencyTest.php:184</error>
        </testcase>
        <testcase name="test_consistency_bonus_multiplies_for_streak" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorConsistencyTest.php" line="104" class="Tests\Unit\BonusCalculatorConsistencyTest" classname="Tests.Unit.BonusCalculatorConsistencyTest" assertions="0" time="0.915166">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorConsistencyTest::test_consistency_bonus_multiplies_for_streak&#13;
RuntimeException: Subscription #3876 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorConsistencyTest.php:115</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Unit\SupportServiceTest" file="C:\PreIPO\backend\tests\Unit\SupportServiceTest.php" tests="3" assertions="4" errors="0" failures="1" skipped="0" time="2.859963">
        <testcase name="test_auto_assign_ticket_to_available_agent" file="C:\PreIPO\backend\tests\Unit\SupportServiceTest.php" line="31" class="Tests\Unit\SupportServiceTest" classname="Tests.Unit.SupportServiceTest" assertions="1" time="0.913007">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\SupportServiceTest::test_auto_assign_ticket_to_available_agent&#13;
Failed asserting that null matches expected 17277.
&#13;
C:\PreIPO\backend\tests\Unit\SupportServiceTest.php:43</failure>
        </testcase>
        <testcase name="test_escalate_ticket_after_sla_breach" file="C:\PreIPO\backend\tests\Unit\SupportServiceTest.php" line="47" class="Tests\Unit\SupportServiceTest" classname="Tests.Unit.SupportServiceTest" assertions="1" time="0.943105"/>
        <testcase name="test_close_ticket_after_resolution" file="C:\PreIPO\backend\tests\Unit\SupportServiceTest.php" line="67" class="Tests\Unit\SupportServiceTest" classname="Tests.Unit.SupportServiceTest" assertions="2" time="1.003851"/>
      </testsuite>
      <testsuite name="Tests\Unit\VerificationServiceTest" file="C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php" tests="10" assertions="0" errors="10" failures="0" skipped="0" time="0.000000">
        <testcase name="test_verify_pan_caches_successful_result" file="C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php" line="92" class="Tests\Unit\VerificationServiceTest" classname="Tests.Unit.VerificationServiceTest" assertions="0" time="0.000000">
          <error type="ArgumentCountError">Tests\Unit\VerificationServiceTest::test_verify_pan_caches_successful_result&#13;
ArgumentCountError: Too few arguments to function App\Services\VerificationService::__construct(), 0 passed in C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php on line 21 and exactly 1 expected
&#13;
C:\PreIPO\backend\app\Services\VerificationService.php:26
C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php:21</error>
        </testcase>
        <testcase name="test_verify_aadhaar_calls_digilocker_api" file="C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php" line="106" class="Tests\Unit\VerificationServiceTest" classname="Tests.Unit.VerificationServiceTest" assertions="0" time="0.000000">
          <error type="ArgumentCountError">Tests\Unit\VerificationServiceTest::test_verify_aadhaar_calls_digilocker_api&#13;
ArgumentCountError: Too few arguments to function App\Services\VerificationService::__construct(), 0 passed in C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php on line 21 and exactly 1 expected
&#13;
C:\PreIPO\backend\app\Services\VerificationService.php:26
C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php:21</error>
        </testcase>
        <testcase name="test_verification_logs_all_attempts" file="C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php" line="153" class="Tests\Unit\VerificationServiceTest" classname="Tests.Unit.VerificationServiceTest" assertions="0" time="0.000000">
          <error type="ArgumentCountError">Tests\Unit\VerificationServiceTest::test_verification_logs_all_attempts&#13;
ArgumentCountError: Too few arguments to function App\Services\VerificationService::__construct(), 0 passed in C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php on line 21 and exactly 1 expected
&#13;
C:\PreIPO\backend\app\Services\VerificationService.php:26
C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php:21</error>
        </testcase>
        <testcase name="test_verify_pan_handles_api_failure" file="C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php" line="79" class="Tests\Unit\VerificationServiceTest" classname="Tests.Unit.VerificationServiceTest" assertions="0" time="0.000000">
          <error type="ArgumentCountError">Tests\Unit\VerificationServiceTest::test_verify_pan_handles_api_failure&#13;
ArgumentCountError: Too few arguments to function App\Services\VerificationService::__construct(), 0 passed in C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php on line 21 and exactly 1 expected
&#13;
C:\PreIPO\backend\app\Services\VerificationService.php:26
C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php:21</error>
        </testcase>
        <testcase name="test_verify_pan_calls_income_tax_api" file="C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php" line="31" class="Tests\Unit\VerificationServiceTest" classname="Tests.Unit.VerificationServiceTest" assertions="0" time="0.000000">
          <error type="ArgumentCountError">Tests\Unit\VerificationServiceTest::test_verify_pan_calls_income_tax_api&#13;
ArgumentCountError: Too few arguments to function App\Services\VerificationService::__construct(), 0 passed in C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php on line 21 and exactly 1 expected
&#13;
C:\PreIPO\backend\app\Services\VerificationService.php:26
C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php:21</error>
        </testcase>
        <testcase name="test_verify_aadhaar_validates_name_match" file="C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php" line="121" class="Tests\Unit\VerificationServiceTest" classname="Tests.Unit.VerificationServiceTest" assertions="0" time="0.000000">
          <error type="ArgumentCountError">Tests\Unit\VerificationServiceTest::test_verify_aadhaar_validates_name_match&#13;
ArgumentCountError: Too few arguments to function App\Services\VerificationService::__construct(), 0 passed in C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php on line 21 and exactly 1 expected
&#13;
C:\PreIPO\backend\app\Services\VerificationService.php:26
C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php:21</error>
        </testcase>
        <testcase name="test_verify_bank_account_validates_ifsc_code" file="C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php" line="143" class="Tests\Unit\VerificationServiceTest" classname="Tests.Unit.VerificationServiceTest" assertions="0" time="0.000000">
          <error type="ArgumentCountError">Tests\Unit\VerificationServiceTest::test_verify_bank_account_validates_ifsc_code&#13;
ArgumentCountError: Too few arguments to function App\Services\VerificationService::__construct(), 0 passed in C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php on line 21 and exactly 1 expected
&#13;
C:\PreIPO\backend\app\Services\VerificationService.php:26
C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php:21</error>
        </testcase>
        <testcase name="test_verify_aadhaar_handles_api_failure" file="C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php" line="133" class="Tests\Unit\VerificationServiceTest" classname="Tests.Unit.VerificationServiceTest" assertions="0" time="0.000000">
          <error type="ArgumentCountError">Tests\Unit\VerificationServiceTest::test_verify_aadhaar_handles_api_failure&#13;
ArgumentCountError: Too few arguments to function App\Services\VerificationService::__construct(), 0 passed in C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php on line 21 and exactly 1 expected
&#13;
C:\PreIPO\backend\app\Services\VerificationService.php:26
C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php:21</error>
        </testcase>
        <testcase name="test_verify_pan_validates_name_match" file="C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php" line="51" class="Tests\Unit\VerificationServiceTest" classname="Tests.Unit.VerificationServiceTest" assertions="0" time="0.000000">
          <error type="ArgumentCountError">Tests\Unit\VerificationServiceTest::test_verify_pan_validates_name_match&#13;
ArgumentCountError: Too few arguments to function App\Services\VerificationService::__construct(), 0 passed in C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php on line 21 and exactly 1 expected
&#13;
C:\PreIPO\backend\app\Services\VerificationService.php:26
C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php:21</error>
        </testcase>
        <testcase name="test_verify_pan_validates_dob_match" file="C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php" line="65" class="Tests\Unit\VerificationServiceTest" classname="Tests.Unit.VerificationServiceTest" assertions="0" time="0.000000">
          <error type="ArgumentCountError">Tests\Unit\VerificationServiceTest::test_verify_pan_validates_dob_match&#13;
ArgumentCountError: Too few arguments to function App\Services\VerificationService::__construct(), 0 passed in C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php on line 21 and exactly 1 expected
&#13;
C:\PreIPO\backend\app\Services\VerificationService.php:26
C:\PreIPO\backend\tests\Unit\VerificationServiceTest.php:21</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Unit\UserInvestmentTest" file="C:\PreIPO\backend\tests\Unit\UserInvestmentTest.php" tests="8" assertions="0" errors="8" failures="0" skipped="0" time="0.000000">
        <testcase name="test_investment_belongs_to_bulk_purchase" file="C:\PreIPO\backend\tests\Unit\UserInvestmentTest.php" line="55" class="Tests\Unit\UserInvestmentTest" classname="Tests.Unit.UserInvestmentTest" assertions="0" time="0.000000">
          <error type="Illuminate\Database\QueryException">Tests\Unit\UserInvestmentTest::test_investment_belongs_to_bulk_purchase&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1364 Field 'payment_id' doesn't have a default value (Connection: mysql, SQL: insert into `user_investments` (`user_id`, `product_id`, `bulk_purchase_id`, `units_allocated`, `value_allocated`, `source`, `updated_at`, `created_at`) values (17287, 2677, 720, 10, 1000, investment, 2026-02-22 10:38:00, 2026-02-22 10:38:00))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\UserInvestmentTest.php:33</error>
        </testcase>
        <testcase name="test_investment_calculates_roi_percentage" file="C:\PreIPO\backend\tests\Unit\UserInvestmentTest.php" line="93" class="Tests\Unit\UserInvestmentTest" classname="Tests.Unit.UserInvestmentTest" assertions="0" time="0.000000">
          <error type="Illuminate\Database\QueryException">Tests\Unit\UserInvestmentTest::test_investment_calculates_roi_percentage&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1364 Field 'payment_id' doesn't have a default value (Connection: mysql, SQL: insert into `user_investments` (`user_id`, `product_id`, `bulk_purchase_id`, `units_allocated`, `value_allocated`, `source`, `updated_at`, `created_at`) values (17290, 2678, 721, 10, 1000, investment, 2026-02-22 10:38:00, 2026-02-22 10:38:00))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\UserInvestmentTest.php:33</error>
        </testcase>
        <testcase name="test_investment_calculates_profit_loss" file="C:\PreIPO\backend\tests\Unit\UserInvestmentTest.php" line="87" class="Tests\Unit\UserInvestmentTest" classname="Tests.Unit.UserInvestmentTest" assertions="0" time="0.000000">
          <error type="Illuminate\Database\QueryException">Tests\Unit\UserInvestmentTest::test_investment_calculates_profit_loss&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1364 Field 'payment_id' doesn't have a default value (Connection: mysql, SQL: insert into `user_investments` (`user_id`, `product_id`, `bulk_purchase_id`, `units_allocated`, `value_allocated`, `source`, `updated_at`, `created_at`) values (17294, 2679, 722, 10, 1000, investment, 2026-02-22 10:38:01, 2026-02-22 10:38:01))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\UserInvestmentTest.php:33</error>
        </testcase>
        <testcase name="test_investment_belongs_to_product" file="C:\PreIPO\backend\tests\Unit\UserInvestmentTest.php" line="49" class="Tests\Unit\UserInvestmentTest" classname="Tests.Unit.UserInvestmentTest" assertions="0" time="0.000000">
          <error type="Illuminate\Database\QueryException">Tests\Unit\UserInvestmentTest::test_investment_belongs_to_product&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1364 Field 'payment_id' doesn't have a default value (Connection: mysql, SQL: insert into `user_investments` (`user_id`, `product_id`, `bulk_purchase_id`, `units_allocated`, `value_allocated`, `source`, `updated_at`, `created_at`) values (17297, 2680, 723, 10, 1000, investment, 2026-02-22 10:38:01, 2026-02-22 10:38:01))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\UserInvestmentTest.php:33</error>
        </testcase>
        <testcase name="test_investment_belongs_to_user" file="C:\PreIPO\backend\tests\Unit\UserInvestmentTest.php" line="43" class="Tests\Unit\UserInvestmentTest" classname="Tests.Unit.UserInvestmentTest" assertions="0" time="0.000000">
          <error type="Illuminate\Database\QueryException">Tests\Unit\UserInvestmentTest::test_investment_belongs_to_user&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1364 Field 'payment_id' doesn't have a default value (Connection: mysql, SQL: insert into `user_investments` (`user_id`, `product_id`, `bulk_purchase_id`, `units_allocated`, `value_allocated`, `source`, `updated_at`, `created_at`) values (17300, 2681, 724, 10, 1000, investment, 2026-02-22 10:38:01, 2026-02-22 10:38:01))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\UserInvestmentTest.php:33</error>
        </testcase>
        <testcase name="test_investment_tracks_allocation_type" file="C:\PreIPO\backend\tests\Unit\UserInvestmentTest.php" line="61" class="Tests\Unit\UserInvestmentTest" classname="Tests.Unit.UserInvestmentTest" assertions="0" time="0.000000">
          <error type="Illuminate\Database\QueryException">Tests\Unit\UserInvestmentTest::test_investment_tracks_allocation_type&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1364 Field 'payment_id' doesn't have a default value (Connection: mysql, SQL: insert into `user_investments` (`user_id`, `product_id`, `bulk_purchase_id`, `units_allocated`, `value_allocated`, `source`, `updated_at`, `created_at`) values (17304, 2682, 725, 10, 1000, investment, 2026-02-22 10:38:01, 2026-02-22 10:38:01))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\UserInvestmentTest.php:33</error>
        </testcase>
        <testcase name="test_investment_calculates_current_value" file="C:\PreIPO\backend\tests\Unit\UserInvestmentTest.php" line="81" class="Tests\Unit\UserInvestmentTest" classname="Tests.Unit.UserInvestmentTest" assertions="0" time="0.000000">
          <error type="Illuminate\Database\QueryException">Tests\Unit\UserInvestmentTest::test_investment_calculates_current_value&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1364 Field 'payment_id' doesn't have a default value (Connection: mysql, SQL: insert into `user_investments` (`user_id`, `product_id`, `bulk_purchase_id`, `units_allocated`, `value_allocated`, `source`, `updated_at`, `created_at`) values (17307, 2683, 726, 10, 1000, investment, 2026-02-22 10:38:01, 2026-02-22 10:38:01))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\UserInvestmentTest.php:33</error>
        </testcase>
        <testcase name="test_investment_tracks_units_allocated" file="C:\PreIPO\backend\tests\Unit\UserInvestmentTest.php" line="76" class="Tests\Unit\UserInvestmentTest" classname="Tests.Unit.UserInvestmentTest" assertions="0" time="0.000000">
          <error type="Illuminate\Database\QueryException">Tests\Unit\UserInvestmentTest::test_investment_tracks_units_allocated&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1364 Field 'payment_id' doesn't have a default value (Connection: mysql, SQL: insert into `user_investments` (`user_id`, `product_id`, `bulk_purchase_id`, `units_allocated`, `value_allocated`, `source`, `updated_at`, `created_at`) values (17310, 2684, 727, 10, 1000, investment, 2026-02-22 10:38:01, 2026-02-22 10:38:01))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\UserInvestmentTest.php:33</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Unit\SmsServiceTest" file="C:\PreIPO\backend\tests\Unit\SmsServiceTest.php" tests="6" assertions="5" errors="3" failures="2" skipped="0" time="2.356298">
        <testcase name="test_send_sms_logs_delivery" file="C:\PreIPO\backend\tests\Unit\SmsServiceTest.php" line="69" class="Tests\Unit\SmsServiceTest" classname="Tests.Unit.SmsServiceTest" assertions="1" time="0.326101">
          <error type="Illuminate\Database\QueryException">Tests\Unit\SmsServiceTest::test_send_sms_logs_delivery&#13;
Illuminate\Database\QueryException: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'to_mobile' in 'where clause' (Connection: mysql, SQL: select exists(select * from `sms_logs` where (`user_id` = 17318 and `to_mobile` = 9876543210 and `status` = sent and `gateway_message_id` = abc)) as `exists`)
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:398
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3477
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Testing\Constraints\HasInDatabase.php:56
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithDatabase.php:36
C:\PreIPO\backend\tests\Unit\SmsServiceTest.php:75</error>
        </testcase>
        <testcase name="test_send_sms_uses_correct_template_id" file="C:\PreIPO\backend\tests\Unit\SmsServiceTest.php" line="27" class="Tests\Unit\SmsServiceTest" classname="Tests.Unit.SmsServiceTest" assertions="1" time="0.371954">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\SmsServiceTest::test_send_sms_uses_correct_template_id&#13;
An expected request was not recorded.
Failed asserting that false is true.
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Http\Client\Factory.php:354
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\tests\Unit\SmsServiceTest.php:36</failure>
        </testcase>
        <testcase name="test_send_sms_limits_to_160_chars" file="C:\PreIPO\backend\tests\Unit\SmsServiceTest.php" line="54" class="Tests\Unit\SmsServiceTest" classname="Tests.Unit.SmsServiceTest" assertions="1" time="0.489390">
          <error type="Mockery\Exception\BadMethodCallException">Tests\Unit\SmsServiceTest::test_send_sms_limits_to_160_chars&#13;
Mockery\Exception\BadMethodCallException: Received Mockery_7_Illuminate_Log_LogManager::error(), but no expectations were specified
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Facades\Facade.php:361
C:\PreIPO\backend\app\Services\SmsService.php:55
C:\PreIPO\backend\tests\Unit\SmsServiceTest.php:61</error>
        </testcase>
        <testcase name="test_send_sms_respects_user_preferences" file="C:\PreIPO\backend\tests\Unit\SmsServiceTest.php" line="96" class="Tests\Unit\SmsServiceTest" classname="Tests.Unit.SmsServiceTest" assertions="0" time="0.361212">
          <error type="Illuminate\Database\QueryException">Tests\Unit\SmsServiceTest::test_send_sms_respects_user_preferences&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1364 Field 'notification_type' doesn't have a default value (Connection: mysql, SQL: insert into `user_notification_preferences` (`user_id`, `updated_at`, `created_at`) values (17326, 2026-02-22 10:38:03, 2026-02-22 10:38:03))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Relations\HasOneOrMany.php:371
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Relations\HasOneOrMany.php:368
C:\PreIPO\backend\tests\Unit\SmsServiceTest.php:99</error>
        </testcase>
        <testcase name="test_send_sms_replaces_variables" file="C:\PreIPO\backend\tests\Unit\SmsServiceTest.php" line="42" class="Tests\Unit\SmsServiceTest" classname="Tests.Unit.SmsServiceTest" assertions="1" time="0.407221"/>
        <testcase name="test_send_sms_handles_msg91_failure" file="C:\PreIPO\backend\tests\Unit\SmsServiceTest.php" line="84" class="Tests\Unit\SmsServiceTest" classname="Tests.Unit.SmsServiceTest" assertions="1" time="0.400420">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\SmsServiceTest::test_send_sms_handles_msg91_failure&#13;
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
-'failed'
+'sent'
&#13;
C:\PreIPO\backend\tests\Unit\SmsServiceTest.php:91</failure>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Unit\PasswordResetTokenTest" file="C:\PreIPO\backend\tests\Unit\PasswordResetTokenTest.php" tests="1" assertions="3" errors="0" failures="0" skipped="0" time="0.072165">
        <testcase name="testPasswordResetTokenExpiry" file="C:\PreIPO\backend\tests\Unit\PasswordResetTokenTest.php" line="14" class="Tests\Unit\PasswordResetTokenTest" classname="Tests.Unit.PasswordResetTokenTest" assertions="3" time="0.072165"/>
      </testsuite>
      <testsuite name="Tests\Unit\Enums\DisclosureTierTest" file="C:\PreIPO\backend\tests\Unit\Enums\DisclosureTierTest.php" tests="12" assertions="75" errors="0" failures="0" skipped="0" time="0.003075">
        <testcase name="test_values_returns_all_tier_strings" file="C:\PreIPO\backend\tests\Unit\Enums\DisclosureTierTest.php" line="168" class="Tests\Unit\Enums\DisclosureTierTest" classname="Tests.Unit.Enums.DisclosureTierTest" assertions="5" time="0.001600"/>
        <testcase name="test_investability_matches_visibility" file="C:\PreIPO\backend\tests\Unit\Enums\DisclosureTierTest.php" line="57" class="Tests\Unit\Enums\DisclosureTierTest" classname="Tests.Unit.Enums.DisclosureTierTest" assertions="4" time="0.000143"/>
        <testcase name="test_next_tier_progression" file="C:\PreIPO\backend\tests\Unit\Enums\DisclosureTierTest.php" line="71" class="Tests\Unit\Enums\DisclosureTierTest" classname="Tests.Unit.Enums.DisclosureTierTest" assertions="4" time="0.000131"/>
        <testcase name="test_public_visibility_invariant" file="C:\PreIPO\backend\tests\Unit\Enums\DisclosureTierTest.php" line="43" class="Tests\Unit\Enums\DisclosureTierTest" classname="Tests.Unit.Enums.DisclosureTierTest" assertions="4" time="0.000126"/>
        <testcase name="test_tier_values_are_correct_strings" file="C:\PreIPO\backend\tests\Unit\Enums\DisclosureTierTest.php" line="146" class="Tests\Unit\Enums\DisclosureTierTest" classname="Tests.Unit.Enums.DisclosureTierTest" assertions="4" time="0.000119"/>
        <testcase name="test_can_promote_to_allows_only_one_tier_advancement" file="C:\PreIPO\backend\tests\Unit\Enums\DisclosureTierTest.php" line="82" class="Tests\Unit\Enums\DisclosureTierTest" classname="Tests.Unit.Enums.DisclosureTierTest" assertions="11" time="0.000147"/>
        <testcase name="test_publicly_visible_tiers_returns_correct_tiers" file="C:\PreIPO\backend\tests\Unit\Enums\DisclosureTierTest.php" line="124" class="Tests\Unit\Enums\DisclosureTierTest" classname="Tests.Unit.Enums.DisclosureTierTest" assertions="5" time="0.000142"/>
        <testcase name="test_maximum_tier_cannot_be_promoted" file="C:\PreIPO\backend\tests\Unit\Enums\DisclosureTierTest.php" line="107" class="Tests\Unit\Enums\DisclosureTierTest" classname="Tests.Unit.Enums.DisclosureTierTest" assertions="5" time="0.000137"/>
        <testcase name="test_options_returns_structured_array_for_forms" file="C:\PreIPO\backend\tests\Unit\Enums\DisclosureTierTest.php" line="182" class="Tests\Unit\Enums\DisclosureTierTest" classname="Tests.Unit.Enums.DisclosureTierTest" assertions="21" time="0.000169"/>
        <testcase name="test_tier_labels_are_human_readable" file="C:\PreIPO\backend\tests\Unit\Enums\DisclosureTierTest.php" line="157" class="Tests\Unit\Enums\DisclosureTierTest" classname="Tests.Unit.Enums.DisclosureTierTest" assertions="4" time="0.000119"/>
        <testcase name="test_tier_ranking_is_monotonic" file="C:\PreIPO\backend\tests\Unit\Enums\DisclosureTierTest.php" line="21" class="Tests\Unit\Enums\DisclosureTierTest" classname="Tests.Unit.Enums.DisclosureTierTest" assertions="7" time="0.000127"/>
        <testcase name="test_minimum_public_tier_is_tier_2_live" file="C:\PreIPO\backend\tests\Unit\Enums\DisclosureTierTest.php" line="138" class="Tests\Unit\Enums\DisclosureTierTest" classname="Tests.Unit.Enums.DisclosureTierTest" assertions="1" time="0.000115"/>
      </testsuite>
      <testsuite name="Tests\Unit\RateLimitingTest" file="C:\PreIPO\backend\tests\Unit\RateLimitingTest.php" tests="1" assertions="6" errors="0" failures="0" skipped="0" time="0.008603">
        <testcase name="testRateLimitingPreventsAbuse" file="C:\PreIPO\backend\tests\Unit\RateLimitingTest.php" line="36" class="Tests\Unit\RateLimitingTest" classname="Tests.Unit.RateLimitingTest" assertions="6" time="0.008603"/>
      </testsuite>
      <testsuite name="Tests\Unit\BonusCalculatorProgressiveTest" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorProgressiveTest.php" tests="10" assertions="0" errors="10" failures="0" skipped="0" time="9.349580">
        <testcase name="test_progressive_bonus_uses_month_override_if_configured" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorProgressiveTest.php" line="134" class="Tests\Unit\BonusCalculatorProgressiveTest" classname="Tests.Unit.BonusCalculatorProgressiveTest" assertions="0" time="0.859221">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorProgressiveTest::test_progressive_bonus_uses_month_override_if_configured&#13;
RuntimeException: Subscription #3881 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorProgressiveTest.php:150</error>
        </testcase>
        <testcase name="test_progressive_bonus_not_awarded_before_start_month" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorProgressiveTest.php" line="49" class="Tests\Unit\BonusCalculatorProgressiveTest" classname="Tests.Unit.BonusCalculatorProgressiveTest" assertions="0" time="0.943899">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorProgressiveTest::test_progressive_bonus_not_awarded_before_start_month&#13;
RuntimeException: Subscription #3882 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorProgressiveTest.php:55</error>
        </testcase>
        <testcase name="test_progressive_bonus_respects_global_toggle" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorProgressiveTest.php" line="196" class="Tests\Unit\BonusCalculatorProgressiveTest" classname="Tests.Unit.BonusCalculatorProgressiveTest" assertions="0" time="0.932128">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorProgressiveTest::test_progressive_bonus_respects_global_toggle&#13;
RuntimeException: Subscription #3883 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorProgressiveTest.php:205</error>
        </testcase>
        <testcase name="test_progressive_bonus_applies_referral_multiplier" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorProgressiveTest.php" line="114" class="Tests\Unit\BonusCalculatorProgressiveTest" classname="Tests.Unit.BonusCalculatorProgressiveTest" assertions="0" time="0.941626">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorProgressiveTest::test_progressive_bonus_applies_referral_multiplier&#13;
RuntimeException: Subscription #3884 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorProgressiveTest.php:124</error>
        </testcase>
        <testcase name="test_progressive_bonus_uses_payment_amount_as_base" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorProgressiveTest.php" line="180" class="Tests\Unit\BonusCalculatorProgressiveTest" classname="Tests.Unit.BonusCalculatorProgressiveTest" assertions="0" time="0.739973">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorProgressiveTest::test_progressive_bonus_uses_payment_amount_as_base&#13;
RuntimeException: Subscription #3885 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorProgressiveTest.php:187</error>
        </testcase>
        <testcase name="test_progressive_bonus_calculates_correctly_at_month_4" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorProgressiveTest.php" line="61" class="Tests\Unit\BonusCalculatorProgressiveTest" classname="Tests.Unit.BonusCalculatorProgressiveTest" assertions="0" time="0.806467">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorProgressiveTest::test_progressive_bonus_calculates_correctly_at_month_4&#13;
RuntimeException: Subscription #3886 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorProgressiveTest.php:68</error>
        </testcase>
        <testcase name="test_progressive_bonus_caps_at_maximum_percentage" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorProgressiveTest.php" line="159" class="Tests\Unit\BonusCalculatorProgressiveTest" classname="Tests.Unit.BonusCalculatorProgressiveTest" assertions="0" time="1.406154">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorProgressiveTest::test_progressive_bonus_caps_at_maximum_percentage&#13;
RuntimeException: Subscription #3887 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorProgressiveTest.php:170</error>
        </testcase>
        <testcase name="test_progressive_bonus_respects_configured_rate" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorProgressiveTest.php" line="93" class="Tests\Unit\BonusCalculatorProgressiveTest" classname="Tests.Unit.BonusCalculatorProgressiveTest" assertions="0" time="0.751745">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorProgressiveTest::test_progressive_bonus_respects_configured_rate&#13;
RuntimeException: Subscription #3888 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorProgressiveTest.php:105</error>
        </testcase>
        <testcase name="test_progressive_bonus_increases_linearly_each_month" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorProgressiveTest.php" line="77" class="Tests\Unit\BonusCalculatorProgressiveTest" classname="Tests.Unit.BonusCalculatorProgressiveTest" assertions="0" time="1.003016">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorProgressiveTest::test_progressive_bonus_increases_linearly_each_month&#13;
RuntimeException: Subscription #3889 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorProgressiveTest.php:84</error>
        </testcase>
        <testcase name="test_progressive_bonus_formula_evaluation_works" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorProgressiveTest.php" line="211" class="Tests\Unit\BonusCalculatorProgressiveTest" classname="Tests.Unit.BonusCalculatorProgressiveTest" assertions="0" time="0.965350">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorProgressiveTest::test_progressive_bonus_formula_evaluation_works&#13;
RuntimeException: Subscription #3890 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorProgressiveTest.php:224</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Unit\SubscriptionTest" file="C:\PreIPO\backend\tests\Unit\SubscriptionTest.php" tests="12" assertions="22" errors="0" failures="0" skipped="0" time="1.121107">
        <testcase name="test_subscription_belongs_to_user" file="C:\PreIPO\backend\tests\Unit\SubscriptionTest.php" line="26" class="Tests\Unit\SubscriptionTest" classname="Tests.Unit.SubscriptionTest" assertions="2" time="0.088120"/>
        <testcase name="test_subscription_calculates_next_payment_date" file="C:\PreIPO\backend\tests\Unit\SubscriptionTest.php" line="71" class="Tests\Unit\SubscriptionTest" classname="Tests.Unit.SubscriptionTest" assertions="2" time="0.112609"/>
        <testcase name="test_subscription_can_be_cancelled" file="C:\PreIPO\backend\tests\Unit\SubscriptionTest.php" line="153" class="Tests\Unit\SubscriptionTest" classname="Tests.Unit.SubscriptionTest" assertions="3" time="0.070539"/>
        <testcase name="test_subscription_has_payments_relationship" file="C:\PreIPO\backend\tests\Unit\SubscriptionTest.php" line="62" class="Tests\Unit\SubscriptionTest" classname="Tests.Unit.SubscriptionTest" assertions="1" time="0.080913"/>
        <testcase name="test_subscription_can_be_paused" file="C:\PreIPO\backend\tests\Unit\SubscriptionTest.php" line="117" class="Tests\Unit\SubscriptionTest" classname="Tests.Unit.SubscriptionTest" assertions="3" time="0.102904"/>
        <testcase name="test_subscription_validates_pause_limit" file="C:\PreIPO\backend\tests\Unit\SubscriptionTest.php" line="168" class="Tests\Unit\SubscriptionTest" classname="Tests.Unit.SubscriptionTest" assertions="1" time="0.072607"/>
        <testcase name="test_subscription_status_enum_validates" file="C:\PreIPO\backend\tests\Unit\SubscriptionTest.php" line="189" class="Tests\Unit\SubscriptionTest" classname="Tests.Unit.SubscriptionTest" assertions="3" time="0.080022"/>
        <testcase name="test_subscription_tracks_consecutive_payments" file="C:\PreIPO\backend\tests\Unit\SubscriptionTest.php" line="106" class="Tests\Unit\SubscriptionTest" classname="Tests.Unit.SubscriptionTest" assertions="1" time="0.092758"/>
        <testcase name="test_subscription_calculates_total_paid" file="C:\PreIPO\backend\tests\Unit\SubscriptionTest.php" line="178" class="Tests\Unit\SubscriptionTest" classname="Tests.Unit.SubscriptionTest" assertions="1" time="0.105051"/>
        <testcase name="test_subscription_can_be_resumed" file="C:\PreIPO\backend\tests\Unit\SubscriptionTest.php" line="138" class="Tests\Unit\SubscriptionTest" classname="Tests.Unit.SubscriptionTest" assertions="2" time="0.081580"/>
        <testcase name="test_subscription_calculates_months_completed" file="C:\PreIPO\backend\tests\Unit\SubscriptionTest.php" line="86" class="Tests\Unit\SubscriptionTest" classname="Tests.Unit.SubscriptionTest" assertions="1" time="0.149276"/>
        <testcase name="test_subscription_belongs_to_plan" file="C:\PreIPO\backend\tests\Unit\SubscriptionTest.php" line="44" class="Tests\Unit\SubscriptionTest" classname="Tests.Unit.SubscriptionTest" assertions="2" time="0.084726"/>
      </testsuite>
      <testsuite name="Tests\Unit\CsrfProtectionTest" file="C:\PreIPO\backend\tests\Unit\CsrfProtectionTest.php" tests="1" assertions="3" errors="0" failures="0" skipped="0" time="0.185961">
        <testcase name="testCsrfProtectionEnabled" file="C:\PreIPO\backend\tests\Unit\CsrfProtectionTest.php" line="39" class="Tests\Unit\CsrfProtectionTest" classname="Tests.Unit.CsrfProtectionTest" assertions="3" time="0.185961"/>
      </testsuite>
      <testsuite name="Tests\Unit\BonusCalculatorMilestoneTest" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorMilestoneTest.php" tests="10" assertions="0" errors="10" failures="0" skipped="0" time="13.051390">
        <testcase name="test_milestone_bonus_respects_global_toggle" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorMilestoneTest.php" line="208" class="Tests\Unit\BonusCalculatorMilestoneTest" classname="Tests.Unit.BonusCalculatorMilestoneTest" assertions="0" time="0.827150">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorMilestoneTest::test_milestone_bonus_respects_global_toggle&#13;
RuntimeException: Subscription #3903 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorMilestoneTest.php:217</error>
        </testcase>
        <testcase name="test_milestone_bonus_awarded_at_month_24" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorMilestoneTest.php" line="73" class="Tests\Unit\BonusCalculatorMilestoneTest" classname="Tests.Unit.BonusCalculatorMilestoneTest" assertions="0" time="1.636484">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorMilestoneTest::test_milestone_bonus_awarded_at_month_24&#13;
RuntimeException: Subscription #3905 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorMilestoneTest.php:80</error>
        </testcase>
        <testcase name="test_milestone_bonus_awarded_at_month_12" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorMilestoneTest.php" line="48" class="Tests\Unit\BonusCalculatorMilestoneTest" classname="Tests.Unit.BonusCalculatorMilestoneTest" assertions="0" time="1.507989">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorMilestoneTest::test_milestone_bonus_awarded_at_month_12&#13;
RuntimeException: Subscription #3907 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorMilestoneTest.php:63</error>
        </testcase>
        <testcase name="test_milestone_bonus_uses_configured_amounts" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorMilestoneTest.php" line="163" class="Tests\Unit\BonusCalculatorMilestoneTest" classname="Tests.Unit.BonusCalculatorMilestoneTest" assertions="0" time="1.514608">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorMilestoneTest::test_milestone_bonus_uses_configured_amounts&#13;
RuntimeException: Subscription #3908 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorMilestoneTest.php:175</error>
        </testcase>
        <testcase name="test_milestone_bonus_applies_referral_multiplier" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorMilestoneTest.php" line="145" class="Tests\Unit\BonusCalculatorMilestoneTest" classname="Tests.Unit.BonusCalculatorMilestoneTest" assertions="0" time="1.512520">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorMilestoneTest::test_milestone_bonus_applies_referral_multiplier&#13;
RuntimeException: Subscription #3909 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorMilestoneTest.php:152</error>
        </testcase>
        <testcase name="test_milestone_bonus_awarded_at_month_36" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorMilestoneTest.php" line="89" class="Tests\Unit\BonusCalculatorMilestoneTest" classname="Tests.Unit.BonusCalculatorMilestoneTest" assertions="0" time="1.696220">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorMilestoneTest::test_milestone_bonus_awarded_at_month_36&#13;
RuntimeException: Subscription #3910 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorMilestoneTest.php:96</error>
        </testcase>
        <testcase name="test_milestone_bonus_not_awarded_if_non_consecutive" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorMilestoneTest.php" line="105" class="Tests\Unit\BonusCalculatorMilestoneTest" classname="Tests.Unit.BonusCalculatorMilestoneTest" assertions="0" time="1.545474">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorMilestoneTest::test_milestone_bonus_not_awarded_if_non_consecutive&#13;
RuntimeException: Subscription #3911 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorMilestoneTest.php:114</error>
        </testcase>
        <testcase name="test_milestone_bonus_supports_custom_milestones" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorMilestoneTest.php" line="183" class="Tests\Unit\BonusCalculatorMilestoneTest" classname="Tests.Unit.BonusCalculatorMilestoneTest" assertions="0" time="0.879690">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorMilestoneTest::test_milestone_bonus_supports_custom_milestones&#13;
RuntimeException: Subscription #3912 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorMilestoneTest.php:199</error>
        </testcase>
        <testcase name="test_milestone_bonus_amount_varies_by_plan" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorMilestoneTest.php" line="120" class="Tests\Unit\BonusCalculatorMilestoneTest" classname="Tests.Unit.BonusCalculatorMilestoneTest" assertions="0" time="0.978072">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorMilestoneTest::test_milestone_bonus_amount_varies_by_plan&#13;
RuntimeException: Subscription #3914 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorMilestoneTest.php:135</error>
        </testcase>
        <testcase name="test_milestone_bonus_only_awarded_once_per_milestone" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorMilestoneTest.php" line="223" class="Tests\Unit\BonusCalculatorMilestoneTest" classname="Tests.Unit.BonusCalculatorMilestoneTest" assertions="0" time="0.953182">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorMilestoneTest::test_milestone_bonus_only_awarded_once_per_milestone&#13;
RuntimeException: Subscription #3915 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorMilestoneTest.php:230</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Unit\WalletServiceTest" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" tests="24" assertions="33" errors="1" failures="14" skipped="0" time="2.147284">
        <testcase name="unlock_funds_decreases_locked_balance" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="238" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="2" time="0.114045">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\WalletServiceTest::unlock_funds_decreases_locked_balance&#13;
Failed asserting that 298 matches expected 100.0.
&#13;
C:\PreIPO\backend\tests\Unit\WalletServiceTest.php:246</failure>
        </testcase>
        <testcase name="unlock_funds_throws_exception_for_insufficient_locked_balance" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="250" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="1" time="0.130669">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\WalletServiceTest::unlock_funds_throws_exception_for_insufficient_locked_balance&#13;
Failed asserting that exception of type "RuntimeException" is thrown.</failure>
        </testcase>
        <testcase name="deposit_stores_reference_when_provided" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="114" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="0" time="0.080033">
          <error type="Illuminate\Database\QueryException">Tests\Unit\WalletServiceTest::deposit_stores_reference_when_provided&#13;
Illuminate\Database\QueryException: SQLSTATE[23000]: Integrity constraint violation: 1452 Cannot add or update a child row: a foreign key constraint fails (`preipo_test`.`bonus_transactions`, CONSTRAINT `bonus_transactions_subscription_id_foreign` FOREIGN KEY (`subscription_id`) REFERENCES `subscriptions` (`id`) ON DELETE CASCADE) (Connection: mysql, SQL: insert into `bonus_transactions` (`user_id`, `subscription_id`, `payment_id`, `type`, `amount`, `multiplier_applied`, `tds_deducted`, `updated_at`, `created_at`) values (17764, 1, 1, consistency, 50, 1, 0, 2026-02-22 10:38:28, 2026-02-22 10:38:28))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\WalletServiceTest.php:116</error>
        </testcase>
        <testcase name="deposit_throws_exception_for_zero_amount" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="96" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="2" time="0.089289"/>
        <testcase name="handles_exact_balance_withdrawal" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="355" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="1" time="0.073354">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\WalletServiceTest::handles_exact_balance_withdrawal&#13;
Failed asserting that 495 matches expected 0.0.
&#13;
C:\PreIPO\backend\tests\Unit\WalletServiceTest.php:361</failure>
        </testcase>
        <testcase name="withdraw_creates_transaction_with_paise" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="149" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="1" time="0.076548">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\WalletServiceTest::withdraw_creates_transaction_with_paise&#13;
Failed asserting that a row in the table [transactions] matches the attributes {
    "wallet_id": 19035,
    "type": "admin_adjustment",
    "amount_paise": 20000,
    "status": "completed"
}.

Found similar results: [
    {
        "wallet_id": 19035,
        "type": "admin_adjustment",
        "amount_paise": 200,
        "status": "completed"
    }
].
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithDatabase.php:36
C:\PreIPO\backend\tests\Unit\WalletServiceTest.php:155</failure>
        </testcase>
        <testcase name="concurrent_deposits_are_handled_safely" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="272" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="1" time="0.133376">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\WalletServiceTest::concurrent_deposits_are_handled_safely&#13;
Failed asserting that 5 matches expected 500.0.
&#13;
C:\PreIPO\backend\tests\Unit\WalletServiceTest.php:282</failure>
        </testcase>
        <testcase name="concurrent_withdrawals_respect_balance_limits" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="288" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="1" time="0.083611">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\WalletServiceTest::concurrent_withdrawals_respect_balance_limits&#13;
Failed asserting that exception of type "Exception" is thrown.</failure>
        </testcase>
        <testcase name="withdraw_decreases_wallet_balance" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="139" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="1" time="0.076467">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\WalletServiceTest::withdraw_decreases_wallet_balance&#13;
Failed asserting that 997 matches expected 700.0.
&#13;
C:\PreIPO\backend\tests\Unit\WalletServiceTest.php:145</failure>
        </testcase>
        <testcase name="handles_large_amounts" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="346" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="2" time="0.106698"/>
        <testcase name="deposit_is_atomic" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="303" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="1" time="0.074176"/>
        <testcase name="deposit_records_balance_before_and_after" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="83" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="1" time="0.092775">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\WalletServiceTest::deposit_records_balance_before_and_after&#13;
Failed asserting that 1 matches expected 100.0.
&#13;
C:\PreIPO\backend\tests\Unit\WalletServiceTest.php:91</failure>
        </testcase>
        <testcase name="deposit_creates_transaction_record" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="68" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="1" time="0.109596"/>
        <testcase name="handles_decimal_amounts_correctly" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="337" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="2" time="0.086610"/>
        <testcase name="deposit_increases_wallet_balance" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="59" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="2" time="0.091020"/>
        <testcase name="unlock_funds_throws_exception_for_zero_amount" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="260" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="2" time="0.087026"/>
        <testcase name="withdraw_with_lock_moves_funds_to_locked_balance" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="185" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="1" time="0.069973">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\WalletServiceTest::withdraw_with_lock_moves_funds_to_locked_balance&#13;
Failed asserting that 997 matches expected 700.0.
&#13;
C:\PreIPO\backend\tests\Unit\WalletServiceTest.php:199</failure>
        </testcase>
        <testcase name="lock_funds_increases_locked_balance" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="226" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="2" time="0.079948">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\WalletServiceTest::lock_funds_increases_locked_balance&#13;
Failed asserting that 3 matches expected 300.0.
&#13;
C:\PreIPO\backend\tests\Unit\WalletServiceTest.php:234</failure>
        </testcase>
        <testcase name="deposit_throws_exception_for_negative_amount" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="105" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="2" time="0.086829"/>
        <testcase name="withdraw_throws_exception_for_insufficient_funds" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="164" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="1" time="0.067505">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\WalletServiceTest::withdraw_throws_exception_for_insufficient_funds&#13;
Failed asserting that exception of type "Exception" is thrown.</failure>
        </testcase>
        <testcase name="transaction_records_are_immutable" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="324" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="1" time="0.092922">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\WalletServiceTest::transaction_records_are_immutable&#13;
Failed asserting that a row in the table [transactions] matches the attributes {
    "id": 1445,
    "amount_paise": 10000
}.

Found similar results: [
    {
        "id": 1445,
        "amount_paise": 100
    }
].
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithDatabase.php:36
C:\PreIPO\backend\tests\Unit\WalletServiceTest.php:329</failure>
        </testcase>
        <testcase name="withdraw_throws_exception_for_zero_amount" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="174" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="2" time="0.085781"/>
        <testcase name="withdraw_without_lock_immediately_debits" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="205" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="1" time="0.070077">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\WalletServiceTest::withdraw_without_lock_immediately_debits&#13;
Failed asserting that 997 matches expected 700.0.
&#13;
C:\PreIPO\backend\tests\Unit\WalletServiceTest.php:219</failure>
        </testcase>
        <testcase name="multiple_operations_maintain_correct_running_balance" file="C:\PreIPO\backend\tests\Unit\WalletServiceTest.php" line="366" class="Tests\Unit\WalletServiceTest" classname="Tests.Unit.WalletServiceTest" assertions="2" time="0.088956">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\WalletServiceTest::multiple_operations_maintain_correct_running_balance&#13;
Failed asserting that 10 matches expected 1000.
&#13;
C:\PreIPO\backend\tests\Unit\WalletServiceTest.php:371</failure>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Unit\LuckyDrawServiceTest" file="C:\PreIPO\backend\tests\Unit\LuckyDrawServiceTest.php" tests="6" assertions="3" errors="3" failures="2" skipped="0" time="5.417184">
        <testcase name="test_allocate_bonus_entries_for_streaks" file="C:\PreIPO\backend\tests\Unit\LuckyDrawServiceTest.php" line="74" class="Tests\Unit\LuckyDrawServiceTest" classname="Tests.Unit.LuckyDrawServiceTest" assertions="1" time="0.848331">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\LuckyDrawServiceTest::test_allocate_bonus_entries_for_streaks&#13;
Failed asserting that a row in the table [lucky_draw_entries] matches the attributes {
    "user_id": 17794,
    "lucky_draw_id": 204,
    "base_entries": 5,
    "bonus_entries": 6
}.

Found: [
    {
        "user_id": 17795,
        "lucky_draw_id": 204,
        "base_entries": 5,
        "bonus_entries": 6
    }
].
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithDatabase.php:36
C:\PreIPO\backend\tests\Unit\LuckyDrawServiceTest.php:88</failure>
        </testcase>
        <testcase name="test_select_winners_uses_weighted_random" file="C:\PreIPO\backend\tests\Unit\LuckyDrawServiceTest.php" line="97" class="Tests\Unit\LuckyDrawServiceTest" classname="Tests.Unit.LuckyDrawServiceTest" assertions="0" time="0.863819">
          <error type="Illuminate\Database\QueryException">Tests\Unit\LuckyDrawServiceTest::test_select_winners_uses_weighted_random&#13;
Illuminate\Database\QueryException: SQLSTATE[23000]: Integrity constraint violation: 1452 Cannot add or update a child row: a foreign key constraint fails (`preipo_test`.`lucky_draw_entries`, CONSTRAINT `lucky_draw_entries_payment_id_foreign` FOREIGN KEY (`payment_id`) REFERENCES `payments` (`id`) ON DELETE CASCADE) (Connection: mysql, SQL: insert into `lucky_draw_entries` (`user_id`, `lucky_draw_id`, `payment_id`, `base_entries`, `updated_at`, `created_at`) values (17810, 205, 1, 100, 2026-02-22 10:38:31, 2026-02-22 10:38:31))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\LuckyDrawServiceTest.php:101</error>
        </testcase>
        <testcase name="test_send_winner_notifications" file="C:\PreIPO\backend\tests\Unit\LuckyDrawServiceTest.php" line="146" class="Tests\Unit\LuckyDrawServiceTest" classname="Tests.Unit.LuckyDrawServiceTest" assertions="0" time="0.828410">
          <error type="Error">Tests\Unit\LuckyDrawServiceTest::test_send_winner_notifications&#13;
Error: Class "Tests\Unit\Log" not found
&#13;
C:\PreIPO\backend\tests\Unit\LuckyDrawServiceTest.php:148</error>
        </testcase>
        <testcase name="test_allocate_entries_based_on_plan" file="C:\PreIPO\backend\tests\Unit\LuckyDrawServiceTest.php" line="55" class="Tests\Unit\LuckyDrawServiceTest" classname="Tests.Unit.LuckyDrawServiceTest" assertions="1" time="0.979785">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\LuckyDrawServiceTest::test_allocate_entries_based_on_plan&#13;
Failed asserting that a row in the table [lucky_draw_entries] matches the attributes {
    "user_id": 17818,
    "lucky_draw_id": 207,
    "base_entries": 5,
    "bonus_entries": 0
}.

Found: [
    {
        "user_id": 17819,
        "lucky_draw_id": 207,
        "base_entries": 5,
        "bonus_entries": 0
    }
].
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithDatabase.php:36
C:\PreIPO\backend\tests\Unit\LuckyDrawServiceTest.php:65</failure>
        </testcase>
        <testcase name="test_create_monthly_draw_sets_correct_date" file="C:\PreIPO\backend\tests\Unit\LuckyDrawServiceTest.php" line="45" class="Tests\Unit\LuckyDrawServiceTest" classname="Tests.Unit.LuckyDrawServiceTest" assertions="1" time="0.974990"/>
        <testcase name="test_distribute_prizes_to_wallets" file="C:\PreIPO\backend\tests\Unit\LuckyDrawServiceTest.php" line="121" class="Tests\Unit\LuckyDrawServiceTest" classname="Tests.Unit.LuckyDrawServiceTest" assertions="0" time="0.921848">
          <error type="Illuminate\Database\QueryException">Tests\Unit\LuckyDrawServiceTest::test_distribute_prizes_to_wallets&#13;
Illuminate\Database\QueryException: SQLSTATE[23000]: Integrity constraint violation: 1452 Cannot add or update a child row: a foreign key constraint fails (`preipo_test`.`lucky_draw_entries`, CONSTRAINT `lucky_draw_entries_payment_id_foreign` FOREIGN KEY (`payment_id`) REFERENCES `payments` (`id`) ON DELETE CASCADE) (Connection: mysql, SQL: insert into `lucky_draw_entries` (`user_id`, `lucky_draw_id`, `payment_id`, `base_entries`, `updated_at`, `created_at`) values (17824, 209, 1, 1, 2026-02-22 10:38:35, 2026-02-22 10:38:35))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\LuckyDrawServiceTest.php:125</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Unit\XssPreventionTest" file="C:\PreIPO\backend\tests\Unit\XssPreventionTest.php" tests="1" assertions="2" errors="0" failures="0" skipped="0" time="0.085924">
        <testcase name="testXssPreventionInInputs" file="C:\PreIPO\backend\tests\Unit\XssPreventionTest.php" line="42" class="Tests\Unit\XssPreventionTest" classname="Tests.Unit.XssPreventionTest" assertions="2" time="0.085924"/>
      </testsuite>
      <testsuite name="Tests\Unit\BonusTransactionTest" file="C:\PreIPO\backend\tests\Unit\BonusTransactionTest.php" tests="8" assertions="13" errors="0" failures="0" skipped="0" time="0.748509">
        <testcase name="test_bonus_belongs_to_user" file="C:\PreIPO\backend\tests\Unit\BonusTransactionTest.php" line="28" class="Tests\Unit\BonusTransactionTest" classname="Tests.Unit.BonusTransactionTest" assertions="2" time="0.099058"/>
        <testcase name="test_bonus_belongs_to_payment" file="C:\PreIPO\backend\tests\Unit\BonusTransactionTest.php" line="56" class="Tests\Unit\BonusTransactionTest" classname="Tests.Unit.BonusTransactionTest" assertions="2" time="0.079197"/>
        <testcase name="test_bonus_tracks_multiplier_applied" file="C:\PreIPO\backend\tests\Unit\BonusTransactionTest.php" line="91" class="Tests\Unit\BonusTransactionTest" classname="Tests.Unit.BonusTransactionTest" assertions="1" time="0.074866"/>
        <testcase name="test_bonus_type_enum_validates" file="C:\PreIPO\backend\tests\Unit\BonusTransactionTest.php" line="71" class="Tests\Unit\BonusTransactionTest" classname="Tests.Unit.BonusTransactionTest" assertions="2" time="0.095406"/>
        <testcase name="test_bonus_can_be_reversed" file="C:\PreIPO\backend\tests\Unit\BonusTransactionTest.php" line="137" class="Tests\Unit\BonusTransactionTest" classname="Tests.Unit.BonusTransactionTest" assertions="2" time="0.074306"/>
        <testcase name="test_bonus_calculates_effective_amount" file="C:\PreIPO\backend\tests\Unit\BonusTransactionTest.php" line="119" class="Tests\Unit\BonusTransactionTest" classname="Tests.Unit.BonusTransactionTest" assertions="1" time="0.088303"/>
        <testcase name="test_bonus_tracks_base_amount" file="C:\PreIPO\backend\tests\Unit\BonusTransactionTest.php" line="105" class="Tests\Unit\BonusTransactionTest" classname="Tests.Unit.BonusTransactionTest" assertions="1" time="0.093897"/>
        <testcase name="test_bonus_belongs_to_subscription" file="C:\PreIPO\backend\tests\Unit\BonusTransactionTest.php" line="42" class="Tests\Unit\BonusTransactionTest" classname="Tests.Unit.BonusTransactionTest" assertions="2" time="0.143476"/>
      </testsuite>
      <testsuite name="Tests\Unit\ActivityLogTest" file="C:\PreIPO\backend\tests\Unit\ActivityLogTest.php" tests="6" assertions="9" errors="1" failures="0" skipped="0" time="0.573076">
        <testcase name="test_log_stores_old_and_new_values" file="C:\PreIPO\backend\tests\Unit\ActivityLogTest.php" line="70" class="Tests\Unit\ActivityLogTest" classname="Tests.Unit.ActivityLogTest" assertions="4" time="0.092101"/>
        <testcase name="test_log_tracks_ip_address" file="C:\PreIPO\backend\tests\Unit\ActivityLogTest.php" line="45" class="Tests\Unit\ActivityLogTest" classname="Tests.Unit.ActivityLogTest" assertions="1" time="0.104328"/>
        <testcase name="test_log_tracks_action_type" file="C:\PreIPO\backend\tests\Unit\ActivityLogTest.php" line="34" class="Tests\Unit\ActivityLogTest" classname="Tests.Unit.ActivityLogTest" assertions="1" time="0.092924"/>
        <testcase name="test_log_tracks_user_agent" file="C:\PreIPO\backend\tests\Unit\ActivityLogTest.php" line="57" class="Tests\Unit\ActivityLogTest" classname="Tests.Unit.ActivityLogTest" assertions="1" time="0.077932"/>
        <testcase name="test_log_filters_by_date_range" file="C:\PreIPO\backend\tests\Unit\ActivityLogTest.php" line="92" class="Tests\Unit\ActivityLogTest" classname="Tests.Unit.ActivityLogTest" assertions="0" time="0.131715">
          <error type="Illuminate\Database\QueryException">Tests\Unit\ActivityLogTest::test_log_filters_by_date_range&#13;
Illuminate\Database\QueryException: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'properties' in 'field list' (Connection: mysql, SQL: insert into `activity_logs` (`user_id`, `action`, `description`, `ip_address`, `user_agent`, `properties`, `created_at`) values (17861, login, User logged in, 43.150.244.213, Mozilla/5.0 (Macintosh; U; PPC Mac OS X 10_7_5 rv:4.0) Gecko/20160806 Firefox/37.0, {"timestamp":"2026-02-22T10:38:36.762948Z","additional_info":"Nobis eius et tenetur fugiat."}, 2026-02-17 10:38:36))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
C:\PreIPO\backend\tests\Unit\ActivityLogTest.php:95</error>
        </testcase>
        <testcase name="test_log_belongs_to_user" file="C:\PreIPO\backend\tests\Unit\ActivityLogTest.php" line="22" class="Tests\Unit\ActivityLogTest" classname="Tests.Unit.ActivityLogTest" assertions="2" time="0.074078"/>
      </testsuite>
      <testsuite name="Tests\Unit\UserKycTest" file="C:\PreIPO\backend\tests\Unit\UserKycTest.php" tests="10" assertions="20" errors="0" failures="1" skipped="0" time="0.854233">
        <testcase name="test_kyc_marks_as_complete_when_all_docs_present" file="C:\PreIPO\backend\tests\Unit\UserKycTest.php" line="130" class="Tests\Unit\UserKycTest" classname="Tests.Unit.UserKycTest" assertions="1" time="0.084222"/>
        <testcase name="test_aadhaar_number_format_validates" file="C:\PreIPO\backend\tests\Unit\UserKycTest.php" line="161" class="Tests\Unit\UserKycTest" classname="Tests.Unit.UserKycTest" assertions="1" time="0.083493">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\UserKycTest::test_aadhaar_number_format_validates&#13;
Failed asserting that '123456789012' matches PCRE pattern "/^[2-9]{1}[0-9]{3}\s[0-9]{4}\s[0-9]{4}$|^[2-9]{1}[0-9]{11}$/".
&#13;
C:\PreIPO\backend\tests\Unit\UserKycTest.php:164</failure>
        </testcase>
        <testcase name="test_kyc_checks_all_documents_uploaded" file="C:\PreIPO\backend\tests\Unit\UserKycTest.php" line="114" class="Tests\Unit\UserKycTest" classname="Tests.Unit.UserKycTest" assertions="1" time="0.072665"/>
        <testcase name="test_kyc_belongs_to_user" file="C:\PreIPO\backend\tests\Unit\UserKycTest.php" line="20" class="Tests\Unit\UserKycTest" classname="Tests.Unit.UserKycTest" assertions="2" time="0.076968"/>
        <testcase name="test_pan_number_format_validates" file="C:\PreIPO\backend\tests\Unit\UserKycTest.php" line="149" class="Tests\Unit\UserKycTest" classname="Tests.Unit.UserKycTest" assertions="4" time="0.085242"/>
        <testcase name="test_kyc_can_be_approved" file="C:\PreIPO\backend\tests\Unit\UserKycTest.php" line="60" class="Tests\Unit\UserKycTest" classname="Tests.Unit.UserKycTest" assertions="2" time="0.102476"/>
        <testcase name="test_kyc_has_documents_relationship" file="C:\PreIPO\backend\tests\Unit\UserKycTest.php" line="30" class="Tests\Unit\UserKycTest" classname="Tests.Unit.UserKycTest" assertions="2" time="0.070954"/>
        <testcase name="test_kyc_can_be_rejected_with_reason" file="C:\PreIPO\backend\tests\Unit\UserKycTest.php" line="72" class="Tests\Unit\UserKycTest" classname="Tests.Unit.UserKycTest" assertions="2" time="0.098730"/>
        <testcase name="test_verification_status_enum_validates" file="C:\PreIPO\backend\tests\Unit\UserKycTest.php" line="48" class="Tests\Unit\UserKycTest" classname="Tests.Unit.UserKycTest" assertions="3" time="0.101410"/>
        <testcase name="test_kyc_calculates_completion_percentage" file="C:\PreIPO\backend\tests\Unit\UserKycTest.php" line="87" class="Tests\Unit\UserKycTest" classname="Tests.Unit.UserKycTest" assertions="2" time="0.078074"/>
      </testsuite>
      <testsuite name="Tests\Unit\ProductTest" file="C:\PreIPO\backend\tests\Unit\ProductTest.php" tests="8" assertions="12" errors="2" failures="0" skipped="0" time="0.820935">
        <testcase name="test_product_has_price_history_relationship" file="C:\PreIPO\backend\tests\Unit\ProductTest.php" line="43" class="Tests\Unit\ProductTest" classname="Tests.Unit.ProductTest" assertions="2" time="0.121507"/>
        <testcase name="test_product_status_enum_validates" file="C:\PreIPO\backend\tests\Unit\ProductTest.php" line="73" class="Tests\Unit\ProductTest" classname="Tests.Unit.ProductTest" assertions="2" time="0.087715"/>
        <testcase name="test_product_slug_is_unique" file="C:\PreIPO\backend\tests\Unit\ProductTest.php" line="56" class="Tests\Unit\ProductTest" classname="Tests.Unit.ProductTest" assertions="1" time="0.068461"/>
        <testcase name="test_product_soft_deletes_correctly" file="C:\PreIPO\backend\tests\Unit\ProductTest.php" line="99" class="Tests\Unit\ProductTest" classname="Tests.Unit.ProductTest" assertions="2" time="0.072730"/>
        <testcase name="test_product_has_bulk_purchases_relationship" file="C:\PreIPO\backend\tests\Unit\ProductTest.php" line="26" class="Tests\Unit\ProductTest" classname="Tests.Unit.ProductTest" assertions="2" time="0.119802"/>
        <testcase name="test_product_validates_face_value_positive" file="C:\PreIPO\backend\tests\Unit\ProductTest.php" line="64" class="Tests\Unit\ProductTest" classname="Tests.Unit.ProductTest" assertions="2" time="0.106418"/>
        <testcase name="test_product_calculates_total_allocated" file="C:\PreIPO\backend\tests\Unit\ProductTest.php" line="85" class="Tests\Unit\ProductTest" classname="Tests.Unit.ProductTest" assertions="1" time="0.119092">
          <error type="Illuminate\Database\QueryException">Tests\Unit\ProductTest::test_product_calculates_total_allocated&#13;
Illuminate\Database\QueryException: SQLSTATE[23000]: Integrity constraint violation: 1048 Column 'payment_id' cannot be null (Connection: mysql, SQL: insert into `user_investments` (`user_id`, `product_id`, `payment_id`, `subscription_id`, `bulk_purchase_id`, `shares`, `price_per_share`, `total_amount`, `units_allocated`, `value_allocated`, `source`, `status`, `allocated_at`, `exited_at`, `is_reversed`, `updated_at`, `created_at`) values (17897, 2700, ?, 3926, 737, 893, 480.53, 429113.29, 893, 5000, sip, active, 2026-02-22 10:38:38, ?, 0, 2026-02-22 10:38:38, 2026-02-22 10:38:38))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
C:\PreIPO\backend\tests\Unit\ProductTest.php:91</error>
        </testcase>
        <testcase name="test_product_has_investments_relationship" file="C:\PreIPO\backend\tests\Unit\ProductTest.php" line="35" class="Tests\Unit\ProductTest" classname="Tests.Unit.ProductTest" assertions="0" time="0.125210">
          <error type="Illuminate\Database\QueryException">Tests\Unit\ProductTest::test_product_has_investments_relationship&#13;
Illuminate\Database\QueryException: SQLSTATE[23000]: Integrity constraint violation: 1048 Column 'payment_id' cannot be null (Connection: mysql, SQL: insert into `user_investments` (`user_id`, `product_id`, `payment_id`, `subscription_id`, `bulk_purchase_id`, `shares`, `price_per_share`, `total_amount`, `units_allocated`, `value_allocated`, `source`, `status`, `allocated_at`, `exited_at`, `is_reversed`, `updated_at`, `created_at`) values (17902, 2702, ?, 3927, 738, 646, 1789.57, 1156062.22, 646, 1156062.22, sip, active, 2026-02-22 10:38:38, ?, 0, 2026-02-22 10:38:38, 2026-02-22 10:38:38))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
C:\PreIPO\backend\tests\Unit\ProductTest.php:37</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Unit\ReferralServiceTest" file="C:\PreIPO\backend\tests\Unit\ReferralServiceTest.php" tests="8" assertions="10" errors="2" failures="0" skipped="0" time="2.848024">
        <testcase name="test_referral_multiplier_3x_for_20_plus_referrals" file="C:\PreIPO\backend\tests\Unit\ReferralServiceTest.php" line="94" class="Tests\Unit\ReferralServiceTest" classname="Tests.Unit.ReferralServiceTest" assertions="1" time="0.443264"/>
        <testcase name="test_referral_multiplier_updates_on_referral_count_change" file="C:\PreIPO\backend\tests\Unit\ReferralServiceTest.php" line="102" class="Tests\Unit\ReferralServiceTest" classname="Tests.Unit.ReferralServiceTest" assertions="2" time="0.341807"/>
        <testcase name="test_referral_multiplier_2_5x_for_10_to_19_referrals" file="C:\PreIPO\backend\tests\Unit\ReferralServiceTest.php" line="86" class="Tests\Unit\ReferralServiceTest" classname="Tests.Unit.ReferralServiceTest" assertions="1" time="0.333895"/>
        <testcase name="test_referral_multiplier_1x_for_0_to_2_referrals" file="C:\PreIPO\backend\tests\Unit\ReferralServiceTest.php" line="51" class="Tests\Unit\ReferralServiceTest" classname="Tests.Unit.ReferralServiceTest" assertions="2" time="0.317603"/>
        <testcase name="test_referral_multiplier_varies_by_plan" file="C:\PreIPO\backend\tests\Unit\ReferralServiceTest.php" line="143" class="Tests\Unit\ReferralServiceTest" classname="Tests.Unit.ReferralServiceTest" assertions="1" time="0.395754">
          <error type="TypeError">Tests\Unit\ReferralServiceTest::test_referral_multiplier_varies_by_plan&#13;
TypeError: json_decode(): Argument #1 ($json) must be of type string, array given
&#13;
C:\PreIPO\backend\app\Services\ReferralService.php:54
C:\PreIPO\backend\tests\Unit\ReferralServiceTest.php:163</error>
        </testcase>
        <testcase name="test_referral_multiplier_2x_for_5_to_9_referrals" file="C:\PreIPO\backend\tests\Unit\ReferralServiceTest.php" line="78" class="Tests\Unit\ReferralServiceTest" classname="Tests.Unit.ReferralServiceTest" assertions="1" time="0.344661"/>
        <testcase name="test_referral_multiplier_uses_configured_tiers" file="C:\PreIPO\backend\tests\Unit\ReferralServiceTest.php" line="118" class="Tests\Unit\ReferralServiceTest" classname="Tests.Unit.ReferralServiceTest" assertions="0" time="0.325916">
          <error type="TypeError">Tests\Unit\ReferralServiceTest::test_referral_multiplier_uses_configured_tiers&#13;
TypeError: json_decode(): Argument #1 ($json) must be of type string, array given
&#13;
C:\PreIPO\backend\app\Services\ReferralService.php:54
C:\PreIPO\backend\tests\Unit\ReferralServiceTest.php:136</error>
        </testcase>
        <testcase name="test_referral_multiplier_1_5x_for_3_to_4_referrals" file="C:\PreIPO\backend\tests\Unit\ReferralServiceTest.php" line="64" class="Tests\Unit\ReferralServiceTest" classname="Tests.Unit.ReferralServiceTest" assertions="2" time="0.345124"/>
      </testsuite>
      <testsuite name="Tests\Unit\DealTierGateTest" file="C:\PreIPO\backend\tests\Unit\DealTierGateTest.php" tests="18" assertions="16" errors="13" failures="0" skipped="0" time="1.990029">
        <testcase name="test_featuring_exception_shows_correct_operation" file="C:\PreIPO\backend\tests\Unit\DealTierGateTest.php" line="291" class="Tests\Unit\DealTierGateTest" classname="Tests.Unit.DealTierGateTest" assertions="0" time="0.139158">
          <error type="DomainException">Tests\Unit\DealTierGateTest::test_featuring_exception_shows_correct_operation&#13;
DomainException: Cannot create deal: No inventory available for product 'GreenEnergy velit' (ID: 2704). Create a BulkPurchase with inventory first. INVARIANT: Deals must have backing inventory.
&#13;
C:\PreIPO\backend\app\Models\Deal.php:221
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:79
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:295</error>
        </testcase>
        <testcase name="test_draft_deal_at_tier_1_can_be_saved" file="C:\PreIPO\backend\tests\Unit\DealTierGateTest.php" line="326" class="Tests\Unit\DealTierGateTest" classname="Tests.Unit.DealTierGateTest" assertions="0" time="0.107716">
          <error type="DomainException">Tests\Unit\DealTierGateTest::test_draft_deal_at_tier_1_can_be_saved&#13;
DomainException: Cannot create deal: No inventory available for product 'DataPro velit' (ID: 2705). Create a BulkPurchase with inventory first. INVARIANT: Deals must have backing inventory.
&#13;
C:\PreIPO\backend\app\Models\Deal.php:221
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:79
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:330</error>
        </testcase>
        <testcase name="test_deal_creation_blocked_for_tier_0_pending" file="C:\PreIPO\backend\tests\Unit\DealTierGateTest.php" line="87" class="Tests\Unit\DealTierGateTest" classname="Tests.Unit.DealTierGateTest" assertions="2" time="0.075502"/>
        <testcase name="test_deal_creation_allowed_for_tier_1_upcoming" file="C:\PreIPO\backend\tests\Unit\DealTierGateTest.php" line="98" class="Tests\Unit\DealTierGateTest" classname="Tests.Unit.DealTierGateTest" assertions="0" time="0.100141">
          <error type="DomainException">Tests\Unit\DealTierGateTest::test_deal_creation_allowed_for_tier_1_upcoming&#13;
DomainException: Cannot create deal: No inventory available for product 'CloudNine fuga' (ID: 2707). Create a BulkPurchase with inventory first. INVARIANT: Deals must have backing inventory.
&#13;
C:\PreIPO\backend\app\Models\Deal.php:221
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:79
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:102</error>
        </testcase>
        <testcase name="test_deal_activation_blocked_for_tier_1_upcoming" file="C:\PreIPO\backend\tests\Unit\DealTierGateTest.php" line="147" class="Tests\Unit\DealTierGateTest" classname="Tests.Unit.DealTierGateTest" assertions="0" time="0.076401">
          <error type="DomainException">Tests\Unit\DealTierGateTest::test_deal_activation_blocked_for_tier_1_upcoming&#13;
DomainException: Cannot create deal: No inventory available for product 'TechStart et' (ID: 2708). Create a BulkPurchase with inventory first. INVARIANT: Deals must have backing inventory.
&#13;
C:\PreIPO\backend\app\Models\Deal.php:221
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:79
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:152</error>
        </testcase>
        <testcase name="test_tier_gate_exception_has_context" file="C:\PreIPO\backend\tests\Unit\DealTierGateTest.php" line="252" class="Tests\Unit\DealTierGateTest" classname="Tests.Unit.DealTierGateTest" assertions="8" time="0.100156"/>
        <testcase name="test_deal_update_to_featured_blocked_for_tier_2" file="C:\PreIPO\backend\tests\Unit\DealTierGateTest.php" line="234" class="Tests\Unit\DealTierGateTest" classname="Tests.Unit.DealTierGateTest" assertions="0" time="0.130695">
          <error type="DomainException">Tests\Unit\DealTierGateTest::test_deal_update_to_featured_blocked_for_tier_2&#13;
DomainException: Cannot create deal: No inventory available for product 'HealthFirst quia' (ID: 2710). Create a BulkPurchase with inventory first. INVARIANT: Deals must have backing inventory.
&#13;
C:\PreIPO\backend\app\Models\Deal.php:221
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:79
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:238</error>
        </testcase>
        <testcase name="test_deal_creation_allowed_for_tier_3_featured" file="C:\PreIPO\backend\tests\Unit\DealTierGateTest.php" line="120" class="Tests\Unit\DealTierGateTest" classname="Tests.Unit.DealTierGateTest" assertions="0" time="0.093635">
          <error type="DomainException">Tests\Unit\DealTierGateTest::test_deal_creation_allowed_for_tier_3_featured&#13;
DomainException: Cannot create deal: No inventory available for product 'HealthFirst qui' (ID: 2711). Create a BulkPurchase with inventory first. INVARIANT: Deals must have backing inventory.
&#13;
C:\PreIPO\backend\app\Models\Deal.php:221
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:79
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:124</error>
        </testcase>
        <testcase name="test_deal_activation_blocked_for_tier_0_pending" file="C:\PreIPO\backend\tests\Unit\DealTierGateTest.php" line="135" class="Tests\Unit\DealTierGateTest" classname="Tests.Unit.DealTierGateTest" assertions="2" time="0.270214"/>
        <testcase name="test_non_featured_deal_at_tier_2_can_be_saved" file="C:\PreIPO\backend\tests\Unit\DealTierGateTest.php" line="311" class="Tests\Unit\DealTierGateTest" classname="Tests.Unit.DealTierGateTest" assertions="0" time="0.104844">
          <error type="DomainException">Tests\Unit\DealTierGateTest::test_non_featured_deal_at_tier_2_can_be_saved&#13;
DomainException: Cannot create deal: No inventory available for product 'SmartSolutions laborum' (ID: 2713). Create a BulkPurchase with inventory first. INVARIANT: Deals must have backing inventory.
&#13;
C:\PreIPO\backend\app\Models\Deal.php:221
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:79
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:315</error>
        </testcase>
        <testcase name="test_deal_creation_allowed_for_tier_2_live" file="C:\PreIPO\backend\tests\Unit\DealTierGateTest.php" line="109" class="Tests\Unit\DealTierGateTest" classname="Tests.Unit.DealTierGateTest" assertions="0" time="0.078370">
          <error type="DomainException">Tests\Unit\DealTierGateTest::test_deal_creation_allowed_for_tier_2_live&#13;
DomainException: Cannot create deal: No inventory available for product 'HealthFirst tempore' (ID: 2714). Create a BulkPurchase with inventory first. INVARIANT: Deals must have backing inventory.
&#13;
C:\PreIPO\backend\app\Models\Deal.php:221
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:79
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:113</error>
        </testcase>
        <testcase name="test_deal_activation_allowed_for_tier_2_live" file="C:\PreIPO\backend\tests\Unit\DealTierGateTest.php" line="162" class="Tests\Unit\DealTierGateTest" classname="Tests.Unit.DealTierGateTest" assertions="0" time="0.106257">
          <error type="DomainException">Tests\Unit\DealTierGateTest::test_deal_activation_allowed_for_tier_2_live&#13;
DomainException: Cannot create deal: No inventory available for product 'GreenEnergy eius' (ID: 2715). Create a BulkPurchase with inventory first. INVARIANT: Deals must have backing inventory.
&#13;
C:\PreIPO\backend\app\Models\Deal.php:221
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:79
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:166</error>
        </testcase>
        <testcase name="test_deal_status_update_to_active_blocked_for_tier_1" file="C:\PreIPO\backend\tests\Unit\DealTierGateTest.php" line="182" class="Tests\Unit\DealTierGateTest" classname="Tests.Unit.DealTierGateTest" assertions="0" time="0.100014">
          <error type="DomainException">Tests\Unit\DealTierGateTest::test_deal_status_update_to_active_blocked_for_tier_1&#13;
DomainException: Cannot create deal: No inventory available for product 'SmartSolutions dolore' (ID: 2716). Create a BulkPurchase with inventory first. INVARIANT: Deals must have backing inventory.
&#13;
C:\PreIPO\backend\app\Models\Deal.php:221
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:79
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:186</error>
        </testcase>
        <testcase name="test_activation_exception_shows_correct_operation" file="C:\PreIPO\backend\tests\Unit\DealTierGateTest.php" line="275" class="Tests\Unit\DealTierGateTest" classname="Tests.Unit.DealTierGateTest" assertions="0" time="0.121608">
          <error type="DomainException">Tests\Unit\DealTierGateTest::test_activation_exception_shows_correct_operation&#13;
DomainException: Cannot create deal: No inventory available for product 'EduLearn voluptatem' (ID: 2717). Create a BulkPurchase with inventory first. INVARIANT: Deals must have backing inventory.
&#13;
C:\PreIPO\backend\app\Models\Deal.php:221
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:79
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:279</error>
        </testcase>
        <testcase name="test_deal_featuring_blocked_for_tier_1_upcoming" file="C:\PreIPO\backend\tests\Unit\DealTierGateTest.php" line="200" class="Tests\Unit\DealTierGateTest" classname="Tests.Unit.DealTierGateTest" assertions="2" time="0.103615"/>
        <testcase name="test_deal_activation_allowed_for_tier_3_featured" file="C:\PreIPO\backend\tests\Unit\DealTierGateTest.php" line="172" class="Tests\Unit\DealTierGateTest" classname="Tests.Unit.DealTierGateTest" assertions="0" time="0.101320">
          <error type="DomainException">Tests\Unit\DealTierGateTest::test_deal_activation_allowed_for_tier_3_featured&#13;
DomainException: Cannot create deal: No inventory available for product 'SmartSolutions veritatis' (ID: 2719). Create a BulkPurchase with inventory first. INVARIANT: Deals must have backing inventory.
&#13;
C:\PreIPO\backend\app\Models\Deal.php:221
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:79
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:176</error>
        </testcase>
        <testcase name="test_deal_featuring_allowed_for_tier_3_featured" file="C:\PreIPO\backend\tests\Unit\DealTierGateTest.php" line="224" class="Tests\Unit\DealTierGateTest" classname="Tests.Unit.DealTierGateTest" assertions="0" time="0.092790">
          <error type="DomainException">Tests\Unit\DealTierGateTest::test_deal_featuring_allowed_for_tier_3_featured&#13;
DomainException: Cannot create deal: No inventory available for product 'CloudNine non' (ID: 2720). Create a BulkPurchase with inventory first. INVARIANT: Deals must have backing inventory.
&#13;
C:\PreIPO\backend\app\Models\Deal.php:221
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:79
C:\PreIPO\backend\tests\Unit\DealTierGateTest.php:228</error>
        </testcase>
        <testcase name="test_deal_featuring_blocked_for_tier_2_live" file="C:\PreIPO\backend\tests\Unit\DealTierGateTest.php" line="212" class="Tests\Unit\DealTierGateTest" classname="Tests.Unit.DealTierGateTest" assertions="2" time="0.087594"/>
      </testsuite>
      <testsuite name="Tests\Unit\ExampleTest" file="C:\PreIPO\backend\tests\Unit\ExampleTest.php" tests="1" assertions="1" errors="0" failures="0" skipped="0" time="0.098947">
        <testcase name="test_database_name" file="C:\PreIPO\backend\tests\Unit\ExampleTest.php" line="18" class="Tests\Unit\ExampleTest" classname="Tests.Unit.ExampleTest" assertions="1" time="0.098947"/>
      </testsuite>
      <testsuite name="Tests\Unit\SettingTest" file="C:\PreIPO\backend\tests\Unit\SettingTest.php" tests="8" assertions="19" errors="0" failures="1" skipped="0" time="2.362317">
        <testcase name="test_setting_returns_default_if_not_found" file="C:\PreIPO\backend\tests\Unit\SettingTest.php" line="85" class="Tests\Unit\SettingTest" classname="Tests.Unit.SettingTest" assertions="1" time="0.268278"/>
        <testcase name="test_setting_tracks_updated_by_admin" file="C:\PreIPO\backend\tests\Unit\SettingTest.php" line="120" class="Tests\Unit\SettingTest" classname="Tests.Unit.SettingTest" assertions="2" time="0.332505">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\SettingTest::test_setting_tracks_updated_by_admin&#13;
Failed asserting that a row in the table [settings] matches the attributes {
    "key": "audit_test",
    "value": "updated",
    "updated_by": 17988
}.

Found similar results: [
    {
        "key": "audit_test",
        "value": "initial",
        "updated_by": null
    }
].
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithDatabase.php:36
C:\PreIPO\backend\tests\Unit\SettingTest.php:133</failure>
        </testcase>
        <testcase name="test_setting_key_is_unique" file="C:\PreIPO\backend\tests\Unit\SettingTest.php" line="29" class="Tests\Unit\SettingTest" classname="Tests.Unit.SettingTest" assertions="1" time="0.304590"/>
        <testcase name="test_setting_value_casts_by_type" file="C:\PreIPO\backend\tests\Unit\SettingTest.php" line="39" class="Tests\Unit\SettingTest" classname="Tests.Unit.SettingTest" assertions="5" time="0.301413"/>
        <testcase name="test_setting_retrieves_by_key" file="C:\PreIPO\backend\tests\Unit\SettingTest.php" line="77" class="Tests\Unit\SettingTest" classname="Tests.Unit.SettingTest" assertions="1" time="0.282422"/>
        <testcase name="test_setting_type_enum_validates" file="C:\PreIPO\backend\tests\Unit\SettingTest.php" line="59" class="Tests\Unit\SettingTest" classname="Tests.Unit.SettingTest" assertions="2" time="0.305749"/>
        <testcase name="test_setting_boolean_type_converts_correctly" file="C:\PreIPO\backend\tests\Unit\SettingTest.php" line="106" class="Tests\Unit\SettingTest" classname="Tests.Unit.SettingTest" assertions="4" time="0.300354"/>
        <testcase name="test_setting_json_type_decodes_correctly" file="C:\PreIPO\backend\tests\Unit\SettingTest.php" line="93" class="Tests\Unit\SettingTest" classname="Tests.Unit.SettingTest" assertions="3" time="0.267006"/>
      </testsuite>
      <testsuite name="Tests\Unit\BonusCalculatorTest" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorTest.php" tests="4" assertions="0" errors="4" failures="0" skipped="0" time="1.462121">
        <testcase name="it_multiplies_bonuses_based_on_referral_tier" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorTest.php" line="72" class="Tests\Unit\BonusCalculatorTest" classname="Tests.Unit.BonusCalculatorTest" assertions="0" time="0.326681">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorTest::it_multiplies_bonuses_based_on_referral_tier&#13;
RuntimeException: Subscription #3937 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorTest.php:81</error>
        </testcase>
        <testcase name="it_does_not_award_progressive_bonus_before_start_month" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorTest.php" line="42" class="Tests\Unit\BonusCalculatorTest" classname="Tests.Unit.BonusCalculatorTest" assertions="0" time="0.445262">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorTest::it_does_not_award_progressive_bonus_before_start_month&#13;
RuntimeException: Subscription #3938 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorTest.php:48</error>
        </testcase>
        <testcase name="it_awards_correct_progressive_bonus_on_month_4" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorTest.php" line="56" class="Tests\Unit\BonusCalculatorTest" classname="Tests.Unit.BonusCalculatorTest" assertions="0" time="0.310683">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorTest::it_awards_correct_progressive_bonus_on_month_4&#13;
RuntimeException: Subscription #3939 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorTest.php:62</error>
        </testcase>
        <testcase name="it_awards_milestone_bonus_only_on_exact_month" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorTest.php" line="92" class="Tests\Unit\BonusCalculatorTest" classname="Tests.Unit.BonusCalculatorTest" assertions="0" time="0.379496">
          <error type="RuntimeException">Tests\Unit\BonusCalculatorTest::it_awards_milestone_bonus_only_on_exact_month&#13;
RuntimeException: Subscription #3940 does not have a valid bonus contract snapshot. Bonus calculation HALTED. This subscription requires remediation.
&#13;
C:\PreIPO\backend\app\Services\BonusCalculatorService.php:116
C:\PreIPO\backend\tests\Unit\BonusCalculatorTest.php:101</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Unit\NotificationServiceTest" file="C:\PreIPO\backend\tests\Unit\NotificationServiceTest.php" tests="7" assertions="8" errors="1" failures="0" skipped="0" time="1.958150">
        <testcase name="test_send_notification_logs_all_attempts" file="C:\PreIPO\backend\tests\Unit\NotificationServiceTest.php" line="110" class="Tests\Unit\NotificationServiceTest" classname="Tests.Unit.NotificationServiceTest" assertions="1" time="0.273609"/>
        <testcase name="test_send_notification_chooses_correct_channel" file="C:\PreIPO\backend\tests\Unit\NotificationServiceTest.php" line="26" class="Tests\Unit\NotificationServiceTest" classname="Tests.Unit.NotificationServiceTest" assertions="2" time="0.253864"/>
        <testcase name="test_send_notification_respects_user_preferences" file="C:\PreIPO\backend\tests\Unit\NotificationServiceTest.php" line="85" class="Tests\Unit\NotificationServiceTest" classname="Tests.Unit.NotificationServiceTest" assertions="0" time="0.281073">
          <error type="Illuminate\Database\QueryException">Tests\Unit\NotificationServiceTest::test_send_notification_respects_user_preferences&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1364 Field 'notification_type' doesn't have a default value (Connection: mysql, SQL: insert into `user_notification_preferences` (`user_id`, `updated_at`, `created_at`) values (18024, 2026-02-22 10:38:48, 2026-02-22 10:38:48))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\NotificationServiceTest.php:90</error>
        </testcase>
        <testcase name="test_send_notification_batches_bulk_sends" file="C:\PreIPO\backend\tests\Unit\NotificationServiceTest.php" line="58" class="Tests\Unit\NotificationServiceTest" classname="Tests.Unit.NotificationServiceTest" assertions="1" time="0.345802"/>
        <testcase name="test_send_notification_respects_priority" file="C:\PreIPO\backend\tests\Unit\NotificationServiceTest.php" line="41" class="Tests\Unit\NotificationServiceTest" classname="Tests.Unit.NotificationServiceTest" assertions="2" time="0.279983"/>
        <testcase name="test_send_notification_retries_on_failure" file="C:\PreIPO\backend\tests\Unit\NotificationServiceTest.php" line="78" class="Tests\Unit\NotificationServiceTest" classname="Tests.Unit.NotificationServiceTest" assertions="1" time="0.258684"/>
        <testcase name="test_send_notification_tracks_delivery_status" file="C:\PreIPO\backend\tests\Unit\NotificationServiceTest.php" line="70" class="Tests\Unit\NotificationServiceTest" classname="Tests.Unit.NotificationServiceTest" assertions="1" time="0.265135"/>
      </testsuite>
      <testsuite name="Tests\Unit\UserTest" file="C:\PreIPO\backend\tests\Unit\UserTest.php" tests="12" assertions="24" errors="0" failures="3" skipped="0" time="3.415036">
        <testcase name="test_user_mobile_must_be_unique" file="C:\PreIPO\backend\tests\Unit\UserTest.php" line="70" class="Tests\Unit\UserTest" classname="Tests.Unit.UserTest" assertions="1" time="0.307140"/>
        <testcase name="test_user_referral_code_is_generated_automatically" file="C:\PreIPO\backend\tests\Unit\UserTest.php" line="80" class="Tests\Unit\UserTest" classname="Tests.Unit.UserTest" assertions="2" time="0.271752"/>
        <testcase name="test_user_referral_code_is_unique" file="C:\PreIPO\backend\tests\Unit\UserTest.php" line="95" class="Tests\Unit\UserTest" classname="Tests.Unit.UserTest" assertions="1" time="0.299901"/>
        <testcase name="test_user_has_subscriptions_relationship" file="C:\PreIPO\backend\tests\Unit\UserTest.php" line="140" class="Tests\Unit\UserTest" classname="Tests.Unit.UserTest" assertions="2" time="0.283754"/>
        <testcase name="test_user_has_wallet_relationship" file="C:\PreIPO\backend\tests\Unit\UserTest.php" line="116" class="Tests\Unit\UserTest" classname="Tests.Unit.UserTest" assertions="2" time="0.254824">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\UserTest::test_user_has_wallet_relationship&#13;
Failed asserting that 0 matches expected 100.
&#13;
C:\PreIPO\backend\tests\Unit\UserTest.php:126</failure>
        </testcase>
        <testcase name="test_user_email_must_be_unique" file="C:\PreIPO\backend\tests\Unit\UserTest.php" line="60" class="Tests\Unit\UserTest" classname="Tests.Unit.UserTest" assertions="1" time="0.284479"/>
        <testcase name="test_user_has_profile_relationship" file="C:\PreIPO\backend\tests\Unit\UserTest.php" line="106" class="Tests\Unit\UserTest" classname="Tests.Unit.UserTest" assertions="2" time="0.267421">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\UserTest::test_user_has_profile_relationship&#13;
Failed asserting that null matches expected 'Test'.
&#13;
C:\PreIPO\backend\tests\Unit\UserTest.php:112</failure>
        </testcase>
        <testcase name="test_user_can_be_created_with_valid_data" file="C:\PreIPO\backend\tests\Unit\UserTest.php" line="27" class="Tests\Unit\UserTest" classname="Tests.Unit.UserTest" assertions="4" time="0.293253"/>
        <testcase name="test_user_has_kyc_relationship" file="C:\PreIPO\backend\tests\Unit\UserTest.php" line="130" class="Tests\Unit\UserTest" classname="Tests.Unit.UserTest" assertions="2" time="0.299521">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\UserTest::test_user_has_kyc_relationship&#13;
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
-'pending'
+'verified'
&#13;
C:\PreIPO\backend\tests\Unit\UserTest.php:136</failure>
        </testcase>
        <testcase name="test_user_password_is_hashed_on_creation" file="C:\PreIPO\backend\tests\Unit\UserTest.php" line="46" class="Tests\Unit\UserTest" classname="Tests.Unit.UserTest" assertions="2" time="0.288451"/>
        <testcase name="test_user_has_referrals_relationship" file="C:\PreIPO\backend\tests\Unit\UserTest.php" line="155" class="Tests\Unit\UserTest" classname="Tests.Unit.UserTest" assertions="2" time="0.283259"/>
        <testcase name="test_user_soft_deletes_correctly" file="C:\PreIPO\backend\tests\Unit\UserTest.php" line="172" class="Tests\Unit\UserTest" classname="Tests.Unit.UserTest" assertions="3" time="0.281280"/>
      </testsuite>
      <testsuite name="Tests\Unit\PerformanceTest" file="C:\PreIPO\backend\tests\Unit\PerformanceTest.php" tests="1" assertions="4" errors="0" failures="0" skipped="0" time="0.013482">
        <testcase name="testConcurrentPaymentProcessing" file="C:\PreIPO\backend\tests\Unit\PerformanceTest.php" line="56" class="Tests\Unit\PerformanceTest" classname="Tests.Unit.PerformanceTest" assertions="4" time="0.013482"/>
      </testsuite>
      <testsuite name="Tests\Unit\OtpServiceTest" file="C:\PreIPO\backend\tests\Unit\OtpServiceTest.php" tests="10" assertions="13" errors="1" failures="1" skipped="0" time="0.961840">
        <testcase name="test_verify_otp_blocks_after_3_attempts" file="C:\PreIPO\backend\tests\Unit\OtpServiceTest.php" line="100" class="Tests\Unit\OtpServiceTest" classname="Tests.Unit.OtpServiceTest" assertions="1" time="0.099740">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\OtpServiceTest::test_verify_otp_blocks_after_3_attempts&#13;
Failed asserting that 0 is true.
&#13;
C:\PreIPO\backend\tests\Unit\OtpServiceTest.php:108</failure>
        </testcase>
        <testcase name="test_generate_otp_stores_in_database" file="C:\PreIPO\backend\tests\Unit\OtpServiceTest.php" line="46" class="Tests\Unit\OtpServiceTest" classname="Tests.Unit.OtpServiceTest" assertions="1" time="0.083859"/>
        <testcase name="test_verify_otp_rejects_incorrect_code" file="C:\PreIPO\backend\tests\Unit\OtpServiceTest.php" line="80" class="Tests\Unit\OtpServiceTest" classname="Tests.Unit.OtpServiceTest" assertions="1" time="0.090166"/>
        <testcase name="test_verify_otp_validates_correct_code" file="C:\PreIPO\backend\tests\Unit\OtpServiceTest.php" line="57" class="Tests\Unit\OtpServiceTest" classname="Tests.Unit.OtpServiceTest" assertions="2" time="0.149356"/>
        <testcase name="test_generate_otp_creates_6_digit_code" file="C:\PreIPO\backend\tests\Unit\OtpServiceTest.php" line="25" class="Tests\Unit\OtpServiceTest" classname="Tests.Unit.OtpServiceTest" assertions="3" time="0.098723"/>
        <testcase name="test_otp_cleanup_deletes_expired_entries" file="C:\PreIPO\backend\tests\Unit\OtpServiceTest.php" line="135" class="Tests\Unit\OtpServiceTest" classname="Tests.Unit.OtpServiceTest" assertions="1" time="0.065814"/>
        <testcase name="test_verify_otp_rejects_expired_code" file="C:\PreIPO\backend\tests\Unit\OtpServiceTest.php" line="68" class="Tests\Unit\OtpServiceTest" classname="Tests.Unit.OtpServiceTest" assertions="2" time="0.088809"/>
        <testcase name="test_resend_otp_respects_cooldown_period" file="C:\PreIPO\backend\tests\Unit\OtpServiceTest.php" line="117" class="Tests\Unit\OtpServiceTest" classname="Tests.Unit.OtpServiceTest" assertions="0" time="0.096346">
          <error type="Error">Tests\Unit\OtpServiceTest::test_resend_otp_respects_cooldown_period&#13;
Error: Call to a member function diffInSeconds() on string
&#13;
C:\PreIPO\backend\app\Services\OtpService.php:25
C:\PreIPO\backend\tests\Unit\OtpServiceTest.php:123</error>
        </testcase>
        <testcase name="test_generate_otp_sets_10_minute_expiry" file="C:\PreIPO\backend\tests\Unit\OtpServiceTest.php" line="35" class="Tests\Unit\OtpServiceTest" classname="Tests.Unit.OtpServiceTest" assertions="1" time="0.093703"/>
        <testcase name="test_verify_otp_increments_attempt_count" file="C:\PreIPO\backend\tests\Unit\OtpServiceTest.php" line="90" class="Tests\Unit\OtpServiceTest" classname="Tests.Unit.OtpServiceTest" assertions="1" time="0.095324"/>
      </testsuite>
      <testsuite name="Tests\Unit\ReferralTest" file="C:\PreIPO\backend\tests\Unit\ReferralTest.php" tests="8" assertions="17" errors="0" failures="0" skipped="0" time="0.891280">
        <testcase name="test_referral_belongs_to_referred_user" file="C:\PreIPO\backend\tests\Unit\ReferralTest.php" line="37" class="Tests\Unit\ReferralTest" classname="Tests.Unit.ReferralTest" assertions="2" time="0.089054"/>
        <testcase name="test_referral_validates_referrer_not_self" file="C:\PreIPO\backend\tests\Unit\ReferralTest.php" line="88" class="Tests\Unit\ReferralTest" classname="Tests.Unit.ReferralTest" assertions="2" time="0.121222"/>
        <testcase name="test_referral_calculates_bonus_eligible" file="C:\PreIPO\backend\tests\Unit\ReferralTest.php" line="140" class="Tests\Unit\ReferralTest" classname="Tests.Unit.ReferralTest" assertions="2" time="0.111666"/>
        <testcase name="test_referral_status_enum_validates" file="C:\PreIPO\backend\tests\Unit\ReferralTest.php" line="49" class="Tests\Unit\ReferralTest" classname="Tests.Unit.ReferralTest" assertions="2" time="0.110489"/>
        <testcase name="test_referral_scope_active_filters_correctly" file="C:\PreIPO\backend\tests\Unit\ReferralTest.php" line="120" class="Tests\Unit\ReferralTest" classname="Tests.Unit.ReferralTest" assertions="2" time="0.134162"/>
        <testcase name="test_referral_tracks_activation_date" file="C:\PreIPO\backend\tests\Unit\ReferralTest.php" line="67" class="Tests\Unit\ReferralTest" classname="Tests.Unit.ReferralTest" assertions="3" time="0.116713"/>
        <testcase name="test_referral_validates_unique_referral" file="C:\PreIPO\backend\tests\Unit\ReferralTest.php" line="100" class="Tests\Unit\ReferralTest" classname="Tests.Unit.ReferralTest" assertions="2" time="0.102210"/>
        <testcase name="test_referral_belongs_to_referrer" file="C:\PreIPO\backend\tests\Unit\ReferralTest.php" line="25" class="Tests\Unit\ReferralTest" classname="Tests.Unit.ReferralTest" assertions="2" time="0.105765"/>
      </testsuite>
      <testsuite name="Tests\Unit\ReferralCampaignTest" file="C:\PreIPO\backend\tests\Unit\ReferralCampaignTest.php" tests="4" assertions="5" errors="0" failures="2" skipped="0" time="0.415863">
        <testcase name="test_campaign_validates_bonus_amount_positive" file="C:\PreIPO\backend\tests\Unit\ReferralCampaignTest.php" line="30" class="Tests\Unit\ReferralCampaignTest" classname="Tests.Unit.ReferralCampaignTest" assertions="1" time="0.096391">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\ReferralCampaignTest::test_campaign_validates_bonus_amount_positive&#13;
Failed asserting that exception of type "Error" matches expected exception "InvalidArgumentException". Message was: "Call to a member function isBefore() on null" at
C:\PreIPO\backend\app\Models\ReferralCampaign.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\ReferralCampaignTest.php:35
.</failure>
        </testcase>
        <testcase name="test_campaign_tracks_total_referrals" file="C:\PreIPO\backend\tests\Unit\ReferralCampaignTest.php" line="79" class="Tests\Unit\ReferralCampaignTest" classname="Tests.Unit.ReferralCampaignTest" assertions="1" time="0.111046"/>
        <testcase name="test_campaign_validates_date_range" file="C:\PreIPO\backend\tests\Unit\ReferralCampaignTest.php" line="15" class="Tests\Unit\ReferralCampaignTest" classname="Tests.Unit.ReferralCampaignTest" assertions="1" time="0.076945">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\ReferralCampaignTest::test_campaign_validates_date_range&#13;
Failed asserting that exception of type "Error" matches expected exception "InvalidArgumentException". Message was: "Call to a member function isBefore() on null" at
C:\PreIPO\backend\app\Models\ReferralCampaign.php:45
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1147
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\ReferralCampaignTest.php:20
.</failure>
        </testcase>
        <testcase name="test_campaign_checks_if_active" file="C:\PreIPO\backend\tests\Unit\ReferralCampaignTest.php" line="45" class="Tests\Unit\ReferralCampaignTest" classname="Tests.Unit.ReferralCampaignTest" assertions="2" time="0.131480"/>
      </testsuite>
      <testsuite name="Tests\Unit\BonusCalculatorCelebrationTest" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorCelebrationTest.php" tests="6" assertions="10" errors="0" failures="1" skipped="0" time="5.199133">
        <testcase name="test_anniversary_bonus_amount_varies_by_year" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorCelebrationTest.php" line="120" class="Tests\Unit\BonusCalculatorCelebrationTest" classname="Tests.Unit.BonusCalculatorCelebrationTest" assertions="2" time="0.950284"/>
        <testcase name="test_birthday_bonus_awarded_on_user_birthday" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorCelebrationTest.php" line="66" class="Tests\Unit\BonusCalculatorCelebrationTest" classname="Tests.Unit.BonusCalculatorCelebrationTest" assertions="2" time="0.888111">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\BonusCalculatorCelebrationTest::test_birthday_bonus_awarded_on_user_birthday&#13;
Failed asserting that a row in the table [bonus_transactions] does not match the attributes {
    "user_id": 18090
}.

Found similar results: [
    {
        "user_id": 18090
    }
].
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Testing\Concerns\InteractsWithDatabase.php:64
C:\PreIPO\backend\tests\Unit\BonusCalculatorCelebrationTest.php:80</failure>
        </testcase>
        <testcase name="test_festival_bonus_awarded_for_configured_events" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorCelebrationTest.php" line="140" class="Tests\Unit\BonusCalculatorCelebrationTest" classname="Tests.Unit.BonusCalculatorCelebrationTest" assertions="2" time="0.947480"/>
        <testcase name="test_birthday_bonus_amount_varies_by_plan" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorCelebrationTest.php" line="84" class="Tests\Unit\BonusCalculatorCelebrationTest" classname="Tests.Unit.BonusCalculatorCelebrationTest" assertions="1" time="0.853409"/>
        <testcase name="test_anniversary_bonus_awarded_on_subscription_anniversary" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorCelebrationTest.php" line="99" class="Tests\Unit\BonusCalculatorCelebrationTest" classname="Tests.Unit.BonusCalculatorCelebrationTest" assertions="2" time="0.776348"/>
        <testcase name="test_celebration_bonus_respects_global_toggle" file="C:\PreIPO\backend\tests\Unit\BonusCalculatorCelebrationTest.php" line="170" class="Tests\Unit\BonusCalculatorCelebrationTest" classname="Tests.Unit.BonusCalculatorCelebrationTest" assertions="1" time="0.783501"/>
      </testsuite>
      <testsuite name="Tests\Unit\LuckyDrawTest" file="C:\PreIPO\backend\tests\Unit\LuckyDrawTest.php" tests="8" assertions="12" errors="2" failures="0" skipped="0" time="0.833679">
        <testcase name="test_lucky_draw_calculates_total_entries" file="C:\PreIPO\backend\tests\Unit\LuckyDrawTest.php" line="62" class="Tests\Unit\LuckyDrawTest" classname="Tests.Unit.LuckyDrawTest" assertions="0" time="0.103297">
          <error type="Error">Tests\Unit\LuckyDrawTest::test_lucky_draw_calculates_total_entries&#13;
Error: Class "Database\Factories\LuckyDrawEntryFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\LuckyDrawTest.php:65</error>
        </testcase>
        <testcase name="test_lucky_draw_can_be_executed" file="C:\PreIPO\backend\tests\Unit\LuckyDrawTest.php" line="96" class="Tests\Unit\LuckyDrawTest" classname="Tests.Unit.LuckyDrawTest" assertions="1" time="0.091837"/>
        <testcase name="test_lucky_draw_has_entries_relationship" file="C:\PreIPO\backend\tests\Unit\LuckyDrawTest.php" line="30" class="Tests\Unit\LuckyDrawTest" classname="Tests.Unit.LuckyDrawTest" assertions="0" time="0.142878">
          <error type="Error">Tests\Unit\LuckyDrawTest::test_lucky_draw_has_entries_relationship&#13;
Error: Class "Database\Factories\LuckyDrawEntryFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\LuckyDrawTest.php:34</error>
        </testcase>
        <testcase name="test_lucky_draw_status_enum_validates" file="C:\PreIPO\backend\tests\Unit\LuckyDrawTest.php" line="44" class="Tests\Unit\LuckyDrawTest" classname="Tests.Unit.LuckyDrawTest" assertions="2" time="0.100136"/>
        <testcase name="test_lucky_draw_tracks_execution_date" file="C:\PreIPO\backend\tests\Unit\LuckyDrawTest.php" line="83" class="Tests\Unit\LuckyDrawTest" classname="Tests.Unit.LuckyDrawTest" assertions="2" time="0.076954"/>
        <testcase name="test_lucky_draw_cannot_be_executed_twice" file="C:\PreIPO\backend\tests\Unit\LuckyDrawTest.php" line="109" class="Tests\Unit\LuckyDrawTest" classname="Tests.Unit.LuckyDrawTest" assertions="3" time="0.149021"/>
        <testcase name="test_lucky_draw_soft_deletes_correctly" file="C:\PreIPO\backend\tests\Unit\LuckyDrawTest.php" line="126" class="Tests\Unit\LuckyDrawTest" classname="Tests.Unit.LuckyDrawTest" assertions="2" time="0.073079"/>
        <testcase name="test_lucky_draw_validates_prize_pool_positive" file="C:\PreIPO\backend\tests\Unit\LuckyDrawTest.php" line="71" class="Tests\Unit\LuckyDrawTest" classname="Tests.Unit.LuckyDrawTest" assertions="2" time="0.096477"/>
      </testsuite>
      <testsuite name="Tests\Unit\BulkPurchaseTest" file="C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php" tests="17" assertions="16" errors="10" failures="0" skipped="0" time="1.497163">
        <testcase name="test_bulk_purchase_calculates_discount_percentage" file="C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php" line="55" class="Tests\Unit\BulkPurchaseTest" classname="Tests.Unit.BulkPurchaseTest" assertions="0" time="0.109090">
          <error type="Illuminate\Database\QueryException">Tests\Unit\BulkPurchaseTest::test_bulk_purchase_calculates_discount_percentage&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1364 Field 'company_id' doesn't have a default value (Connection: mysql, SQL: insert into `bulk_purchases` (`product_id`, `admin_id`, `face_value_purchased`, `actual_cost_paid`, `extra_allocation_percentage`, `purchase_date`, `source_type`, `manual_entry_reason`, `source_documentation`, `total_value_received`, `discount_percentage`, `value_remaining`, `updated_at`, `created_at`) values (2722, 18114, 100000, 80000, 25, 2026-02-22 10:39:01, manual_entry, Test purchase for unit testing, test-document-ref-001, 125000, 20, 125000.00, 2026-02-22 10:39:01, 2026-02-22 10:39:01))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php:44
C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php:58</error>
        </testcase>
        <testcase name="test_bulk_purchase_calculates_total_value_received" file="C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php" line="70" class="Tests\Unit\BulkPurchaseTest" classname="Tests.Unit.BulkPurchaseTest" assertions="0" time="0.080532">
          <error type="Illuminate\Database\QueryException">Tests\Unit\BulkPurchaseTest::test_bulk_purchase_calculates_total_value_received&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1364 Field 'company_id' doesn't have a default value (Connection: mysql, SQL: insert into `bulk_purchases` (`product_id`, `admin_id`, `face_value_purchased`, `actual_cost_paid`, `extra_allocation_percentage`, `purchase_date`, `source_type`, `manual_entry_reason`, `source_documentation`, `total_value_received`, `discount_percentage`, `value_remaining`, `updated_at`, `created_at`) values (2723, 18115, 100000, 80000, 25, 2026-02-22 10:39:01, manual_entry, Test purchase for unit testing, test-document-ref-001, 125000, 20, 125000.00, 2026-02-22 10:39:01, 2026-02-22 10:39:01))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php:44
C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php:73</error>
        </testcase>
        <testcase name="test_company_listing_source_requires_listing_id" file="C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php" line="193" class="Tests\Unit\BulkPurchaseTest" classname="Tests.Unit.BulkPurchaseTest" assertions="2" time="0.073004"/>
        <testcase name="test_bulk_purchase_tracks_allocated_amount" file="C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php" line="94" class="Tests\Unit\BulkPurchaseTest" classname="Tests.Unit.BulkPurchaseTest" assertions="0" time="0.097723">
          <error type="Illuminate\Database\QueryException">Tests\Unit\BulkPurchaseTest::test_bulk_purchase_tracks_allocated_amount&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1364 Field 'company_id' doesn't have a default value (Connection: mysql, SQL: insert into `bulk_purchases` (`product_id`, `admin_id`, `face_value_purchased`, `actual_cost_paid`, `extra_allocation_percentage`, `purchase_date`, `source_type`, `manual_entry_reason`, `source_documentation`, `total_value_received`, `discount_percentage`, `value_remaining`, `updated_at`, `created_at`) values (2725, 18117, 100000, 80000, 25, 2026-02-22 10:39:01, manual_entry, Test purchase for unit testing, test-document-ref-001, 125000, 20, 125000.00, 2026-02-22 10:39:01, 2026-02-22 10:39:01))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php:44
C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php:96</error>
        </testcase>
        <testcase name="test_bulk_purchase_validates_face_value_positive" file="C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php" line="126" class="Tests\Unit\BulkPurchaseTest" classname="Tests.Unit.BulkPurchaseTest" assertions="2" time="0.098092"/>
        <testcase name="test_manual_entry_with_valid_provenance_succeeds" file="C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php" line="211" class="Tests\Unit\BulkPurchaseTest" classname="Tests.Unit.BulkPurchaseTest" assertions="0" time="0.083297">
          <error type="Illuminate\Database\QueryException">Tests\Unit\BulkPurchaseTest::test_manual_entry_with_valid_provenance_succeeds&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1364 Field 'company_id' doesn't have a default value (Connection: mysql, SQL: insert into `bulk_purchases` (`product_id`, `admin_id`, `face_value_purchased`, `actual_cost_paid`, `extra_allocation_percentage`, `purchase_date`, `source_type`, `manual_entry_reason`, `source_documentation`, `total_value_received`, `discount_percentage`, `value_remaining`, `updated_at`, `created_at`) values (2727, 18119, 100000, 80000, 25, 2026-02-22 10:39:01, manual_entry, Bulk inventory acquisition from secondary market, invoice-2024-001.pdf, 125000, 20, 125000.00, 2026-02-22 10:39:01, 2026-02-22 10:39:01))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php:213</error>
        </testcase>
        <testcase name="test_bulk_purchase_calculates_available_amount" file="C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php" line="106" class="Tests\Unit\BulkPurchaseTest" classname="Tests.Unit.BulkPurchaseTest" assertions="0" time="0.098085">
          <error type="Illuminate\Database\QueryException">Tests\Unit\BulkPurchaseTest::test_bulk_purchase_calculates_available_amount&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1364 Field 'company_id' doesn't have a default value (Connection: mysql, SQL: insert into `bulk_purchases` (`product_id`, `admin_id`, `face_value_purchased`, `actual_cost_paid`, `extra_allocation_percentage`, `purchase_date`, `source_type`, `manual_entry_reason`, `source_documentation`, `total_value_received`, `discount_percentage`, `value_remaining`, `updated_at`, `created_at`) values (2728, 18120, 100000, 80000, 25, 2026-02-22 10:39:01, manual_entry, Test purchase for unit testing, test-document-ref-001, 125000, 20, 125000.00, 2026-02-22 10:39:01, 2026-02-22 10:39:01))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php:44
C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php:108</error>
        </testcase>
        <testcase name="test_bulk_purchase_calculates_gross_margin" file="C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php" line="78" class="Tests\Unit\BulkPurchaseTest" classname="Tests.Unit.BulkPurchaseTest" assertions="0" time="0.075130">
          <error type="Illuminate\Database\QueryException">Tests\Unit\BulkPurchaseTest::test_bulk_purchase_calculates_gross_margin&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1364 Field 'company_id' doesn't have a default value (Connection: mysql, SQL: insert into `bulk_purchases` (`product_id`, `admin_id`, `face_value_purchased`, `actual_cost_paid`, `extra_allocation_percentage`, `purchase_date`, `source_type`, `manual_entry_reason`, `source_documentation`, `total_value_received`, `discount_percentage`, `value_remaining`, `updated_at`, `created_at`) values (2729, 18121, 100000, 80000, 25, 2026-02-22 10:39:01, manual_entry, Test purchase for unit testing, test-document-ref-001, 125000, 20, 125000.00, 2026-02-22 10:39:01, 2026-02-22 10:39:01))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php:44
C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php:81</error>
        </testcase>
        <testcase name="test_manual_entry_requires_documentation" file="C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php" line="174" class="Tests\Unit\BulkPurchaseTest" classname="Tests.Unit.BulkPurchaseTest" assertions="2" time="0.071695"/>
        <testcase name="test_bulk_purchase_belongs_to_product" file="C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php" line="48" class="Tests\Unit\BulkPurchaseTest" classname="Tests.Unit.BulkPurchaseTest" assertions="0" time="0.102995">
          <error type="Illuminate\Database\QueryException">Tests\Unit\BulkPurchaseTest::test_bulk_purchase_belongs_to_product&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1364 Field 'company_id' doesn't have a default value (Connection: mysql, SQL: insert into `bulk_purchases` (`product_id`, `admin_id`, `face_value_purchased`, `actual_cost_paid`, `extra_allocation_percentage`, `purchase_date`, `source_type`, `manual_entry_reason`, `source_documentation`, `total_value_received`, `discount_percentage`, `value_remaining`, `updated_at`, `created_at`) values (2731, 18123, 100000, 80000, 25, 2026-02-22 10:39:02, manual_entry, Test purchase for unit testing, test-document-ref-001, 125000, 20, 125000.00, 2026-02-22 10:39:02, 2026-02-22 10:39:02))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php:44
C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php:50</error>
        </testcase>
        <testcase name="test_provenance_exception_has_context" file="C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php" line="254" class="Tests\Unit\BulkPurchaseTest" classname="Tests.Unit.BulkPurchaseTest" assertions="4" time="0.074425"/>
        <testcase name="test_bulk_purchase_validates_cost_positive" file="C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php" line="117" class="Tests\Unit\BulkPurchaseTest" classname="Tests.Unit.BulkPurchaseTest" assertions="2" time="0.074120"/>
        <testcase name="test_bulk_purchase_calculates_extra_allocation_percentage" file="C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php" line="63" class="Tests\Unit\BulkPurchaseTest" classname="Tests.Unit.BulkPurchaseTest" assertions="0" time="0.099192">
          <error type="Illuminate\Database\QueryException">Tests\Unit\BulkPurchaseTest::test_bulk_purchase_calculates_extra_allocation_percentage&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1364 Field 'company_id' doesn't have a default value (Connection: mysql, SQL: insert into `bulk_purchases` (`product_id`, `admin_id`, `face_value_purchased`, `actual_cost_paid`, `extra_allocation_percentage`, `purchase_date`, `source_type`, `manual_entry_reason`, `source_documentation`, `total_value_received`, `discount_percentage`, `value_remaining`, `updated_at`, `created_at`) values (2734, 18126, 100000, 80000, 30, 2026-02-22 10:39:02, manual_entry, Test purchase for unit testing, test-document-ref-001, 130000, 20, 130000.00, 2026-02-22 10:39:02, 2026-02-22 10:39:02))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php:44
C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php:65</error>
        </testcase>
        <testcase name="test_company_listing_with_valid_listing_id_succeeds" file="C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php" line="232" class="Tests\Unit\BulkPurchaseTest" classname="Tests.Unit.BulkPurchaseTest" assertions="0" time="0.080196">
          <error type="Illuminate\Database\QueryException">Tests\Unit\BulkPurchaseTest::test_company_listing_with_valid_listing_id_succeeds&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1364 Field 'company_id' doesn't have a default value (Connection: mysql, SQL: insert into `bulk_purchases` (`product_id`, `admin_id`, `face_value_purchased`, `actual_cost_paid`, `extra_allocation_percentage`, `purchase_date`, `source_type`, `company_share_listing_id`, `total_value_received`, `discount_percentage`, `value_remaining`, `updated_at`, `created_at`) values (2735, 18127, 100000, 80000, 25, 2026-02-22 10:39:02, company_listing, 1, 125000, 20, 125000.00, 2026-02-22 10:39:02, 2026-02-22 10:39:02))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php:237</error>
        </testcase>
        <testcase name="test_bulk_purchase_calculates_gross_margin_percentage" file="C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php" line="86" class="Tests\Unit\BulkPurchaseTest" classname="Tests.Unit.BulkPurchaseTest" assertions="0" time="0.076984">
          <error type="Illuminate\Database\QueryException">Tests\Unit\BulkPurchaseTest::test_bulk_purchase_calculates_gross_margin_percentage&#13;
Illuminate\Database\QueryException: SQLSTATE[HY000]: General error: 1364 Field 'company_id' doesn't have a default value (Connection: mysql, SQL: insert into `bulk_purchases` (`product_id`, `admin_id`, `face_value_purchased`, `actual_cost_paid`, `extra_allocation_percentage`, `purchase_date`, `source_type`, `manual_entry_reason`, `source_documentation`, `total_value_received`, `discount_percentage`, `value_remaining`, `updated_at`, `created_at`) values (2736, 18128, 100000, 80000, 25, 2026-02-22 10:39:02, manual_entry, Test purchase for unit testing, test-document-ref-001, 125000, 20, 125000.00, 2026-02-22 10:39:02, 2026-02-22 10:39:02))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1128
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\helpers.php:399
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:1127
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Support\Traits\ForwardsCalls.php:23
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2372
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:2384
C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php:44
C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php:89</error>
        </testcase>
        <testcase name="test_bulk_purchase_requires_source_type" file="C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php" line="139" class="Tests\Unit\BulkPurchaseTest" classname="Tests.Unit.BulkPurchaseTest" assertions="2" time="0.111147"/>
        <testcase name="test_manual_entry_requires_reason" file="C:\PreIPO\backend\tests\Unit\BulkPurchaseTest.php" line="156" class="Tests\Unit\BulkPurchaseTest" classname="Tests.Unit.BulkPurchaseTest" assertions="2" time="0.091458"/>
      </testsuite>
      <testsuite name="Tests\Unit\UserDataSecurityTest" file="C:\PreIPO\backend\tests\Unit\UserDataSecurityTest.php" tests="1" assertions="2" errors="0" failures="0" skipped="0" time="0.019972">
        <testcase name="testUnauthorizedAccessToOtherUserDataFails" file="C:\PreIPO\backend\tests\Unit\UserDataSecurityTest.php" line="45" class="Tests\Unit\UserDataSecurityTest" classname="Tests.Unit.UserDataSecurityTest" assertions="2" time="0.019972"/>
      </testsuite>
      <testsuite name="Tests\Unit\DisputeStatsCacheTest" file="C:\PreIPO\backend\tests\Unit\DisputeStatsCacheTest.php" tests="11" assertions="38" errors="2" failures="1" skipped="0" time="3.292496">
        <testcase name="clear_cache_removes_all_stats" file="C:\PreIPO\backend\tests\Unit\DisputeStatsCacheTest.php" line="189" class="Tests\Unit\DisputeStatsCacheTest" classname="Tests.Unit.DisputeStatsCacheTest" assertions="1" time="0.320876">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\DisputeStatsCacheTest::clear_cache_removes_all_stats&#13;
Failed asserting that '2026-02-22T10:39:02+00:00' is not equal to '2026-02-22T10:39:02+00:00'.
&#13;
C:\PreIPO\backend\tests\Unit\DisputeStatsCacheTest.php:208</failure>
        </testcase>
        <testcase name="get_overview_force_refresh_bypasses_cache" file="C:\PreIPO\backend\tests\Unit\DisputeStatsCacheTest.php" line="77" class="Tests\Unit\DisputeStatsCacheTest" classname="Tests.Unit.DisputeStatsCacheTest" assertions="0" time="0.269996">
          <error type="ErrorException">Tests\Unit\DisputeStatsCacheTest::get_overview_force_refresh_bypasses_cache&#13;
ErrorException: Undefined property: stdClass::$status
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bootstrap\HandleExceptions.php:258
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3424
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3381
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:991
C:\PreIPO\backend\app\Services\DisputeStatsCache.php:166
C:\PreIPO\backend\app\Services\DisputeStatsCache.php:53
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Cache\Repository.php:427
C:\PreIPO\backend\app\Services\DisputeStatsCache.php:52
C:\PreIPO\backend\tests\Unit\DisputeStatsCacheTest.php:87</error>
        </testcase>
        <testcase name="get_overview_returns_expected_structure" file="C:\PreIPO\backend\tests\Unit\DisputeStatsCacheTest.php" line="30" class="Tests\Unit\DisputeStatsCacheTest" classname="Tests.Unit.DisputeStatsCacheTest" assertions="6" time="0.341846"/>
        <testcase name="get_chargeback_stats_returns_expected_structure" file="C:\PreIPO\backend\tests\Unit\DisputeStatsCacheTest.php" line="97" class="Tests\Unit\DisputeStatsCacheTest" classname="Tests.Unit.DisputeStatsCacheTest" assertions="7" time="0.279396"/>
        <testcase name="get_all_stats_returns_complete_data" file="C:\PreIPO\backend\tests\Unit\DisputeStatsCacheTest.php" line="214" class="Tests\Unit\DisputeStatsCacheTest" classname="Tests.Unit.DisputeStatsCacheTest" assertions="5" time="0.253675"/>
        <testcase name="get_risk_distribution_categorizes_users_correctly" file="C:\PreIPO\backend\tests\Unit\DisputeStatsCacheTest.php" line="150" class="Tests\Unit\DisputeStatsCacheTest" classname="Tests.Unit.DisputeStatsCacheTest" assertions="5" time="0.293093"/>
        <testcase name="get_chargeback_stats_counts_correctly" file="C:\PreIPO\backend\tests\Unit\DisputeStatsCacheTest.php" line="111" class="Tests\Unit\DisputeStatsCacheTest" classname="Tests.Unit.DisputeStatsCacheTest" assertions="4" time="0.367890"/>
        <testcase name="warm_cache_populates_all_caches" file="C:\PreIPO\backend\tests\Unit\DisputeStatsCacheTest.php" line="171" class="Tests\Unit\DisputeStatsCacheTest" classname="Tests.Unit.DisputeStatsCacheTest" assertions="4" time="0.303412"/>
        <testcase name="get_risk_distribution_returns_expected_structure" file="C:\PreIPO\backend\tests\Unit\DisputeStatsCacheTest.php" line="138" class="Tests\Unit\DisputeStatsCacheTest" classname="Tests.Unit.DisputeStatsCacheTest" assertions="5" time="0.254940"/>
        <testcase name="get_overview_counts_disputes_correctly" file="C:\PreIPO\backend\tests\Unit\DisputeStatsCacheTest.php" line="43" class="Tests\Unit\DisputeStatsCacheTest" classname="Tests.Unit.DisputeStatsCacheTest" assertions="0" time="0.343275">
          <error type="ErrorException">Tests\Unit\DisputeStatsCacheTest::get_overview_counts_disputes_correctly&#13;
ErrorException: Undefined property: stdClass::$status
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Foundation\Bootstrap\HandleExceptions.php:258
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3424
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3381
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:991
C:\PreIPO\backend\app\Services\DisputeStatsCache.php:166
C:\PreIPO\backend\app\Services\DisputeStatsCache.php:53
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Cache\Repository.php:427
C:\PreIPO\backend\app\Services\DisputeStatsCache.php:52
C:\PreIPO\backend\tests\Unit\DisputeStatsCacheTest.php:52</error>
        </testcase>
        <testcase name="get_overview_caches_results" file="C:\PreIPO\backend\tests\Unit\DisputeStatsCacheTest.php" line="59" class="Tests\Unit\DisputeStatsCacheTest" classname="Tests.Unit.DisputeStatsCacheTest" assertions="1" time="0.264097"/>
      </testsuite>
      <testsuite name="Tests\Unit\ReportServiceTest" file="C:\PreIPO\backend\tests\Unit\ReportServiceTest.php" tests="7" assertions="6" errors="3" failures="3" skipped="0" time="2.213083">
        <testcase name="test_financial_summary_calculates_profit" file="C:\PreIPO\backend\tests\Unit\ReportServiceTest.php" line="27" class="Tests\Unit\ReportServiceTest" classname="Tests.Unit.ReportServiceTest" assertions="1" time="0.392132">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\ReportServiceTest::test_financial_summary_calculates_profit&#13;
Failed asserting that 0.0 matches expected 10000.
&#13;
C:\PreIPO\backend\tests\Unit\ReportServiceTest.php:39</failure>
        </testcase>
        <testcase name="test_tds_calculation_applies_10_percent" file="C:\PreIPO\backend\tests\Unit\ReportServiceTest.php" line="88" class="Tests\Unit\ReportServiceTest" classname="Tests.Unit.ReportServiceTest" assertions="0" time="0.317032">
          <error type="Error">Tests\Unit\ReportServiceTest::test_tds_calculation_applies_10_percent&#13;
Error: Call to undefined method App\Services\ReportService::getTdsReport()
&#13;
C:\PreIPO\backend\tests\Unit\ReportServiceTest.php:94</error>
        </testcase>
        <testcase name="test_user_growth_report_calculates_correctly" file="C:\PreIPO\backend\tests\Unit\ReportServiceTest.php" line="45" class="Tests\Unit\ReportServiceTest" classname="Tests.Unit.ReportServiceTest" assertions="2" time="0.275224">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\ReportServiceTest::test_user_growth_report_calculates_correctly&#13;
Failed asserting that 15 matches expected 3.
&#13;
C:\PreIPO\backend\tests\Unit\ReportServiceTest.php:53</failure>
        </testcase>
        <testcase name="test_user_retention_report_calculates_churn" file="C:\PreIPO\backend\tests\Unit\ReportServiceTest.php" line="58" class="Tests\Unit\ReportServiceTest" classname="Tests.Unit.ReportServiceTest" assertions="1" time="0.342105">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\ReportServiceTest::test_user_retention_report_calculates_churn&#13;
Failed asserting that 0 matches expected 2.
&#13;
C:\PreIPO\backend\tests\Unit\ReportServiceTest.php:72</failure>
        </testcase>
        <testcase name="test_tds_exemption_for_amounts_below_10k" file="C:\PreIPO\backend\tests\Unit\ReportServiceTest.php" line="102" class="Tests\Unit\ReportServiceTest" classname="Tests.Unit.ReportServiceTest" assertions="0" time="0.274605">
          <error type="Error">Tests\Unit\ReportServiceTest::test_tds_exemption_for_amounts_below_10k&#13;
Error: Call to undefined method App\Services\ReportService::getTdsReport()
&#13;
C:\PreIPO\backend\tests\Unit\ReportServiceTest.php:108</error>
        </testcase>
        <testcase name="test_kyc_completion_report_calculates_percentage" file="C:\PreIPO\backend\tests\Unit\ReportServiceTest.php" line="77" class="Tests\Unit\ReportServiceTest" classname="Tests.Unit.ReportServiceTest" assertions="0" time="0.285652">
          <error type="Error">Tests\Unit\ReportServiceTest::test_kyc_completion_report_calculates_percentage&#13;
Error: Call to undefined method App\Services\ReportService::getKycCompletion()
&#13;
C:\PreIPO\backend\tests\Unit\ReportServiceTest.php:82</error>
        </testcase>
        <testcase name="test_aml_report_flags_suspicious_transactions" file="C:\PreIPO\backend\tests\Unit\ReportServiceTest.php" line="114" class="Tests\Unit\ReportServiceTest" classname="Tests.Unit.ReportServiceTest" assertions="2" time="0.326333"/>
      </testsuite>
      <testsuite name="Tests\Unit\SupportTicketTest" file="C:\PreIPO\backend\tests\Unit\SupportTicketTest.php" tests="6" assertions="11" errors="0" failures="0" skipped="0" time="0.552143">
        <testcase name="test_ticket_has_messages_relationship" file="C:\PreIPO\backend\tests\Unit\SupportTicketTest.php" line="35" class="Tests\Unit\SupportTicketTest" classname="Tests.Unit.SupportTicketTest" assertions="2" time="0.101394"/>
        <testcase name="test_ticket_priority_enum_validates" file="C:\PreIPO\backend\tests\Unit\SupportTicketTest.php" line="63" class="Tests\Unit\SupportTicketTest" classname="Tests.Unit.SupportTicketTest" assertions="2" time="0.077954"/>
        <testcase name="test_ticket_status_enum_validates" file="C:\PreIPO\backend\tests\Unit\SupportTicketTest.php" line="45" class="Tests\Unit\SupportTicketTest" classname="Tests.Unit.SupportTicketTest" assertions="2" time="0.079051"/>
        <testcase name="test_ticket_auto_closes_after_inactivity" file="C:\PreIPO\backend\tests\Unit\SupportTicketTest.php" line="95" class="Tests\Unit\SupportTicketTest" classname="Tests.Unit.SupportTicketTest" assertions="1" time="0.124480"/>
        <testcase name="test_ticket_belongs_to_user" file="C:\PreIPO\backend\tests\Unit\SupportTicketTest.php" line="27" class="Tests\Unit\SupportTicketTest" classname="Tests.Unit.SupportTicketTest" assertions="2" time="0.094001"/>
        <testcase name="test_ticket_tracks_resolved_by_admin" file="C:\PreIPO\backend\tests\Unit\SupportTicketTest.php" line="81" class="Tests\Unit\SupportTicketTest" classname="Tests.Unit.SupportTicketTest" assertions="2" time="0.075263"/>
      </testsuite>
      <testsuite name="Tests\Unit\FeatureFlagTest" file="C:\PreIPO\backend\tests\Unit\FeatureFlagTest.php" tests="5" assertions="0" errors="5" failures="0" skipped="0" time="0.431526">
        <testcase name="test_percentage_flag_is_off_if_globally_disabled" file="C:\PreIPO\backend\tests\Unit\FeatureFlagTest.php" line="97" class="Tests\Unit\FeatureFlagTest" classname="Tests.Unit.FeatureFlagTest" assertions="0" time="0.100432">
          <error type="Error">Tests\Unit\FeatureFlagTest::test_percentage_flag_is_off_if_globally_disabled&#13;
Error: Class "Database\Factories\FeatureFlagFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\FeatureFlagTest.php:100</error>
        </testcase>
        <testcase name="test_feature_flag_checks_if_enabled" file="C:\PreIPO\backend\tests\Unit\FeatureFlagTest.php" line="25" class="Tests\Unit\FeatureFlagTest" classname="Tests.Unit.FeatureFlagTest" assertions="0" time="0.071364">
          <error type="Error">Tests\Unit\FeatureFlagTest::test_feature_flag_checks_if_enabled&#13;
Error: Class "Database\Factories\FeatureFlagFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\FeatureFlagTest.php:28</error>
        </testcase>
        <testcase name="test_feature_flag_validates_identifier_unique" file="C:\PreIPO\backend\tests\Unit\FeatureFlagTest.php" line="46" class="Tests\Unit\FeatureFlagTest" classname="Tests.Unit.FeatureFlagTest" assertions="0" time="0.076704">
          <error type="Error">Tests\Unit\FeatureFlagTest::test_feature_flag_validates_identifier_unique&#13;
Error: Class "Database\Factories\FeatureFlagFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\FeatureFlagTest.php:48</error>
        </testcase>
        <testcase name="test_feature_flag_tracks_enabled_for_percentage" file="C:\PreIPO\backend\tests\Unit\FeatureFlagTest.php" line="57" class="Tests\Unit\FeatureFlagTest" classname="Tests.Unit.FeatureFlagTest" assertions="0" time="0.101784">
          <error type="Error">Tests\Unit\FeatureFlagTest::test_feature_flag_tracks_enabled_for_percentage&#13;
Error: Class "Database\Factories\FeatureFlagFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\FeatureFlagTest.php:60</error>
        </testcase>
        <testcase name="test_percentage_flag_is_off_for_guests" file="C:\PreIPO\backend\tests\Unit\FeatureFlagTest.php" line="83" class="Tests\Unit\FeatureFlagTest" classname="Tests.Unit.FeatureFlagTest" assertions="0" time="0.081241">
          <error type="Error">Tests\Unit\FeatureFlagTest::test_percentage_flag_is_off_for_guests&#13;
Error: Class "Database\Factories\FeatureFlagFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\FeatureFlagTest.php:86</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Unit\PlanConfigTest" file="C:\PreIPO\backend\tests\Unit\PlanConfigTest.php" tests="8" assertions="15" errors="0" failures="0" skipped="0" time="0.678216">
        <testcase name="test_config_can_be_updated" file="C:\PreIPO\backend\tests\Unit\PlanConfigTest.php" line="148" class="Tests\Unit\PlanConfigTest" classname="Tests.Unit.PlanConfigTest" assertions="1" time="0.073645"/>
        <testcase name="test_progressive_config_structure_validates" file="C:\PreIPO\backend\tests\Unit\PlanConfigTest.php" line="74" class="Tests\Unit\PlanConfigTest" classname="Tests.Unit.PlanConfigTest" assertions="2" time="0.105693"/>
        <testcase name="test_consistency_config_structure_validates" file="C:\PreIPO\backend\tests\Unit\PlanConfigTest.php" line="109" class="Tests\Unit\PlanConfigTest" classname="Tests.Unit.PlanConfigTest" assertions="2" time="0.078504"/>
        <testcase name="test_milestone_config_structure_validates" file="C:\PreIPO\backend\tests\Unit\PlanConfigTest.php" line="90" class="Tests\Unit\PlanConfigTest" classname="Tests.Unit.PlanConfigTest" assertions="2" time="0.124231"/>
        <testcase name="test_config_value_is_json_cast" file="C:\PreIPO\backend\tests\Unit\PlanConfigTest.php" line="54" class="Tests\Unit\PlanConfigTest" classname="Tests.Unit.PlanConfigTest" assertions="4" time="0.084226"/>
        <testcase name="test_referral_config_structure_validates" file="C:\PreIPO\backend\tests\Unit\PlanConfigTest.php" line="130" class="Tests\Unit\PlanConfigTest" classname="Tests.Unit.PlanConfigTest" assertions="1" time="0.071586"/>
        <testcase name="test_config_key_is_unique_per_plan" file="C:\PreIPO\backend\tests\Unit\PlanConfigTest.php" line="35" class="Tests\Unit\PlanConfigTest" classname="Tests.Unit.PlanConfigTest" assertions="1" time="0.078879"/>
        <testcase name="test_config_belongs_to_plan" file="C:\PreIPO\backend\tests\Unit\PlanConfigTest.php" line="22" class="Tests\Unit\PlanConfigTest" classname="Tests.Unit.PlanConfigTest" assertions="2" time="0.061453"/>
      </testsuite>
      <testsuite name="Tests\Unit\AllocationServiceTest" file="C:\PreIPO\backend\tests\Unit\AllocationServiceTest.php" tests="7" assertions="0" errors="7" failures="0" skipped="0" time="0.000000">
        <testcase name="test_allocation_distribution_respects_limits" file="C:\PreIPO\backend\tests\Unit\AllocationServiceTest.php" line="144" class="Tests\Unit\AllocationServiceTest" classname="Tests.Unit.AllocationServiceTest" assertions="0" time="0.000000">
          <error type="ArgumentCountError">Tests\Unit\AllocationServiceTest::test_allocation_distribution_respects_limits&#13;
ArgumentCountError: Too few arguments to function App\Services\AllocationService::__construct(), 0 passed in C:\PreIPO\backend\tests\Unit\AllocationServiceTest.php on line 27 and exactly 4 expected
&#13;
C:\PreIPO\backend\app\Services\AllocationService.php:38
C:\PreIPO\backend\tests\Unit\AllocationServiceTest.php:27</error>
        </testcase>
        <testcase name="test_allocation_logs_audit_trail_on_success" file="C:\PreIPO\backend\tests\Unit\AllocationServiceTest.php" line="98" class="Tests\Unit\AllocationServiceTest" classname="Tests.Unit.AllocationServiceTest" assertions="0" time="0.000000">
          <error type="ArgumentCountError">Tests\Unit\AllocationServiceTest::test_allocation_logs_audit_trail_on_success&#13;
ArgumentCountError: Too few arguments to function App\Services\AllocationService::__construct(), 0 passed in C:\PreIPO\backend\tests\Unit\AllocationServiceTest.php on line 27 and exactly 4 expected
&#13;
C:\PreIPO\backend\app\Services\AllocationService.php:38
C:\PreIPO\backend\tests\Unit\AllocationServiceTest.php:27</error>
        </testcase>
        <testcase name="test_allocate_to_user_handles_insufficient_inventory" file="C:\PreIPO\backend\tests\Unit\AllocationServiceTest.php" line="73" class="Tests\Unit\AllocationServiceTest" classname="Tests.Unit.AllocationServiceTest" assertions="0" time="0.000000">
          <error type="ArgumentCountError">Tests\Unit\AllocationServiceTest::test_allocate_to_user_handles_insufficient_inventory&#13;
ArgumentCountError: Too few arguments to function App\Services\AllocationService::__construct(), 0 passed in C:\PreIPO\backend\tests\Unit\AllocationServiceTest.php on line 27 and exactly 4 expected
&#13;
C:\PreIPO\backend\app\Services\AllocationService.php:38
C:\PreIPO\backend\tests\Unit\AllocationServiceTest.php:27</error>
        </testcase>
        <testcase name="test_allocation_logs_audit_trail_on_failure" file="C:\PreIPO\backend\tests\Unit\AllocationServiceTest.php" line="111" class="Tests\Unit\AllocationServiceTest" classname="Tests.Unit.AllocationServiceTest" assertions="0" time="0.000000">
          <error type="ArgumentCountError">Tests\Unit\AllocationServiceTest::test_allocation_logs_audit_trail_on_failure&#13;
ArgumentCountError: Too few arguments to function App\Services\AllocationService::__construct(), 0 passed in C:\PreIPO\backend\tests\Unit\AllocationServiceTest.php on line 27 and exactly 4 expected
&#13;
C:\PreIPO\backend\app\Services\AllocationService.php:38
C:\PreIPO\backend\tests\Unit\AllocationServiceTest.php:27</error>
        </testcase>
        <testcase name="test_allocate_to_user_deducts_from_bulk_purchase" file="C:\PreIPO\backend\tests\Unit\AllocationServiceTest.php" line="62" class="Tests\Unit\AllocationServiceTest" classname="Tests.Unit.AllocationServiceTest" assertions="0" time="0.000000">
          <error type="ArgumentCountError">Tests\Unit\AllocationServiceTest::test_allocate_to_user_deducts_from_bulk_purchase&#13;
ArgumentCountError: Too few arguments to function App\Services\AllocationService::__construct(), 0 passed in C:\PreIPO\backend\tests\Unit\AllocationServiceTest.php on line 27 and exactly 4 expected
&#13;
C:\PreIPO\backend\app\Services\AllocationService.php:38
C:\PreIPO\backend\tests\Unit\AllocationServiceTest.php:27</error>
        </testcase>
        <testcase name="test_allocate_bonus_and_investment_deducts_from_same_pool" file="C:\PreIPO\backend\tests\Unit\AllocationServiceTest.php" line="123" class="Tests\Unit\AllocationServiceTest" classname="Tests.Unit.AllocationServiceTest" assertions="0" time="0.000000">
          <error type="ArgumentCountError">Tests\Unit\AllocationServiceTest::test_allocate_bonus_and_investment_deducts_from_same_pool&#13;
ArgumentCountError: Too few arguments to function App\Services\AllocationService::__construct(), 0 passed in C:\PreIPO\backend\tests\Unit\AllocationServiceTest.php on line 27 and exactly 4 expected
&#13;
C:\PreIPO\backend\app\Services\AllocationService.php:38
C:\PreIPO\backend\tests\Unit\AllocationServiceTest.php:27</error>
        </testcase>
        <testcase name="test_allocate_to_user_creates_investment_record" file="C:\PreIPO\backend\tests\Unit\AllocationServiceTest.php" line="48" class="Tests\Unit\AllocationServiceTest" classname="Tests.Unit.AllocationServiceTest" assertions="0" time="0.000000">
          <error type="ArgumentCountError">Tests\Unit\AllocationServiceTest::test_allocate_to_user_creates_investment_record&#13;
ArgumentCountError: Too few arguments to function App\Services\AllocationService::__construct(), 0 passed in C:\PreIPO\backend\tests\Unit\AllocationServiceTest.php on line 27 and exactly 4 expected
&#13;
C:\PreIPO\backend\app\Services\AllocationService.php:38
C:\PreIPO\backend\tests\Unit\AllocationServiceTest.php:27</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Unit\AutoDebitServiceTest" file="C:\PreIPO\backend\tests\Unit\AutoDebitServiceTest.php" tests="5" assertions="8" errors="0" failures="0" skipped="0" time="1.468803">
        <testcase name="test_suspend_subscription_after_max_failures" file="C:\PreIPO\backend\tests\Unit\AutoDebitServiceTest.php" line="128" class="Tests\Unit\AutoDebitServiceTest" classname="Tests.Unit.AutoDebitServiceTest" assertions="3" time="0.310277"/>
        <testcase name="test_initiate_payment_creates_pending_payment" file="C:\PreIPO\backend\tests\Unit\AutoDebitServiceTest.php" line="75" class="Tests\Unit\AutoDebitServiceTest" classname="Tests.Unit.AutoDebitServiceTest" assertions="1" time="0.280028"/>
        <testcase name="test_send_reminder_notification_triggers_at_correct_time" file="C:\PreIPO\backend\tests\Unit\AutoDebitServiceTest.php" line="169" class="Tests\Unit\AutoDebitServiceTest" classname="Tests.Unit.AutoDebitServiceTest" assertions="2" time="0.274161"/>
        <testcase name="test_identify_due_payments_filters_correctly" file="C:\PreIPO\backend\tests\Unit\AutoDebitServiceTest.php" line="41" class="Tests\Unit\AutoDebitServiceTest" classname="Tests.Unit.AutoDebitServiceTest" assertions="1" time="0.258804"/>
        <testcase name="test_retry_failed_payment_respects_max_attempts" file="C:\PreIPO\backend\tests\Unit\AutoDebitServiceTest.php" line="99" class="Tests\Unit\AutoDebitServiceTest" classname="Tests.Unit.AutoDebitServiceTest" assertions="1" time="0.345533"/>
      </testsuite>
      <testsuite name="Tests\Unit\KycDocumentTest" file="C:\PreIPO\backend\tests\Unit\KycDocumentTest.php" tests="8" assertions="17" errors="0" failures="0" skipped="0" time="0.731840">
        <testcase name="test_document_status_enum_validates" file="C:\PreIPO\backend\tests\Unit\KycDocumentTest.php" line="75" class="Tests\Unit\KycDocumentTest" classname="Tests.Unit.KycDocumentTest" assertions="3" time="0.119866"/>
        <testcase name="test_document_stores_file_path" file="C:\PreIPO\backend\tests\Unit\KycDocumentTest.php" line="43" class="Tests\Unit\KycDocumentTest" classname="Tests.Unit.KycDocumentTest" assertions="1" time="0.081463"/>
        <testcase name="test_document_type_enum_validates" file="C:\PreIPO\backend\tests\Unit\KycDocumentTest.php" line="57" class="Tests\Unit\KycDocumentTest" classname="Tests.Unit.KycDocumentTest" assertions="5" time="0.072624"/>
        <testcase name="test_document_tracks_verified_by_admin" file="C:\PreIPO\backend\tests\Unit\KycDocumentTest.php" line="121" class="Tests\Unit\KycDocumentTest" classname="Tests.Unit.KycDocumentTest" assertions="2" time="0.112718"/>
        <testcase name="test_document_can_be_rejected" file="C:\PreIPO\backend\tests\Unit\KycDocumentTest.php" line="107" class="Tests\Unit\KycDocumentTest" classname="Tests.Unit.KycDocumentTest" assertions="1" time="0.080413"/>
        <testcase name="test_document_can_be_approved" file="C:\PreIPO\backend\tests\Unit\KycDocumentTest.php" line="85" class="Tests\Unit\KycDocumentTest" classname="Tests.Unit.KycDocumentTest" assertions="2" time="0.078786"/>
        <testcase name="test_document_has_verification_notes" file="C:\PreIPO\backend\tests\Unit\KycDocumentTest.php" line="136" class="Tests\Unit\KycDocumentTest" classname="Tests.Unit.KycDocumentTest" assertions="1" time="0.109131"/>
        <testcase name="test_document_belongs_to_kyc" file="C:\PreIPO\backend\tests\Unit\KycDocumentTest.php" line="28" class="Tests\Unit\KycDocumentTest" classname="Tests.Unit.KycDocumentTest" assertions="2" time="0.076839"/>
      </testsuite>
      <testsuite name="Tests\Unit\PlanTest" file="C:\PreIPO\backend\tests\Unit\PlanTest.php" tests="12" assertions="18" errors="0" failures="1" skipped="0" time="0.971166">
        <testcase name="test_plan_validates_duration_positive" file="C:\PreIPO\backend\tests\Unit\PlanTest.php" line="125" class="Tests\Unit\PlanTest" classname="Tests.Unit.PlanTest" assertions="2" time="0.067318"/>
        <testcase name="test_plan_scope_active_returns_only_active" file="C:\PreIPO\backend\tests\Unit\PlanTest.php" line="63" class="Tests\Unit\PlanTest" classname="Tests.Unit.PlanTest" assertions="1" time="0.113440">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\PlanTest::test_plan_scope_active_returns_only_active&#13;
Failed asserting that 37 matches expected 1.
&#13;
C:\PreIPO\backend\tests\Unit\PlanTest.php:68</failure>
        </testcase>
        <testcase name="test_plan_calculates_total_investment" file="C:\PreIPO\backend\tests\Unit\PlanTest.php" line="72" class="Tests\Unit\PlanTest" classname="Tests.Unit.PlanTest" assertions="1" time="0.060444"/>
        <testcase name="test_plan_validates_monthly_amount_positive" file="C:\PreIPO\backend\tests\Unit\PlanTest.php" line="116" class="Tests\Unit\PlanTest" classname="Tests.Unit.PlanTest" assertions="2" time="0.090201"/>
        <testcase name="test_plan_slug_is_unique" file="C:\PreIPO\backend\tests\Unit\PlanTest.php" line="106" class="Tests\Unit\PlanTest" classname="Tests.Unit.PlanTest" assertions="1" time="0.098653"/>
        <testcase name="test_plan_has_configs_relationship" file="C:\PreIPO\backend\tests\Unit\PlanTest.php" line="22" class="Tests\Unit\PlanTest" classname="Tests.Unit.PlanTest" assertions="2" time="0.064709"/>
        <testcase name="test_plan_returns_default_if_config_missing" file="C:\PreIPO\backend\tests\Unit\PlanTest.php" line="96" class="Tests\Unit\PlanTest" classname="Tests.Unit.PlanTest" assertions="1" time="0.061628"/>
        <testcase name="test_plan_has_subscriptions_relationship" file="C:\PreIPO\backend\tests\Unit\PlanTest.php" line="49" class="Tests\Unit\PlanTest" classname="Tests.Unit.PlanTest" assertions="2" time="0.100588"/>
        <testcase name="test_plan_has_features_relationship" file="C:\PreIPO\backend\tests\Unit\PlanTest.php" line="36" class="Tests\Unit\PlanTest" classname="Tests.Unit.PlanTest" assertions="2" time="0.089795"/>
        <testcase name="test_plan_can_be_archived" file="C:\PreIPO\backend\tests\Unit\PlanTest.php" line="146" class="Tests\Unit\PlanTest" classname="Tests.Unit.PlanTest" assertions="1" time="0.062548"/>
        <testcase name="test_plan_gets_config_value_by_key" file="C:\PreIPO\backend\tests\Unit\PlanTest.php" line="84" class="Tests\Unit\PlanTest" classname="Tests.Unit.PlanTest" assertions="1" time="0.074641"/>
        <testcase name="test_plan_soft_deletes_correctly" file="C:\PreIPO\backend\tests\Unit\PlanTest.php" line="134" class="Tests\Unit\PlanTest" classname="Tests.Unit.PlanTest" assertions="2" time="0.087201"/>
      </testsuite>
      <testsuite name="Tests\Unit\InventoryServiceTest" file="C:\PreIPO\backend\tests\Unit\InventoryServiceTest.php" tests="3" assertions="2" errors="1" failures="2" skipped="0" time="0.364885">
        <testcase name="test_low_stock_alert_triggers_at_10_percent" file="C:\PreIPO\backend\tests\Unit\InventoryServiceTest.php" line="47" class="Tests\Unit\InventoryServiceTest" classname="Tests.Unit.InventoryServiceTest" assertions="1" time="0.128459">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\InventoryServiceTest::test_low_stock_alert_triggers_at_10_percent&#13;
Failed asserting that false is true.
&#13;
C:\PreIPO\backend\tests\Unit\InventoryServiceTest.php:56</failure>
        </testcase>
        <testcase name="test_check_available_inventory_calculates_correctly" file="C:\PreIPO\backend\tests\Unit\InventoryServiceTest.php" line="25" class="Tests\Unit\InventoryServiceTest" classname="Tests.Unit.InventoryServiceTest" assertions="1" time="0.096573">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\InventoryServiceTest::test_check_available_inventory_calculates_correctly&#13;
Failed asserting that 4120739.0 matches expected 150000.
&#13;
C:\PreIPO\backend\tests\Unit\InventoryServiceTest.php:43</failure>
        </testcase>
        <testcase name="test_reorder_suggestion_based_on_allocation_rate" file="C:\PreIPO\backend\tests\Unit\InventoryServiceTest.php" line="69" class="Tests\Unit\InventoryServiceTest" classname="Tests.Unit.InventoryServiceTest" assertions="0" time="0.139853">
          <error type="Illuminate\Database\QueryException">Tests\Unit\InventoryServiceTest::test_reorder_suggestion_based_on_allocation_rate&#13;
Illuminate\Database\QueryException: SQLSTATE[23000]: Integrity constraint violation: 1048 Column 'payment_id' cannot be null (Connection: mysql, SQL: insert into `user_investments` (`user_id`, `product_id`, `payment_id`, `subscription_id`, `bulk_purchase_id`, `shares`, `price_per_share`, `total_amount`, `units_allocated`, `value_allocated`, `source`, `status`, `allocated_at`, `exited_at`, `is_reversed`, `created_at`, `updated_at`) values (18238, 2741, ?, 3980, 743, 36, 1713.87, 61699.32, 36, 10000, sip, active, 2026-02-22 10:39:13, ?, 0, 2026-02-17 10:39:13, 2026-02-22 10:39:14))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
C:\PreIPO\backend\tests\Unit\InventoryServiceTest.php:79</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Unit\RiskScoringServiceTest" file="C:\PreIPO\backend\tests\Unit\RiskScoringServiceTest.php" tests="15" assertions="33" errors="0" failures="0" skipped="0" time="4.352996">
        <testcase name="should_block_returns_false_below_threshold" file="C:\PreIPO\backend\tests\Unit\RiskScoringServiceTest.php" line="139" class="Tests\Unit\RiskScoringServiceTest" classname="Tests.Unit.RiskScoringServiceTest" assertions="2" time="0.255316"/>
        <testcase name="calculate_score_includes_open_disputes" file="C:\PreIPO\backend\tests\Unit\RiskScoringServiceTest.php" line="173" class="Tests\Unit\RiskScoringServiceTest" classname="Tests.Unit.RiskScoringServiceTest" assertions="1" time="0.306460"/>
        <testcase name="get_risk_category_returns_correct_category" file="C:\PreIPO\backend\tests\Unit\RiskScoringServiceTest.php" line="158" class="Tests\Unit\RiskScoringServiceTest" classname="Tests.Unit.RiskScoringServiceTest" assertions="4" time="0.279566"/>
        <testcase name="calculate_score_includes_new_account_factor" file="C:\PreIPO\backend\tests\Unit\RiskScoringServiceTest.php" line="98" class="Tests\Unit\RiskScoringServiceTest" classname="Tests.Unit.RiskScoringServiceTest" assertions="1" time="0.261269"/>
        <testcase name="calculate_score_weights_critical_disputes_higher" file="C:\PreIPO\backend\tests\Unit\RiskScoringServiceTest.php" line="184" class="Tests\Unit\RiskScoringServiceTest" classname="Tests.Unit.RiskScoringServiceTest" assertions="1" time="0.309576"/>
        <testcase name="should_block_returns_true_above_threshold" file="C:\PreIPO\backend\tests\Unit\RiskScoringServiceTest.php" line="130" class="Tests\Unit\RiskScoringServiceTest" classname="Tests.Unit.RiskScoringServiceTest" assertions="2" time="0.263359"/>
        <testcase name="calculate_score_includes_chargeback_base_weight" file="C:\PreIPO\backend\tests\Unit\RiskScoringServiceTest.php" line="42" class="Tests\Unit\RiskScoringServiceTest" classname="Tests.Unit.RiskScoringServiceTest" assertions="3" time="0.290835"/>
        <testcase name="calculate_score_applies_repeat_weight_for_multiple_chargebacks" file="C:\PreIPO\backend\tests\Unit\RiskScoringServiceTest.php" line="55" class="Tests\Unit\RiskScoringServiceTest" classname="Tests.Unit.RiskScoringServiceTest" assertions="2" time="0.316742"/>
        <testcase name="calculate_score_returns_zero_for_clean_user" file="C:\PreIPO\backend\tests\Unit\RiskScoringServiceTest.php" line="33" class="Tests\Unit\RiskScoringServiceTest" classname="Tests.Unit.RiskScoringServiceTest" assertions="2" time="0.261127"/>
        <testcase name="calculate_score_excludes_new_account_factor_for_established_users" file="C:\PreIPO\backend\tests\Unit\RiskScoringServiceTest.php" line="113" class="Tests\Unit\RiskScoringServiceTest" classname="Tests.Unit.RiskScoringServiceTest" assertions="1" time="0.278268"/>
        <testcase name="calculate_score_is_deterministic" file="C:\PreIPO\backend\tests\Unit\RiskScoringServiceTest.php" line="86" class="Tests\Unit\RiskScoringServiceTest" classname="Tests.Unit.RiskScoringServiceTest" assertions="2" time="0.322552"/>
        <testcase name="is_high_risk_returns_correct_values" file="C:\PreIPO\backend\tests\Unit\RiskScoringServiceTest.php" line="148" class="Tests\Unit\RiskScoringServiceTest" classname="Tests.Unit.RiskScoringServiceTest" assertions="3" time="0.268865"/>
        <testcase name="calculate_score_caps_at_100" file="C:\PreIPO\backend\tests\Unit\RiskScoringServiceTest.php" line="72" class="Tests\Unit\RiskScoringServiceTest" classname="Tests.Unit.RiskScoringServiceTest" assertions="2" time="0.350384"/>
        <testcase name="get_risk_summary_returns_complete_data" file="C:\PreIPO\backend\tests\Unit\RiskScoringServiceTest.php" line="203" class="Tests\Unit\RiskScoringServiceTest" classname="Tests.Unit.RiskScoringServiceTest" assertions="6" time="0.293560"/>
        <testcase name="get_chargeback_history_returns_only_confirmed_chargebacks" file="C:\PreIPO\backend\tests\Unit\RiskScoringServiceTest.php" line="218" class="Tests\Unit\RiskScoringServiceTest" classname="Tests.Unit.RiskScoringServiceTest" assertions="1" time="0.295116"/>
      </testsuite>
      <testsuite name="Tests\Unit\UserProfitShareTest" file="C:\PreIPO\backend\tests\Unit\UserProfitShareTest.php" tests="4" assertions="0" errors="4" failures="0" skipped="0" time="0.000000">
        <testcase name="test_user_share_belongs_to_profit_share" file="C:\PreIPO\backend\tests\Unit\UserProfitShareTest.php" line="40" class="Tests\Unit\UserProfitShareTest" classname="Tests.Unit.UserProfitShareTest" assertions="0" time="0.000000">
          <error type="Error">Tests\Unit\UserProfitShareTest::test_user_share_belongs_to_profit_share&#13;
Error: Class "Database\Factories\ProfitShareFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\UserProfitShareTest.php:21</error>
        </testcase>
        <testcase name="test_user_share_belongs_to_user" file="C:\PreIPO\backend\tests\Unit\UserProfitShareTest.php" line="27" class="Tests\Unit\UserProfitShareTest" classname="Tests.Unit.UserProfitShareTest" assertions="0" time="0.000000">
          <error type="Error">Tests\Unit\UserProfitShareTest::test_user_share_belongs_to_user&#13;
Error: Class "Database\Factories\ProfitShareFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\UserProfitShareTest.php:21</error>
        </testcase>
        <testcase name="test_user_share_validates_amount_positive" file="C:\PreIPO\backend\tests\Unit\UserProfitShareTest.php" line="53" class="Tests\Unit\UserProfitShareTest" classname="Tests.Unit.UserProfitShareTest" assertions="0" time="0.000000">
          <error type="Error">Tests\Unit\UserProfitShareTest::test_user_share_validates_amount_positive&#13;
Error: Class "Database\Factories\ProfitShareFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\UserProfitShareTest.php:21</error>
        </testcase>
        <testcase name="test_user_share_tracks_credited_to_wallet" file="C:\PreIPO\backend\tests\Unit\UserProfitShareTest.php" line="66" class="Tests\Unit\UserProfitShareTest" classname="Tests.Unit.UserProfitShareTest" assertions="0" time="0.000000">
          <error type="Error">Tests\Unit\UserProfitShareTest::test_user_share_tracks_credited_to_wallet&#13;
Error: Class "Database\Factories\ProfitShareFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\UserProfitShareTest.php:21</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Unit\LuckyDrawEntryTest" file="C:\PreIPO\backend\tests\Unit\LuckyDrawEntryTest.php" tests="6" assertions="1" errors="5" failures="1" skipped="0" time="0.822184">
        <testcase name="test_entry_tracks_entries_count" file="C:\PreIPO\backend\tests\Unit\LuckyDrawEntryTest.php" line="50" class="Tests\Unit\LuckyDrawEntryTest" classname="Tests.Unit.LuckyDrawEntryTest" assertions="0" time="0.099647">
          <error type="Error">Tests\Unit\LuckyDrawEntryTest::test_entry_tracks_entries_count&#13;
Error: Class "Database\Factories\LuckyDrawEntryFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\LuckyDrawEntryTest.php:52</error>
        </testcase>
        <testcase name="test_entry_validates_entries_positive" file="C:\PreIPO\backend\tests\Unit\LuckyDrawEntryTest.php" line="88" class="Tests\Unit\LuckyDrawEntryTest" classname="Tests.Unit.LuckyDrawEntryTest" assertions="1" time="0.089438">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\LuckyDrawEntryTest::test_entry_validates_entries_positive&#13;
Failed asserting that exception of type "Error" matches expected exception "InvalidArgumentException". Message was: "Class "Database\Factories\LuckyDrawEntryFactory" not found" at
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\LuckyDrawEntryTest.php:93
.</failure>
        </testcase>
        <testcase name="test_entry_belongs_to_user" file="C:\PreIPO\backend\tests\Unit\LuckyDrawEntryTest.php" line="26" class="Tests\Unit\LuckyDrawEntryTest" classname="Tests.Unit.LuckyDrawEntryTest" assertions="0" time="0.078486">
          <error type="Error">Tests\Unit\LuckyDrawEntryTest::test_entry_belongs_to_user&#13;
Error: Class "Database\Factories\LuckyDrawEntryFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\LuckyDrawEntryTest.php:28</error>
        </testcase>
        <testcase name="test_entry_tracks_bonus_entries" file="C:\PreIPO\backend\tests\Unit\LuckyDrawEntryTest.php" line="62" class="Tests\Unit\LuckyDrawEntryTest" classname="Tests.Unit.LuckyDrawEntryTest" assertions="0" time="0.106887">
          <error type="Error">Tests\Unit\LuckyDrawEntryTest::test_entry_tracks_bonus_entries&#13;
Error: Class "Database\Factories\LuckyDrawEntryFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\LuckyDrawEntryTest.php:64</error>
        </testcase>
        <testcase name="test_entry_belongs_to_lucky_draw" file="C:\PreIPO\backend\tests\Unit\LuckyDrawEntryTest.php" line="38" class="Tests\Unit\LuckyDrawEntryTest" classname="Tests.Unit.LuckyDrawEntryTest" assertions="0" time="0.070799">
          <error type="Error">Tests\Unit\LuckyDrawEntryTest::test_entry_belongs_to_lucky_draw&#13;
Error: Class "Database\Factories\LuckyDrawEntryFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\LuckyDrawEntryTest.php:40</error>
        </testcase>
        <testcase name="test_entry_calculates_total_entries" file="C:\PreIPO\backend\tests\Unit\LuckyDrawEntryTest.php" line="74" class="Tests\Unit\LuckyDrawEntryTest" classname="Tests.Unit.LuckyDrawEntryTest" assertions="0" time="0.376928">
          <error type="Error">Tests\Unit\LuckyDrawEntryTest::test_entry_calculates_total_entries&#13;
Error: Class "Database\Factories\LuckyDrawEntryFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\LuckyDrawEntryTest.php:76</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Unit\WithdrawalServiceTest" file="C:\PreIPO\backend\tests\Unit\WithdrawalServiceTest.php" tests="4" assertions="2" errors="2" failures="2" skipped="0" time="1.167969">
        <testcase name="test_approve_withdrawal_initiates_bank_transfer_event" file="C:\PreIPO\backend\tests\Unit\WithdrawalServiceTest.php" line="65" class="Tests\Unit\WithdrawalServiceTest" classname="Tests.Unit.WithdrawalServiceTest" assertions="0" time="0.339482">
          <error type="Error">Tests\Unit\WithdrawalServiceTest::test_approve_withdrawal_initiates_bank_transfer_event&#13;
Error: Call to undefined method App\Services\WithdrawalService::requestWithdrawal()
&#13;
C:\PreIPO\backend\tests\Unit\WithdrawalServiceTest.php:69</error>
        </testcase>
        <testcase name="test_complete_withdrawal_updates_wallet_balance" file="C:\PreIPO\backend\tests\Unit\WithdrawalServiceTest.php" line="81" class="Tests\Unit\WithdrawalServiceTest" classname="Tests.Unit.WithdrawalServiceTest" assertions="0" time="0.266400">
          <error type="Error">Tests\Unit\WithdrawalServiceTest::test_complete_withdrawal_updates_wallet_balance&#13;
Error: Call to undefined method App\Services\WithdrawalService::requestWithdrawal()
&#13;
C:\PreIPO\backend\tests\Unit\WithdrawalServiceTest.php:83</error>
        </testcase>
        <testcase name="test_request_withdrawal_validates_minimum_amount" file="C:\PreIPO\backend\tests\Unit\WithdrawalServiceTest.php" line="56" class="Tests\Unit\WithdrawalServiceTest" classname="Tests.Unit.WithdrawalServiceTest" assertions="1" time="0.289525">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\WithdrawalServiceTest::test_request_withdrawal_validates_minimum_amount&#13;
Failed asserting that exception of type "Error" matches expected exception "Exception". Message was: "Call to undefined method App\Services\WithdrawalService::requestWithdrawal()" at
C:\PreIPO\backend\tests\Unit\WithdrawalServiceTest.php:61
.</failure>
        </testcase>
        <testcase name="test_request_withdrawal_validates_kyc_approved" file="C:\PreIPO\backend\tests\Unit\WithdrawalServiceTest.php" line="45" class="Tests\Unit\WithdrawalServiceTest" classname="Tests.Unit.WithdrawalServiceTest" assertions="1" time="0.272561">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\WithdrawalServiceTest::test_request_withdrawal_validates_kyc_approved&#13;
Failed asserting that exception of type "Error" matches expected exception "Exception". Message was: "Call to undefined method App\Services\WithdrawalService::requestWithdrawal()" at
C:\PreIPO\backend\tests\Unit\WithdrawalServiceTest.php:52
.</failure>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Unit\EmailServiceTest" file="C:\PreIPO\backend\tests\Unit\EmailServiceTest.php" tests="8" assertions="0" errors="8" failures="0" skipped="0" time="0.000000">
        <testcase name="test_send_email_uses_correct_template" file="C:\PreIPO\backend\tests\Unit\EmailServiceTest.php" line="34" class="Tests\Unit\EmailServiceTest" classname="Tests.Unit.EmailServiceTest" assertions="0" time="0.000000">
          <error type="Error">Tests\Unit\EmailServiceTest::test_send_email_uses_correct_template&#13;
Error: Class "Database\Factories\EmailTemplateFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\EmailServiceTest.php:27</error>
        </testcase>
        <testcase name="test_send_email_queues_for_async_delivery" file="C:\PreIPO\backend\tests\Unit\EmailServiceTest.php" line="90" class="Tests\Unit\EmailServiceTest" classname="Tests.Unit.EmailServiceTest" assertions="0" time="0.000000">
          <error type="Error">Tests\Unit\EmailServiceTest::test_send_email_queues_for_async_delivery&#13;
Error: Class "Database\Factories\EmailTemplateFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\EmailServiceTest.php:27</error>
        </testcase>
        <testcase name="test_send_email_respects_user_preferences" file="C:\PreIPO\backend\tests\Unit\EmailServiceTest.php" line="97" class="Tests\Unit\EmailServiceTest" classname="Tests.Unit.EmailServiceTest" assertions="0" time="0.000000">
          <error type="Error">Tests\Unit\EmailServiceTest::test_send_email_respects_user_preferences&#13;
Error: Class "Database\Factories\EmailTemplateFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\EmailServiceTest.php:27</error>
        </testcase>
        <testcase name="test_send_email_logs_delivery" file="C:\PreIPO\backend\tests\Unit\EmailServiceTest.php" line="54" class="Tests\Unit\EmailServiceTest" classname="Tests.Unit.EmailServiceTest" assertions="0" time="0.000000">
          <error type="Error">Tests\Unit\EmailServiceTest::test_send_email_logs_delivery&#13;
Error: Class "Database\Factories\EmailTemplateFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\EmailServiceTest.php:27</error>
        </testcase>
        <testcase name="test_send_email_validates_recipient" file="C:\PreIPO\backend\tests\Unit\EmailServiceTest.php" line="113" class="Tests\Unit\EmailServiceTest" classname="Tests.Unit.EmailServiceTest" assertions="0" time="0.000000">
          <error type="Error">Tests\Unit\EmailServiceTest::test_send_email_validates_recipient&#13;
Error: Class "Database\Factories\EmailTemplateFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\EmailServiceTest.php:27</error>
        </testcase>
        <testcase name="test_send_email_handles_sendgrid_failure" file="C:\PreIPO\backend\tests\Unit\EmailServiceTest.php" line="65" class="Tests\Unit\EmailServiceTest" classname="Tests.Unit.EmailServiceTest" assertions="0" time="0.000000">
          <error type="Error">Tests\Unit\EmailServiceTest::test_send_email_handles_sendgrid_failure&#13;
Error: Class "Database\Factories\EmailTemplateFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\EmailServiceTest.php:27</error>
        </testcase>
        <testcase name="test_batch_email_sends_in_chunks" file="C:\PreIPO\backend\tests\Unit\EmailServiceTest.php" line="124" class="Tests\Unit\EmailServiceTest" classname="Tests.Unit.EmailServiceTest" assertions="0" time="0.000000">
          <error type="Error">Tests\Unit\EmailServiceTest::test_batch_email_sends_in_chunks&#13;
Error: Class "Database\Factories\EmailTemplateFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\EmailServiceTest.php:27</error>
        </testcase>
        <testcase name="test_send_email_replaces_variables" file="C:\PreIPO\backend\tests\Unit\EmailServiceTest.php" line="45" class="Tests\Unit\EmailServiceTest" classname="Tests.Unit.EmailServiceTest" assertions="0" time="0.000000">
          <error type="Error">Tests\Unit\EmailServiceTest::test_send_email_replaces_variables&#13;
Error: Class "Database\Factories\EmailTemplateFactory" not found
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:871
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\HasFactory.php:21
C:\PreIPO\backend\tests\Unit\EmailServiceTest.php:27</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Unit\SqlInjectionTest" file="C:\PreIPO\backend\tests\Unit\SqlInjectionTest.php" tests="1" assertions="0" errors="1" failures="0" skipped="0" time="0.086124">
        <testcase name="testSqlInjectionPreventionWorks" file="C:\PreIPO\backend\tests\Unit\SqlInjectionTest.php" line="12" class="Tests\Unit\SqlInjectionTest" classname="Tests.Unit.SqlInjectionTest" assertions="0" time="0.086124">
          <error type="PHPUnit\Framework\MockObject\Generator\UnknownTypeException">Tests\Unit\SqlInjectionTest::testSqlInjectionPreventionWorks&#13;
PHPUnit\Framework\MockObject\Generator\UnknownTypeException: Class or interface "Tests\Unit\Statement" does not exist
&#13;
C:\PreIPO\backend\tests\Unit\SqlInjectionTest.php:18</error>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Unit\WithdrawalTest" file="C:\PreIPO\backend\tests\Unit\WithdrawalTest.php" tests="8" assertions="9" errors="3" failures="1" skipped="0" time="0.818980">
        <testcase name="test_withdrawal_belongs_to_user" file="C:\PreIPO\backend\tests\Unit\WithdrawalTest.php" line="31" class="Tests\Unit\WithdrawalTest" classname="Tests.Unit.WithdrawalTest" assertions="2" time="0.122411"/>
        <testcase name="test_withdrawal_status_enum_validates" file="C:\PreIPO\backend\tests\Unit\WithdrawalTest.php" line="55" class="Tests\Unit\WithdrawalTest" classname="Tests.Unit.WithdrawalTest" assertions="2" time="0.106925"/>
        <testcase name="test_withdrawal_calculates_fee" file="C:\PreIPO\backend\tests\Unit\WithdrawalTest.php" line="99" class="Tests\Unit\WithdrawalTest" classname="Tests.Unit.WithdrawalTest" assertions="0" time="0.091761">
          <error type="Illuminate\Database\QueryException">Tests\Unit\WithdrawalTest::test_withdrawal_calculates_fee&#13;
Illuminate\Database\QueryException: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' (Connection: mysql, SQL: insert into `withdrawals` (`user_id`, `wallet_id`, `amount_paise`, `fee_paise`, `tds_deducted_paise`, `net_amount_paise`, `status`, `bank_details`, `admin_id`, `utr_number`, `rejection_reason`, `amount`, `fee`, `updated_at`, `created_at`) values (18317, 19624, 250334, 0, 0, 250334, pending, {"bank_account_number":"25321149282","bank_ifsc":"TEST0001234","bank_name":"Murazik, Graham and Hegmann","account_holder_name":"Ludie Tillman"}, ?, ?, ?, 1000, 50, 2026-02-22 10:39:23, 2026-02-22 10:39:23))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
C:\PreIPO\backend\tests\Unit\WithdrawalTest.php:101</error>
        </testcase>
        <testcase name="test_withdrawal_belongs_to_wallet" file="C:\PreIPO\backend\tests\Unit\WithdrawalTest.php" line="43" class="Tests\Unit\WithdrawalTest" classname="Tests.Unit.WithdrawalTest" assertions="2" time="0.119303"/>
        <testcase name="test_withdrawal_tracks_processed_by_admin" file="C:\PreIPO\backend\tests\Unit\WithdrawalTest.php" line="127" class="Tests\Unit\WithdrawalTest" classname="Tests.Unit.WithdrawalTest" assertions="0" time="0.076470">
          <error type="Illuminate\Database\QueryException">Tests\Unit\WithdrawalTest::test_withdrawal_tracks_processed_by_admin&#13;
Illuminate\Database\QueryException: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' (Connection: mysql, SQL: insert into `withdrawals` (`user_id`, `wallet_id`, `amount_paise`, `fee_paise`, `tds_deducted_paise`, `net_amount_paise`, `status`, `bank_details`, `admin_id`, `utr_number`, `rejection_reason`, `amount`, `updated_at`, `created_at`) values (18321, 19630, 3720024, 0, 0, 3720024, pending, {"bank_account_number":"71394311866976","bank_ifsc":"TEST0001234","bank_name":"Aufderhar, Schinner and Bosco","account_holder_name":"Edgar Moen"}, 18322, ?, ?, 1000, 2026-02-22 10:39:23, 2026-02-22 10:39:23))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
C:\PreIPO\backend\tests\Unit\WithdrawalTest.php:129</error>
        </testcase>
        <testcase name="test_withdrawal_calculates_net_amount" file="C:\PreIPO\backend\tests\Unit\WithdrawalTest.php" line="112" class="Tests\Unit\WithdrawalTest" classname="Tests.Unit.WithdrawalTest" assertions="0" time="0.074612">
          <error type="Illuminate\Database\QueryException">Tests\Unit\WithdrawalTest::test_withdrawal_calculates_net_amount&#13;
Illuminate\Database\QueryException: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' (Connection: mysql, SQL: insert into `withdrawals` (`user_id`, `wallet_id`, `amount_paise`, `fee_paise`, `tds_deducted_paise`, `net_amount_paise`, `status`, `bank_details`, `admin_id`, `utr_number`, `rejection_reason`, `amount`, `fee`, `updated_at`, `created_at`) values (18323, 19633, 2305196, 0, 0, 2305196, pending, {"bank_account_number":"87142712771","bank_ifsc":"TEST0001234","bank_name":"Lueilwitz, Beier and Rippin","account_holder_name":"Ophelia Braun III"}, ?, ?, ?, 1000, 50, 2026-02-22 10:39:23, 2026-02-22 10:39:23))
&#13;
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:825
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
C:\PreIPO\backend\tests\Unit\WithdrawalTest.php:115</error>
        </testcase>
        <testcase name="test_withdrawal_validates_sufficient_balance" file="C:\PreIPO\backend\tests\Unit\WithdrawalTest.php" line="86" class="Tests\Unit\WithdrawalTest" classname="Tests.Unit.WithdrawalTest" assertions="2" time="0.130391"/>
        <testcase name="test_withdrawal_validates_amount_positive" file="C:\PreIPO\backend\tests\Unit\WithdrawalTest.php" line="73" class="Tests\Unit\WithdrawalTest" classname="Tests.Unit.WithdrawalTest" assertions="1" time="0.097107">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\WithdrawalTest::test_withdrawal_validates_amount_positive&#13;
Failed asserting that exception of type "Illuminate\Database\QueryException" matches expected exception "InvalidArgumentException". Message was: "SQLSTATE[42S22]: Column not found: 1054 Unknown column 'amount' in 'field list' (Connection: mysql, SQL: insert into `withdrawals` (`user_id`, `wallet_id`, `amount_paise`, `fee_paise`, `tds_deducted_paise`, `net_amount_paise`, `status`, `bank_details`, `admin_id`, `utr_number`, `rejection_reason`, `amount`, `updated_at`, `created_at`) values (18327, 19639, 3690228, 0, 0, 3690228, pending, {"bank_account_number":"79241046001","bank_ifsc":"TEST0001234","bank_name":"Schuster-Blanda","account_holder_name":"Frederik Ondricka"}, ?, ?, ?, -100, 2026-02-22 10:39:24, 2026-02-22 10:39:24))" at
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:47
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:812
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Connection.php:779
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\MySqlConnection.php:42
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Processors\MySqlProcessor.php:35
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Query\Builder.php:3766
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Builder.php:2120
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1359
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1324
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1163
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:352
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Collections\Traits\EnumeratesValues.php:261
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:347
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:303
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Factories\Factory.php:297
C:\PreIPO\backend\tests\Unit\WithdrawalTest.php:78
.</failure>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Unit\SubscriptionServiceTest" file="C:\PreIPO\backend\tests\Unit\SubscriptionServiceTest.php" tests="8" assertions="19" errors="0" failures="0" skipped="0" time="2.355610">
        <testcase name="test_create_subscription_validates_kyc_required" file="C:\PreIPO\backend\tests\Unit\SubscriptionServiceTest.php" line="36" class="Tests\Unit\SubscriptionServiceTest" classname="Tests.Unit.SubscriptionServiceTest" assertions="2" time="0.312908"/>
        <testcase name="test_pause_subscription_updates_status" file="C:\PreIPO\backend\tests\Unit\SubscriptionServiceTest.php" line="81" class="Tests\Unit\SubscriptionServiceTest" classname="Tests.Unit.SubscriptionServiceTest" assertions="2" time="0.276085"/>
        <testcase name="test_resume_subscription_recalculates_dates" file="C:\PreIPO\backend\tests\Unit\SubscriptionServiceTest.php" line="99" class="Tests\Unit\SubscriptionServiceTest" classname="Tests.Unit.SubscriptionServiceTest" assertions="2" time="0.310229"/>
        <testcase name="test_pause_subscription_validates_limit" file="C:\PreIPO\backend\tests\Unit\SubscriptionServiceTest.php" line="65" class="Tests\Unit\SubscriptionServiceTest" classname="Tests.Unit.SubscriptionServiceTest" assertions="2" time="0.305474"/>
        <testcase name="test_upgrade_plan_calculates_differential_charge" file="C:\PreIPO\backend\tests\Unit\SubscriptionServiceTest.php" line="110" class="Tests\Unit\SubscriptionServiceTest" classname="Tests.Unit.SubscriptionServiceTest" assertions="4" time="0.274891"/>
        <testcase name="test_cancel_subscription_processes_refund" file="C:\PreIPO\backend\tests\Unit\SubscriptionServiceTest.php" line="163" class="Tests\Unit\SubscriptionServiceTest" classname="Tests.Unit.SubscriptionServiceTest" assertions="2" time="0.302338"/>
        <testcase name="test_create_subscription_sets_next_payment_date" file="C:\PreIPO\backend\tests\Unit\SubscriptionServiceTest.php" line="47" class="Tests\Unit\SubscriptionServiceTest" classname="Tests.Unit.SubscriptionServiceTest" assertions="2" time="0.304995"/>
        <testcase name="test_downgrade_plan_calculates_refund" file="C:\PreIPO\backend\tests\Unit\SubscriptionServiceTest.php" line="145" class="Tests\Unit\SubscriptionServiceTest" classname="Tests.Unit.SubscriptionServiceTest" assertions="3" time="0.268689"/>
      </testsuite>
      <testsuite name="Tests\Unit\RiskGuardServiceTest" file="C:\PreIPO\backend\tests\Unit\RiskGuardServiceTest.php" tests="12" assertions="25" errors="0" failures="0" skipped="0" time="3.398937">
        <testcase name="get_blocking_details_returns_null_for_non_blocked_user" file="C:\PreIPO\backend\tests\Unit\RiskGuardServiceTest.php" line="124" class="Tests\Unit\RiskGuardServiceTest" classname="Tests.Unit.RiskGuardServiceTest" assertions="1" time="0.276942"/>
        <testcase name="risk_blocked_exception_provides_user_friendly_message" file="C:\PreIPO\backend\tests\Unit\RiskGuardServiceTest.php" line="169" class="Tests\Unit\RiskGuardServiceTest" classname="Tests.Unit.RiskGuardServiceTest" assertions="2" time="0.331557"/>
        <testcase name="is_user_blocked_returns_false_for_non_blocked_user" file="C:\PreIPO\backend\tests\Unit\RiskGuardServiceTest.php" line="102" class="Tests\Unit\RiskGuardServiceTest" classname="Tests.Unit.RiskGuardServiceTest" assertions="1" time="0.268190"/>
        <testcase name="risk_blocked_exception_has_correct_http_code" file="C:\PreIPO\backend\tests\Unit\RiskGuardServiceTest.php" line="153" class="Tests\Unit\RiskGuardServiceTest" classname="Tests.Unit.RiskGuardServiceTest" assertions="1" time="0.285482"/>
        <testcase name="assert_user_can_invest_includes_operation_context_in_exception" file="C:\PreIPO\backend\tests\Unit\RiskGuardServiceTest.php" line="55" class="Tests\Unit\RiskGuardServiceTest" classname="Tests.Unit.RiskGuardServiceTest" assertions="3" time="0.333439"/>
        <testcase name="risk_blocked_exception_report_context_includes_required_fields" file="C:\PreIPO\backend\tests\Unit\RiskGuardServiceTest.php" line="186" class="Tests\Unit\RiskGuardServiceTest" classname="Tests.Unit.RiskGuardServiceTest" assertions="6" time="0.261249"/>
        <testcase name="is_user_blocked_returns_true_for_blocked_user" file="C:\PreIPO\backend\tests\Unit\RiskGuardServiceTest.php" line="94" class="Tests\Unit\RiskGuardServiceTest" classname="Tests.Unit.RiskGuardServiceTest" assertions="1" time="0.295040"/>
        <testcase name="assert_user_can_invest_passes_for_non_blocked_user" file="C:\PreIPO\backend\tests\Unit\RiskGuardServiceTest.php" line="26" class="Tests\Unit\RiskGuardServiceTest" classname="Tests.Unit.RiskGuardServiceTest" assertions="1" time="0.278851"/>
        <testcase name="assert_user_can_invest_refreshes_user_state" file="C:\PreIPO\backend\tests\Unit\RiskGuardServiceTest.php" line="76" class="Tests\Unit\RiskGuardServiceTest" classname="Tests.Unit.RiskGuardServiceTest" assertions="1" time="0.268958"/>
        <testcase name="assert_user_can_invest_throws_for_blocked_user" file="C:\PreIPO\backend\tests\Unit\RiskGuardServiceTest.php" line="41" class="Tests\Unit\RiskGuardServiceTest" classname="Tests.Unit.RiskGuardServiceTest" assertions="1" time="0.288651"/>
        <testcase name="get_blocking_details_returns_complete_info_for_blocked_user" file="C:\PreIPO\backend\tests\Unit\RiskGuardServiceTest.php" line="132" class="Tests\Unit\RiskGuardServiceTest" classname="Tests.Unit.RiskGuardServiceTest" assertions="5" time="0.255088"/>
        <testcase name="can_user_invest_returns_inverse_of_blocked_status" file="C:\PreIPO\backend\tests\Unit\RiskGuardServiceTest.php" line="112" class="Tests\Unit\RiskGuardServiceTest" classname="Tests.Unit.RiskGuardServiceTest" assertions="2" time="0.255490"/>
      </testsuite>
      <testsuite name="Tests\Unit\PaymentTest" file="C:\PreIPO\backend\tests\Unit\PaymentTest.php" tests="12" assertions="19" errors="1" failures="0" skipped="0" time="1.298003">
        <testcase name="test_payment_marks_as_on_time_correctly" file="C:\PreIPO\backend\tests\Unit\PaymentTest.php" line="106" class="Tests\Unit\PaymentTest" classname="Tests.Unit.PaymentTest" assertions="2" time="0.179774"/>
        <testcase name="test_payment_status_enum_validates" file="C:\PreIPO\backend\tests\Unit\PaymentTest.php" line="55" class="Tests\Unit\PaymentTest" classname="Tests.Unit.PaymentTest" assertions="1" time="0.088367">
          <error type="RuntimeException">Tests\Unit\PaymentTest::test_payment_status_enum_validates&#13;
RuntimeException: Invalid payment state transition: 'paid'  'failed'. Valid transitions from 'paid': [refunded, settled, chargeback_pending]
&#13;
C:\PreIPO\backend\app\Models\Payment.php:182
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:459
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:287
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:267
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Events\Dispatcher.php:233
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Concerns\HasEvents.php:224
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1222
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1156
C:\PreIPO\backend\vendor\laravel\framework\src\Illuminate\Database\Eloquent\Model.php:1014
C:\PreIPO\backend\tests\Unit\PaymentTest.php:61</error>
        </testcase>
        <testcase name="test_payment_calculates_due_date" file="C:\PreIPO\backend\tests\Unit\PaymentTest.php" line="125" class="Tests\Unit\PaymentTest" classname="Tests.Unit.PaymentTest" assertions="1" time="0.082937"/>
        <testcase name="test_payment_scope_failed_returns_correct_records" file="C:\PreIPO\backend\tests\Unit\PaymentTest.php" line="146" class="Tests\Unit\PaymentTest" classname="Tests.Unit.PaymentTest" assertions="2" time="0.130327"/>
        <testcase name="test_payment_scope_pending_returns_correct_records" file="C:\PreIPO\backend\tests\Unit\PaymentTest.php" line="156" class="Tests\Unit\PaymentTest" classname="Tests.Unit.PaymentTest" assertions="2" time="0.088640"/>
        <testcase name="test_payment_scope_paid_returns_correct_records" file="C:\PreIPO\backend\tests\Unit\PaymentTest.php" line="135" class="Tests\Unit\PaymentTest" classname="Tests.Unit.PaymentTest" assertions="2" time="0.099065"/>
        <testcase name="test_payment_belongs_to_user" file="C:\PreIPO\backend\tests\Unit\PaymentTest.php" line="28" class="Tests\Unit\PaymentTest" classname="Tests.Unit.PaymentTest" assertions="2" time="0.116141"/>
        <testcase name="test_payment_method_enum_validates" file="C:\PreIPO\backend\tests\Unit\PaymentTest.php" line="69" class="Tests\Unit\PaymentTest" classname="Tests.Unit.PaymentTest" assertions="2" time="0.097434"/>
        <testcase name="test_payment_belongs_to_subscription" file="C:\PreIPO\backend\tests\Unit\PaymentTest.php" line="42" class="Tests\Unit\PaymentTest" classname="Tests.Unit.PaymentTest" assertions="2" time="0.072264"/>
        <testcase name="test_payment_tracks_signature" file="C:\PreIPO\backend\tests\Unit\PaymentTest.php" line="97" class="Tests\Unit\PaymentTest" classname="Tests.Unit.PaymentTest" assertions="1" time="0.083122"/>
        <testcase name="test_payment_tracks_razorpay_payment_id" file="C:\PreIPO\backend\tests\Unit\PaymentTest.php" line="88" class="Tests\Unit\PaymentTest" classname="Tests.Unit.PaymentTest" assertions="1" time="0.169270"/>
        <testcase name="test_payment_tracks_razorpay_order_id" file="C:\PreIPO\backend\tests\Unit\PaymentTest.php" line="79" class="Tests\Unit\PaymentTest" classname="Tests.Unit.PaymentTest" assertions="1" time="0.090662"/>
      </testsuite>
      <testsuite name="Tests\Unit\AdminRoutesSecurityTest" file="C:\PreIPO\backend\tests\Unit\AdminRoutesSecurityTest.php" tests="1" assertions="3" errors="0" failures="1" skipped="0" time="0.016857">
        <testcase name="testUnauthorizedAccessToAdminRoutesFails" file="C:\PreIPO\backend\tests\Unit\AdminRoutesSecurityTest.php" line="51" class="Tests\Unit\AdminRoutesSecurityTest" classname="Tests.Unit.AdminRoutesSecurityTest" assertions="3" time="0.016857">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\AdminRoutesSecurityTest::testUnauthorizedAccessToAdminRoutesFails&#13;
Failed asserting that an array contains 403.
&#13;
C:\PreIPO\backend\tests\Unit\AdminRoutesSecurityTest.php:59</failure>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Unit\ProductPriceHistoryTest" file="C:\PreIPO\backend\tests\Unit\ProductPriceHistoryTest.php" tests="4" assertions="7" errors="0" failures="1" skipped="0" time="0.325617">
        <testcase name="test_price_history_belongs_to_product" file="C:\PreIPO\backend\tests\Unit\ProductPriceHistoryTest.php" line="22" class="Tests\Unit\ProductPriceHistoryTest" classname="Tests.Unit.ProductPriceHistoryTest" assertions="2" time="0.082795"/>
        <testcase name="test_price_history_tracks_price_changes" file="C:\PreIPO\backend\tests\Unit\ProductPriceHistoryTest.php" line="35" class="Tests\Unit\ProductPriceHistoryTest" classname="Tests.Unit.ProductPriceHistoryTest" assertions="2" time="0.105162"/>
        <testcase name="test_price_history_validates_price_positive" file="C:\PreIPO\backend\tests\Unit\ProductPriceHistoryTest.php" line="50" class="Tests\Unit\ProductPriceHistoryTest" classname="Tests.Unit.ProductPriceHistoryTest" assertions="2" time="0.069893"/>
        <testcase name="test_price_history_orders_by_date_descending" file="C:\PreIPO\backend\tests\Unit\ProductPriceHistoryTest.php" line="63" class="Tests\Unit\ProductPriceHistoryTest" classname="Tests.Unit.ProductPriceHistoryTest" assertions="1" time="0.067768">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\ProductPriceHistoryTest::test_price_history_orders_by_date_descending&#13;
Failed asserting that 57 matches expected 58.
&#13;
C:\PreIPO\backend\tests\Unit\ProductPriceHistoryTest.php:84</failure>
        </testcase>
      </testsuite>
      <testsuite name="Tests\Unit\WalletTest" file="C:\PreIPO\backend\tests\Unit\WalletTest.php" tests="10" assertions="15" errors="0" failures="0" skipped="0" time="0.904927">
        <testcase name="test_wallet_has_transactions_relationship" file="C:\PreIPO\backend\tests\Unit\WalletTest.php" line="60" class="Tests\Unit\WalletTest" classname="Tests.Unit.WalletTest" assertions="2" time="0.131249"/>
        <testcase name="test_wallet_deposit_increases_balance" file="C:\PreIPO\backend\tests\Unit\WalletTest.php" line="82" class="Tests\Unit\WalletTest" classname="Tests.Unit.WalletTest" assertions="2" time="0.074402"/>
        <testcase name="test_wallet_belongs_to_user" file="C:\PreIPO\backend\tests\Unit\WalletTest.php" line="53" class="Tests\Unit\WalletTest" classname="Tests.Unit.WalletTest" assertions="2" time="0.069280"/>
        <testcase name="test_wallet_withdraw_decreases_balance" file="C:\PreIPO\backend\tests\Unit\WalletTest.php" line="93" class="Tests\Unit\WalletTest" classname="Tests.Unit.WalletTest" assertions="2" time="0.102355"/>
        <testcase name="test_wallet_balance_paise_stores_integer" file="C:\PreIPO\backend\tests\Unit\WalletTest.php" line="71" class="Tests\Unit\WalletTest" classname="Tests.Unit.WalletTest" assertions="2" time="0.091184"/>
        <testcase name="test_wallet_calculates_available_balance" file="C:\PreIPO\backend\tests\Unit\WalletTest.php" line="154" class="Tests\Unit\WalletTest" classname="Tests.Unit.WalletTest" assertions="1" time="0.083454"/>
        <testcase name="test_wallet_tracks_total_deposited" file="C:\PreIPO\backend\tests\Unit\WalletTest.php" line="130" class="Tests\Unit\WalletTest" classname="Tests.Unit.WalletTest" assertions="1" time="0.089464"/>
        <testcase name="test_wallet_withdraw_validates_sufficient_balance" file="C:\PreIPO\backend\tests\Unit\WalletTest.php" line="109" class="Tests\Unit\WalletTest" classname="Tests.Unit.WalletTest" assertions="1" time="0.113476"/>
        <testcase name="test_wallet_balance_paise_never_negative" file="C:\PreIPO\backend\tests\Unit\WalletTest.php" line="117" class="Tests\Unit\WalletTest" classname="Tests.Unit.WalletTest" assertions="1" time="0.068473"/>
        <testcase name="test_wallet_tracks_total_withdrawn" file="C:\PreIPO\backend\tests\Unit\WalletTest.php" line="142" class="Tests\Unit\WalletTest" classname="Tests.Unit.WalletTest" assertions="1" time="0.081589"/>
      </testsuite>
      <testsuite name="Tests\Unit\RazorpayServiceTest" file="C:\PreIPO\backend\tests\Unit\RazorpayServiceTest.php" tests="15" assertions="7" errors="6" failures="2" skipped="0" time="1.220034">
        <testcase name="test_create_order_sets_correct_amount" file="C:\PreIPO\backend\tests\Unit\RazorpayServiceTest.php" line="58" class="Tests\Unit\RazorpayServiceTest" classname="Tests.Unit.RazorpayServiceTest" assertions="0" time="0.106121">
          <error type="InvalidArgumentException">Tests\Unit\RazorpayServiceTest::test_create_order_sets_correct_amount&#13;
InvalidArgumentException: Payment amount must be between 500 and 1000000.
&#13;
C:\PreIPO\backend\app\Services\RazorpayService.php:249
C:\PreIPO\backend\app\Services\RazorpayService.php:51
C:\PreIPO\backend\tests\Unit\RazorpayServiceTest.php:71</error>
        </testcase>
        <testcase name="test_service_logs_all_api_calls" file="C:\PreIPO\backend\tests\Unit\RazorpayServiceTest.php" line="261" class="Tests\Unit\RazorpayServiceTest" classname="Tests.Unit.RazorpayServiceTest" assertions="0" time="0.072071">
          <error type="InvalidArgumentException">Tests\Unit\RazorpayServiceTest::test_service_logs_all_api_calls&#13;
InvalidArgumentException: Payment amount must be between 500 and 1000000.
&#13;
C:\PreIPO\backend\app\Services\RazorpayService.php:249
C:\PreIPO\backend\app\Services\RazorpayService.php:51
C:\PreIPO\backend\tests\Unit\RazorpayServiceTest.php:274</error>
        </testcase>
        <testcase name="test_verify_signature_validates_correct_signature" file="C:\PreIPO\backend\tests\Unit\RazorpayServiceTest.php" line="119" class="Tests\Unit\RazorpayServiceTest" classname="Tests.Unit.RazorpayServiceTest" assertions="1" time="0.075179"/>
        <testcase name="test_webhook_signature_validates_correctly" file="C:\PreIPO\backend\tests\Unit\RazorpayServiceTest.php" line="236" class="Tests\Unit\RazorpayServiceTest" classname="Tests.Unit.RazorpayServiceTest" assertions="1" time="0.099975"/>
        <testcase name="test_create_order_sets_currency_inr" file="C:\PreIPO\backend\tests\Unit\RazorpayServiceTest.php" line="75" class="Tests\Unit\RazorpayServiceTest" classname="Tests.Unit.RazorpayServiceTest" assertions="0" time="0.060559">
          <error type="InvalidArgumentException">Tests\Unit\RazorpayServiceTest::test_create_order_sets_currency_inr&#13;
InvalidArgumentException: Payment amount must be between 500 and 1000000.
&#13;
C:\PreIPO\backend\app\Services\RazorpayService.php:249
C:\PreIPO\backend\app\Services\RazorpayService.php:51
C:\PreIPO\backend\tests\Unit\RazorpayServiceTest.php:85</error>
        </testcase>
        <testcase name="test_create_order_handles_api_failure" file="C:\PreIPO\backend\tests\Unit\RazorpayServiceTest.php" line="103" class="Tests\Unit\RazorpayServiceTest" classname="Tests.Unit.RazorpayServiceTest" assertions="2" time="0.059189">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\RazorpayServiceTest::test_create_order_handles_api_failure&#13;
Failed asserting that exception message 'Payment amount must be between 500 and 1000000.' contains 'Network Error'.</failure>
        </testcase>
        <testcase name="test_service_uses_correct_environment_keys" file="C:\PreIPO\backend\tests\Unit\RazorpayServiceTest.php" line="251" class="Tests\Unit\RazorpayServiceTest" classname="Tests.Unit.RazorpayServiceTest" assertions="1" time="0.092535"/>
        <testcase name="test_create_order_calls_razorpay_api" file="C:\PreIPO\backend\tests\Unit\RazorpayServiceTest.php" line="39" class="Tests\Unit\RazorpayServiceTest" classname="Tests.Unit.RazorpayServiceTest" assertions="0" time="0.082741">
          <error type="InvalidArgumentException">Tests\Unit\RazorpayServiceTest::test_create_order_calls_razorpay_api&#13;
InvalidArgumentException: Payment amount must be between 500 and 1000000.
&#13;
C:\PreIPO\backend\app\Services\RazorpayService.php:249
C:\PreIPO\backend\app\Services\RazorpayService.php:51
C:\PreIPO\backend\tests\Unit\RazorpayServiceTest.php:52</error>
        </testcase>
        <testcase name="test_verify_signature_rejects_invalid_signature" file="C:\PreIPO\backend\tests\Unit\RazorpayServiceTest.php" line="134" class="Tests\Unit\RazorpayServiceTest" classname="Tests.Unit.RazorpayServiceTest" assertions="0" time="0.086199">
          <error type="Exception">Tests\Unit\RazorpayServiceTest::test_verify_signature_rejects_invalid_signature&#13;
Exception: Invalid Signature
&#13;
C:\PreIPO\backend\tests\Unit\RazorpayServiceTest.php:139</error>
        </testcase>
        <testcase name="test_capture_payment_validates_amount" file="C:\PreIPO\backend\tests\Unit\RazorpayServiceTest.php" line="171" class="Tests\Unit\RazorpayServiceTest" classname="Tests.Unit.RazorpayServiceTest" assertions="2" time="0.116810">
          <failure type="PHPUnit\Framework\ExpectationFailedException">Tests\Unit\RazorpayServiceTest::test_capture_payment_validates_amount&#13;
Failed asserting that exception message 'Payment amount must be a positive number.' contains 'Amount must be positive'.</failure>
        </testcase>
        <testcase name="test_fetch_payment_details_calls_api" file="C:\PreIPO\backend\tests\Unit\RazorpayServiceTest.php" line="222" class="Tests\Unit\RazorpayServiceTest" classname="Tests.Unit.RazorpayServiceTest" assertions="0" time="0.068875"/>
        <testcase name="test_create_order_includes_receipt" file="C:\PreIPO\backend\tests\Unit\RazorpayServiceTest.php" line="89" class="Tests\Unit\RazorpayServiceTest" classname="Tests.Unit.RazorpayServiceTest" assertions="0" time="0.061244">
          <error type="InvalidArgumentException">Tests\Unit\RazorpayServiceTest::test_create_order_includes_receipt&#13;
InvalidArgumentException: Payment amount must be between 500 and 1000000.
&#13;
C:\PreIPO\backend\app\Services\RazorpayService.php:249
C:\PreIPO\backend\app\Services\RazorpayService.php:51
C:\PreIPO\backend\tests\Unit\RazorpayServiceTest.php:99</error>
        </testcase>
        <testcase name="test_capture_payment_calls_razorpay_api" file="C:\PreIPO\backend\tests\Unit\RazorpayServiceTest.php" line="148" class="Tests\Unit\RazorpayServiceTest" classname="Tests.Unit.RazorpayServiceTest" assertions="0" time="0.099115"/>
        <testcase name="test_refund_payment_calls_razorpay_api" file="C:\PreIPO\backend\tests\Unit\RazorpayServiceTest.php" line="180" class="Tests\Unit\RazorpayServiceTest" classname="Tests.Unit.RazorpayServiceTest" assertions="0" time="0.062471"/>
        <testcase name="test_refund_payment_handles_partial_refund" file="C:\PreIPO\backend\tests\Unit\RazorpayServiceTest.php" line="201" class="Tests\Unit\RazorpayServiceTest" classname="Tests.Unit.RazorpayServiceTest" assertions="0" time="0.076950"/>
      </testsuite>
    </testsuite>
  </testsuite>
</testsuites>
