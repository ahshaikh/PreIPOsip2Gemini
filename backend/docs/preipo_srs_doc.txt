# Software Requirements Specification (SRS)
## PreIPO SIP Platform

**Version:** 1.0  
**Date:** November 4, 2024  
**Project:** India's First Zero-Fee Pre-IPO SIP Investment Platform  
**Document Owner:** Technical Team

---

## 1. INTRODUCTION

### 1.1 Purpose
This SRS document specifies the complete functional and non-functional requirements for the PreIPO SIP Platform - a web-based investment platform allowing users to systematically invest in pre-IPO companies through monthly SIPs with zero platform fees and multiple bonus structures.

### 1.2 Scope
The system encompasses:
- User registration, authentication, and KYC verification
- Investment plan management and subscription handling
- Payment processing and transaction management
- Multi-tier bonus calculation engine (7 bonus types)
- Portfolio tracking and pre-IPO allocation
- Withdrawal processing and wallet management
- Lucky draw system and profit sharing
- Referral management with multipliers
- Admin dashboard and reporting
- Support ticket system
- Automated notifications (Email/SMS/Push)

### 1.3 Definitions and Acronyms
- **SIP**: Systematic Investment Plan
- **KYC**: Know Your Customer
- **BV**: Business Volume (face value of shares allocated)
- **Demat**: Dematerialized account for holding shares
- **UTR**: Unique Transaction Reference
- **DP**: Depository Participant
- **SEBI**: Securities and Exchange Board of India
- **Pre-IPO**: Pre-Initial Public Offering (before company lists)

### 1.4 System Overview
The platform enables retail investors to:
1. Register and complete KYC verification
2. Subscribe to monthly SIP plans (₹1K-25K/month)
3. Receive pre-IPO share allocations
4. Earn 7 different types of bonuses (total 5.75% guaranteed)
5. Track portfolio performance
6. Withdraw earnings
7. Participate in lucky draws and profit sharing
8. Refer friends for bonus multipliers

---

## 2. OVERALL DESCRIPTION

### 2.1 Product Perspective
**Architecture:** Monolithic Laravel 11 application with:
- Frontend: React.js/Blade templates with Tailwind CSS
- Backend: PHP 8.3 + Laravel 11
- Database: MySQL 8.0
- Cache: Redis
- Queue: Laravel Queue with Redis driver
- Payment Gateway: Razorpay/PayU
- File Storage: AWS S3 or local storage
- Email: SendGrid/SMTP
- SMS: MSG91

**Deployment:** Single server initially, scalable to multi-server architecture

### 2.2 Product Functions
**Core Modules:**
1. **User Management:** Registration, authentication, profile management
2. **KYC System:** Document upload, verification workflow, compliance
3. **Plan & Subscription:** 4 investment plans, subscription lifecycle
4. **Payment Processing:** Gateway integration, auto-debit, manual payments
5. **Bonus Engine:** 7-layer bonus calculation and distribution
6. **Portfolio Management:** Investment tracking, allocation, performance
7. **Wallet System:** Balance management, transactions, ledger
8. **Withdrawal Processing:** Request, approval, bank transfer workflow
9. **Referral System:** Code generation, tracking, multiplier calculation
10. **Lucky Draw:** Monthly draw execution, winner selection
11. **Profit Sharing:** Quarterly calculation and distribution
12. **Admin Dashboard:** Comprehensive management interface
13. **Reporting:** Financial, compliance, and analytics reports
14. **Support System:** Ticket management, chat support

### 2.3 User Classes and Characteristics

**User Types:**

1. **End Users (Investors)**
   - Age: 18-65 years
   - Technical literacy: Basic to intermediate
   - Primary actions: Invest, track portfolio, earn bonuses
   - Access: Web + Mobile

2. **Admin Users**
   - Roles: Super Admin, Admin, Support, Finance
   - Technical literacy: Intermediate to advanced
   - Primary actions: Manage users, approve KYC, process withdrawals
   - Access: Web only (admin panel)

3. **System Administrators**
   - Technical literacy: Advanced
   - Primary actions: System configuration, maintenance, monitoring
   - Access: Server access + admin panel

### 2.4 Operating Environment
**Client-side:**
- Browsers: Chrome 90+, Firefox 88+, Safari 14+, Edge 90+
- Devices: Desktop, Tablet, Mobile (responsive design)
- Operating Systems: Windows, macOS, Linux, Android, iOS

**Server-side:**
- OS: Ubuntu 20.04 LTS or higher
- Web Server: Nginx 1.18+ or Apache 2.4+
- PHP: 8.3+
- MySQL: 8.0+
- Redis: 6.0+
- Node.js: 18+ (for asset compilation)

### 2.5 Design and Implementation Constraints
1. **Regulatory Compliance:**
   - SEBI regulations for investment platforms
   - PMLA (Prevention of Money Laundering Act) compliance
   - RBI guidelines for payment processing
   - Data Protection Act compliance

2. **Technical Constraints:**
   - Must support 10,000 concurrent users
   - Page load time < 2 seconds
   - 99.9% uptime requirement
   - Database transaction ACID compliance
   - Secure file storage for KYC documents (7-year retention)

3. **Business Constraints:**
   - Zero platform fees (revenue from share margins only)
   - Bonus budget: 5.75% of investment value
   - Exit fee: Maximum 1%
   - Minimum investment: ₹1,000/month

### 2.6 Assumptions and Dependencies
**Assumptions:**
1. Users have valid Aadhaar, PAN, Demat, and Bank accounts
2. Internet connectivity for all transactions
3. Pre-IPO share availability from suppliers
4. Payment gateway services remain available
5. SMS/Email delivery services operational

**Dependencies:**
1. Razorpay/PayU payment gateway APIs
2. DigiLocker API for Aadhaar verification
3. Income Tax API for PAN verification
4. MSG91 API for SMS delivery
5. SendGrid API for email delivery
6. AWS S3 for file storage (optional)
7. Bank APIs for account verification (penny drop)

---

## 3. SPECIFIC REQUIREMENTS

### 3.1 Functional Requirements

#### 3.1.1 User Registration and Authentication

**FR-AUTH-001: User Registration**
- **Description:** New users can create accounts
- **Priority:** CRITICAL
- **Input:** Username, email, mobile, password, referral code (optional)
- **Process:**
  1. Validate all inputs (format, uniqueness)
  2. Hash password using bcrypt
  3. Generate unique referral code for user
  4. Create user record with status='pending'
  5. Send email OTP (6 digits, 10-minute expiry)
  6. Send SMS OTP (6 digits, 10-minute expiry)
  7. Create wallet with ₹0 balance
  8. Create empty profile record
- **Output:** User ID, success message
- **Validation Rules:**
  - Username: 3-50 chars, alphanumeric + underscore
  - Email: Valid RFC 5322 format
  - Mobile: Exactly 10 digits
  - Password: Min 8 chars, 1 uppercase, 1 lowercase, 1 number
  - Referral code: If provided, must exist in system

**FR-AUTH-002: Email Verification**
- **Description:** Verify user email with OTP
- **Priority:** CRITICAL
- **Input:** User ID, OTP code
- **Process:**
  1. Retrieve cached OTP for user
  2. Compare with submitted OTP
  3. If match: Set email_verified_at = NOW()
  4. Clear OTP from cache
- **Output:** Success/failure message
- **Business Rules:**
  - OTP valid for 10 minutes only
  - Maximum 3 attempts allowed
  - Can resend OTP after 1 minute

**FR-AUTH-003: Mobile Verification**
- **Description:** Verify user mobile with OTP
- **Priority:** CRITICAL
- **Input:** User ID, OTP code
- **Process:**
  1. Retrieve cached OTP for user
  2. Compare with submitted OTP
  3. If match: Set mobile_verified_at = NOW(), status='active'
  4. Clear OTP from cache
- **Output:** Success/failure message
- **Business Rules:**
  - OTP valid for 10 minutes only
  - Maximum 3 attempts allowed
  - User activated only after mobile verification

**FR-AUTH-004: User Login**
- **Description:** Authenticate registered users
- **Priority:** CRITICAL
- **Input:** Login (email/username/mobile), password
- **Process:**
  1. Find user by login credential
  2. Verify password hash
  3. Check account status (active/suspended/blocked)
  4. Generate JWT token (30-day expiry)
  5. Log login activity (IP, device, browser)
  6. Update last_login_at timestamp
- **Output:** JWT token, user data
- **Security:**
  - Rate limiting: 5 attempts per 15 minutes
  - Auto-block after 10 failed attempts in 1 hour
  - Log all failed attempts

**FR-AUTH-005: Two-Factor Authentication (2FA)**
- **Description:** Optional 2FA for enhanced security
- **Priority:** MEDIUM
- **Input:** User credentials + 2FA code
- **Process:**
  1. After password verification, send 2FA code via SMS
  2. User enters 6-digit code
  3. Validate code (5-minute expiry)
  4. Generate token only after 2FA success
- **Output:** JWT token

**FR-AUTH-006: Password Reset**
- **Description:** Allow users to reset forgotten passwords
- **Priority:** HIGH
- **Input:** Email address
- **Process:**
  1. Verify email exists
  2. Generate unique reset token
  3. Send email with reset link (1-hour expiry)
  4. User clicks link, enters new password
  5. Hash and update password
  6. Invalidate reset token
- **Output:** Success message

**FR-AUTH-007: Logout**
- **Description:** Terminate user session
- **Priority:** HIGH
- **Input:** JWT token
- **Process:**
  1. Revoke token from database
  2. Log logout time
  3. Clear session data
- **Output:** Success message

---

#### 3.1.2 KYC Management

**FR-KYC-001: KYC Document Submission**
- **Description:** Users upload KYC documents
- **Priority:** CRITICAL
- **Input:** 
  - Aadhaar: Number (12 digits), front image, back image
  - PAN: Number (10 chars), card image
  - Demat: Account number, DP ID, statement/certificate
  - Bank: Account number, IFSC, proof (cheque/statement)
- **Process:**
  1. Validate all input formats
  2. Upload images to secure storage (encrypt at rest)
  3. Store file paths in database
  4. Set KYC status = 'submitted'
  5. Notify admin team
- **Output:** Success message
- **File Validation:**
  - Allowed formats: JPG, PNG, PDF
  - Max size: 5MB per file
  - Minimum resolution: 800x600 pixels
  - PDF max pages: 10

**FR-KYC-002: Aadhaar Auto-Verification**
- **Description:** Verify Aadhaar using DigiLocker API
- **Priority:** MEDIUM
- **Input:** Aadhaar number
- **Process:**
  1. Call DigiLocker API with Aadhaar number
  2. Receive verification result
  3. Extract: Name, DOB, Address, Gender
  4. Compare with user-provided data
  5. Set aadhaar_verified = true if match
- **Output:** Verification status

**FR-KYC-003: PAN Auto-Verification**
- **Description:** Verify PAN using Income Tax API
- **Priority:** MEDIUM
- **Input:** PAN number, Name
- **Process:**
  1. Call Income Tax verification API
  2. Check PAN validity and active status
  3. Compare name (fuzzy match 80%+)
  4. Set pan_verified = true if valid
- **Output:** Verification status

**FR-KYC-004: Bank Account Verification (Penny Drop)**
- **Description:** Verify bank account using penny drop
- **Priority:** MEDIUM
- **Input:** Account number, IFSC code
- **Process:**
  1. Call Razorpay/PayU verification API
  2. Initiate ₹1 transfer
  3. Verify account active and name matches
  4. Set bank_verified = true if success
- **Output:** Verification status

**FR-KYC-005: Admin KYC Review**
- **Description:** Admin manually reviews KYC documents
- **Priority:** CRITICAL
- **Input:** User ID, Admin decision
- **Process:**
  1. Admin views all uploaded documents
  2. Checks image quality, authenticity
  3. Verifies name consistency across documents
  4. Verifies DOB consistency
  5. Decision: Approve or Reject with reason
  6. If approved: Set status='verified', verified_at=NOW()
  7. If rejected: Set status='rejected', send reason to user
- **Output:** KYC status update
- **Target SLA:** 24 hours from submission

**FR-KYC-006: KYC Re-submission**
- **Description:** Users re-submit rejected KYC
- **Priority:** HIGH
- **Input:** Corrected documents
- **Process:**
  1. Replace old documents with new uploads
  2. Set status='submitted'
  3. Add to admin review queue
- **Output:** Success message

---

#### 3.1.3 Investment Plans and Subscriptions

**FR-PLAN-001: View Available Plans**
- **Description:** Display all active investment plans
- **Priority:** CRITICAL
- **Input:** None (or filter parameters)
- **Output:** List of plans with details:
  - Plan name, slug, description
  - Monthly amount, duration
  - Bonus structure (progressive %, milestones)
  - Profit sharing %
  - Features list
  - Total projected value
- **Business Rules:**
  - Only show plans where is_active = true
  - Sort by display_order

**FR-PLAN-002: Calculate Plan Returns**
- **Description:** Calculate projected returns for a plan
- **Priority:** HIGH
- **Input:** Plan ID, Referral count (optional)
- **Process:**
  1. Get plan details
  2. Calculate total investment (monthly × duration)
  3. Calculate progressive bonuses (sum of monthly bonuses)
  4. Calculate milestone bonuses (sum of 12m, 24m, 36m)
  5. Calculate consistency bonuses
  6. Estimate profit sharing
  7. Apply referral multiplier if applicable
  8. Calculate total value
- **Output:** JSON with breakdown:
  ```json
  {
    "total_investment": 180000,
    "progressive_bonuses": 4950,
    "milestone_bonuses": 3000,
    "consistency_bonuses": 600,
    "profit_sharing_estimate": 900,
    "referral_multiplier": 2.0,
    "total_bonuses": 10350,
    "total_value": 190350,
    "bonus_percentage": 5.75,
    "breakdown_by_year": {...}
  }
  ```

**FR-PLAN-003: Create Subscription**
- **Description:** User subscribes to a plan
- **Priority:** CRITICAL
- **Input:** Plan ID
- **Pre-conditions:**
  - User KYC verified
  - User has no active subscription
- **Process:**
  1. Validate user can subscribe
  2. Generate unique subscription_code
  3. Calculate start_date (today) and end_date (36 months later)
  4. Set next_payment_date (5 days from start)
  5. Create subscription record with status='active'
  6. Create first payment record with status='pending'
  7. Send confirmation email
- **Output:** Subscription details
- **Business Rules:**
  - One active subscription per user
  - Subscription auto-starts immediately
  - First payment due within 5 days

**FR-PLAN-004: Change Subscription Plan**
- **Description:** User upgrades/downgrades plan mid-cycle
- **Priority:** MEDIUM
- **Input:** Subscription ID, New Plan ID
- **Process:**
  1. Calculate pro-rata adjustment
  2. If upgrading: Credit difference to next payment
  3. If downgrading: Effective from next payment cycle
  4. Update subscription.plan_id
  5. Recalculate bonus structure
  6. Preserve referral multiplier and payment streak
  7. Send confirmation with new payment schedule
- **Output:** Updated subscription
- **Business Rules:**
  - Can change plan once per month
  - Downgrade: No refund for current month
  - Upgrade: Pro-rata credit applied

**FR-PLAN-005: Pause Subscription**
- **Description:** User temporarily pauses SIP
- **Priority:** MEDIUM
- **Input:** Subscription ID, Pause duration (1-3 months)
- **Process:**
  1. Validate pause duration within limits
  2. Set subscription.status = 'paused'
  3. Store pause_start_date and pause_end_date
  4. Stop auto-debit
  5. Reset consecutive_payments counter
  6. Extend end_date by pause duration
  7. Send confirmation
- **Output:** Success message
- **Business Rules:**
  - Maximum 3-month pause
  - Can pause once per year
  - No bonuses during pause
  - Streak resets

**FR-PLAN-006: Cancel Subscription**
- **Description:** User or admin cancels subscription
- **Priority:** HIGH
- **Input:** Subscription ID, Cancellation reason
- **Process:**
  1. Set subscription.status = 'cancelled'
  2. Store cancelled_at timestamp and reason
  3. Stop future payments
  4. Keep existing portfolio intact
  5. Forfeit future milestone bonuses
  6. Allow withdrawal of invested amount
  7. Send confirmation with settlement details
- **Output:** Cancellation confirmation
- **Business Rules:**
  - Portfolio remains (shares allocated)
  - Exit fee 1% applied on withdrawal
  - Cannot rejoin for 90 days (fraud prevention)

---

#### 3.1.4 Payment Processing

**FR-PAY-001: Initiate SIP Payment**
- **Description:** Process monthly SIP payment
- **Priority:** CRITICAL
- **Input:** Subscription ID, Payment method
- **Process:**
  1. Get subscription and plan details
  2. Calculate current month number
  3. Create payment record with status='pending'
  4. Calculate amount = plan.monthly_amount
  5. Generate Razorpay/PayU order ID
  6. Return payment gateway details
- **Output:** Gateway order details (order_id, amount, key)
- **Business Rules:**
  - Payment due on same date each month
  - 5-day grace period before marking overdue
  - Auto-debit attempts on due date

**FR-PAY-002: Process Payment Success**
- **Description:** Handle successful payment callback
- **Priority:** CRITICAL
- **Input:** Gateway response (payment_id, order_id, signature)
- **Process:**
  1. Verify payment signature
  2. Update payment record: status='paid', paid_date=NOW()
  3. Trigger bonus calculation (FR-BONUS-001)
  4. Update subscription progress
  5. Increment total_payments_made, consecutive_payments
  6. Create transaction record
  7. Update wallet if applicable
  8. Allocate pre-IPO shares (FR-PORT-001)
  9. Send payment confirmation email/SMS
- **Output:** Success response
- **Business Rules:**
  - Idempotent operation (handle duplicates)
  - Transaction must be atomic

**FR-PAY-003: Process Payment Failure**
- **Description:** Handle failed payment
- **Priority:** HIGH
- **Input:** Gateway failure response
- **Process:**
  1. Update payment record: status='failed'
  2. Store failure reason
  3. Send payment failure notification
  4. Schedule retry (2 retries over 3 days)
  5. If all retries fail: Mark payment as 'overdue'
  6. Send overdue notice
- **Output:** Failure notification
- **Business Rules:**
  - Auto-retry after 24 hours (2 times)
  - After 3 failures: Manual intervention required

**FR-PAY-004: Manual Payment Processing**
- **Description:** Admin manually marks payment as paid
- **Priority:** HIGH
- **Input:** Payment ID, Transaction details, Proof
- **Pre-conditions:**
  - Admin verified payment received
  - Payment proof uploaded
- **Process:**
  1. Admin uploads payment proof
  2. Admin enters transaction ID/UTR
  3. Update payment: status='paid', paid_date=NOW()
  4. Trigger same flow as FR-PAY-002
  5. Mark as 'manually_processed'
  6. Log admin action in audit trail
- **Output:** Success message
- **Business Rules:**
  - Requires payment proof (mandatory)
  - Only admin role can execute

**FR-PAY-005: Auto-Debit Setup**
- **Description:** Setup recurring payments
- **Priority:** MEDIUM
- **Input:** Subscription ID, Bank details
- **Process:**
  1. Register mandate with payment gateway
  2. User authorizes mandate
  3. Store mandate ID in subscription
  4. Auto-execute on due dates
- **Output:** Mandate setup confirmation
- **Business Rules:**
  - Optional feature
  - Can be cancelled anytime

---

#### 3.1.5 Bonus Calculation Engine

**FR-BONUS-001: Calculate Progressive Monthly Bonus**
- **Description:** Calculate and award progressive monthly bonus
- **Priority:** CRITICAL
- **Input:** Subscription ID, Month number
- **Formula:**
  ```
  bonus_amount = base_amount × (month - 3) × progressive_rate × multiplier
  bonus_percentage = (month - 3) × progressive_rate × multiplier
  ```
- **Process:**
  1. If month < 4: Return bonus = 0
  2. Calculate months_since_start = month - 3
  3. Get plan.progressive_bonus_percentage (0.5%-0.6%)
  4. Get subscription.bonus_multiplier (from referrals)
  5. Calculate bonus_percentage and bonus_amount
  6. Create BonusTransaction record
  7. Update subscription.total_bonus_received
- **Output:** Bonus transaction details
- **Business Rules:**
  - No bonus for first 3 months
  - Bonus grows linearly each month
  - Multiplier from referrals applies

**FR-BONUS-002: Award Milestone Bonus**
- **Description:** Award bonus at 12, 24, 36 months
- **Priority:** HIGH
- **Input:** Subscription ID, Month number
- **Pre-conditions:**
  - Month must be exactly 12, 24, or 36
  - User must have consecutive payments
- **Process:**
  1. Check if month is milestone (12/24/36)
  2. Verify consecutive_payments >= month
  3. Get milestone amount from plan
  4. Apply referral multiplier
  5. Create BonusTransaction with type='milestone_Xm'
  6. Update subscription bonuses
  7. Send milestone achievement notification
- **Output:** Milestone bonus details
- **Business Rules:**
  - Requires consecutive payments (no gaps)
  - One-time bonus per milestone
  - Multiplier applies

**FR-BONUS-003: Award Consistency Bonus**
- **Description:** Award bonus for on-time payments
- **Priority:** MEDIUM
- **Input:** Payment ID, Is on-time flag
- **Process:**
  1. If payment not on-time: Return 0
  2. Get consistency amount based on plan
  3. Check for streak bonuses (6, 12 months)
  4. Calculate total consistency bonus
  5. Create BonusTransaction
- **Output:** Consistency bonus amount
- **Amounts:**
  - Plan A: ₹7/month
  - Plan B: ₹35/month
  - Plan C: ₹70/month
  - Plan D: ₹175/month
  - Streak bonus: 3x at 6 months, 5x at 12 months

**FR-BONUS-004: Calculate Referral Multiplier**
- **Description:** Update bonus multiplier based on referrals
- **Priority:** HIGH
- **Input:** User ID
- **Process:**
  1. Count active referrals (status='completed' and invested in current month also)
  2. Determine tier:
     - 0-2 referrals: 1.0x
     - 3-4 referrals: 1.5x
     - 5-9 referrals: 2.0x
     - 10-19 referrals: 2.5x
     - 20+ referrals: 3.0x
  3. Update subscription.bonus_multiplier
  4. Send tier achievement notification
- **Output:** New multiplier value
- **Business Rules:**
  - Applies to ALL future bonuses
  - Retroactive to current month
  - Only completed referrals count
  - Should have invested in the current month too

**FR-BONUS-005: Award Referral Bonus**
- **Description:** One-time bonus for referring someone
- **Priority:** MEDIUM
- **Input:** Referrer ID, Referred user ID
- **Process:**
  1. Verify referred user completed first investment
  2. Award ₹500 bonus to referrer
  3. Create BonusTransaction type='referral'
  4. Update Referral record: status='completed'
  5. Mark referral as contributing to multiplier
  6. Recalculate multiplier (FR-BONUS-004)
- **Output:** Referral bonus details
- **Business Rules:**
  - ₹500 per successful referral
  - Paid only after referee invests
  - Referee must stay active for 3 months

**FR-BONUS-006: Calculate Quarterly Profit Share**
- **Description:** Distribute profit share quarterly
- **Priority:** HIGH
- **Input:** Quarter (YYYY-QX), Financial data
- **Process:**
  1. Calculate net profit for quarter
  2. For each active subscription:
     - Get plan.profit_share_percentage (5-20%)
     - Calculate user investment ratio
     - Calculate share amount
  3. Create UserProfitShare records
  4. Create BonusTransaction for each user
  5. Send profit share notifications
- **Output:** Profit distribution summary
- **Business Rules:**
  - Distributed quarterly (Jan, Apr, Jul, Oct)
  - Only active subscriptions eligible
  - Amount varies by plan (5-20%)

**FR-BONUS-007: Award Celebration Bonus**
- **Description:** Birthday/Anniversary bonuses
- **Priority:** LOW
- **Input:** User ID, Event type
- **Process:**
  1. Check if event date matches
  2. Get celebration amount from plan
  3. Create BonusTransaction type='birthday/anniversary'
  4. Send celebration greeting
- **Output:** Celebration bonus
- **Amounts:**
  - Plan A: ₹5-7
  - Plan B: ₹30-40
  - Plan C: ₹50-70
  - Plan D: ₹100-150

---

#### 3.1.6 Portfolio Management

**FR-PORT-001: Allocate Pre-IPO Shares**
- **Description:** Allocate shares to user after payment
- **Priority:** CRITICAL
- **Input:** Payment ID
- **Process:**
  1. Get payment amount + bonuses
  2. Get available bulk purchase pool
  3. Proportionally allocate from available products
  4. Calculate units based on face value
  5. Create UserInvestment records
  6. Update bulk_purchase remaining pool
  7. Update product.total_allocated_value
  8. Mark payment.products_allocated = true
- **Output:** Investment allocations
- **Business Rules:**
  - Allocate within 24 hours of payment
  - Diversify across 2-3 products if amount > ₹10K
  - Track allocation source (bulk purchase ID)

**FR-PORT-002: View User Portfolio**
- **Description:** Display user's investment portfolio
- **Priority:** HIGH
- **Input:** User ID
- **Output:**
  ```json
  {
    "summary": {
      "total_invested": 60000,
      "current_value": 79200,
      "total_bonuses": 7847,
      "unrealized_gain": 19200,
      "total_return_percentage": 32.00
    },
    "holdings": [
      {
        "product": {"id": 1, "name": "Swiggy", "sector": "Food Tech"},
        "units": 45,
        "face_value_allocated": 22500,
        "current_market_value": 33750,
        "gain": 11250,
        "gain_percentage": 50.00
      }
    ]
  }
  ```
- **Business Rules:**
  - Real-time current value (if market data available)
  - Otherwise, show face value allocated

**FR-PORT-003: Update Product Market Value**
- **Description:** Update current market prices
- **Priority:** MEDIUM
- **Input:** Product ID, New market price
- **Process:**
  1. Update product.current_market_price
  2. Recalculate all UserInvestment.current_market_value
  3. Update portfolio summaries
- **Output:** Success message
- **Frequency:** Daily or on-demand

**FR-PORT-004: Process Share Exit (Sell)**
- **Description:** User sells shares after IPO
- **Priority:** HIGH
- **Input:** Investment ID, Exit price
- **Process:**
  1. Calculate exit_value = units × exit_price
  2. Calculate realized_gain = exit_value - face_value
  3. Calculate exit fee (0-3%)
  4. Credit net amount to wallet
  5. Update investment: status='sold', exit_date, exit_price
  6. Create transaction record
  7. Generate tax statement
- **Output:** Exit summary
- **Business Rules:**
  - 0-3% exit fee applied
  - Tax implications calculated
  - Funds credited to wallet

---

#### 3.1.7 Wallet and Transactions

**FR-WALLET-001: Wallet Balance Management**
- **Description:** Manage user wallet balance
- **Priority:** CRITICAL
- **Fields:**
  - balance: Available balance
  - locked_balance: Funds in process
  - total_deposited: Lifetime deposits
  - total_withdrawn: Lifetime withdrawals
  - total_invested: Total in subscriptions
  - total_bonus_received: All bonuses
- **Business Rules:**
  - Balance cannot go negative
  - All transactions must update wallet
  - Atomic operations (transactions)

**FR-WALLET-002: Create Transaction**
- **Description:** Record financial transaction
- **Priority:** CRITICAL
- **Input:** User ID, Type, Amount, Description
- **Types:**
  - deposit, withdrawal, investment
  - bonus_credit, profit_share
  - refund, transfer_in, transfer_out, fee, adjustment
- **Process:**
  1. Begin database transaction
  2. Lock wallet for update
  3. Calculate balance_before and balance_after
  4. Create Transaction record
  5. Update Wallet balance
  6. Create LedgerEntry (double-entry)
  7. Commit transaction
- **Output:** Transaction record
- **Business Rules:**
  - Must be atomic (DB transaction)
  - Balance changes only via transactions
  - Immutable after creation

**FR-WALLET-003: Deposit Funds**
- **Description:** User adds money to wallet
- **Priority:** HIGH
- **Input:** User ID, Amount, Payment method
- **Process:**
  1. Create Deposit record (status='pending')
  2. Initiate payment gateway
  3. On success:
     - Update status='completed'
     - Create transaction type='deposit'
     - Credit wallet
  4. On failure:
     - Update status='failed'
     - Notify user
- **Output:** Deposit confirmation
- **Business Rules:**
  - Minimum deposit: ₹500
  - Maximum deposit: ₹1,00,000 per transaction

---

#### 3.1.8 Withdrawal Processing

**FR-WITHDRAW-001: Request Withdrawal**
- **Description:** User requests to withdraw funds
- **Priority:** CRITICAL
- **Input:** User ID, Amount, Bank details
- **Pre-conditions:**
  - User KYC verified
  - Wallet balance >= amount
  - Bank account verified
- **Process:**
  1. Validate withdrawal amount (min ₹1,000)
  2. Check available balance
  3. Calculate fee (if any)
  4. Lock balance in wallet
  5. Create Withdrawal record (status='pending')
  6. Generate unique withdrawal_code
  7. Notify admin for approval
  8. Send confirmation to user
- **Output:** Withdrawal request details
- **Business Rules:**
  - Minimum withdrawal: ₹1,000
  - Maximum withdrawal: ₹50,000 per day
  - Fee: ₹0 (currently zero fee policy)
  - Processing time: 24-48 hours

**FR-WITHDRAW-002: Admin Approve Withdrawal**
- **Description:** Admin reviews and approves withdrawal
- **Priority:** CRITICAL
- **Input:** Withdrawal ID, Admin decision
- **Process:**
  1. Admin reviews request
  2. Verifies bank details match KYC
  3. Checks for fraud indicators
  4. If approved:
     - Update status='approved'
     - Initiate bank transfer via API/manual
     - Update approved_by, approved_at
  5. If rejected:
     - Update status='rejected'
     - Unlock wallet balance
     - Store rejection_reason
     - Notify user
- **Output:** Approval/rejection confirmation
- **Business Rules:**
  - Requires admin role
  - Must provide reason if rejected
  - Target SLA: 24 hours

**FR-WITHDRAW-003: Complete Withdrawal**
- **Description:** Mark withdrawal as completed
- **Priority:** HIGH
- **Input:** Withdrawal ID, UTR number
- **Process:**
  1. Verify bank transfer completed
  2. Enter UTR number
  3. Update status='completed', completed_at=NOW()
  4. Release locked balance
  5. Create transaction type='withdrawal'
  6. Update wallet.total_withdrawn
  7. Send completion notification
- **Output:** Completion confirmation
- **Business Rules:**
  - UTR number mandatory
  - Creates audit trail

**FR-WITHDRAW-004: Automated Withdrawal**
- **Description:** System auto-processes small withdrawals
- **Priority:** MEDIUM
- **Input:** Withdrawal ID
- **Pre-conditions:**
  - Amount <= ₹5,000
  - User has history of 5+ successful transactions
  - No fraud flags
- **Process:**
  1. Auto-approve if conditions met
  2. Initiate bank transfer via API
  3. Update status on callback
- **Output:** Auto-processed confirmation
- **Business Rules:**
  - Only for trusted users
  - Maximum ₹5,000 per request

---

#### 3.1.9 Referral System

**FR-REF-001: Generate Referral Code**
- **Description:** Generate unique referral code for user
- **Priority:** HIGH
- **Process:**
  1. On user registration, generate code
  2. Format: USERNAME + 4 random digits
  3. Ensure uniqueness
  4. Store in users.referral_code
- **Output:** Referral code (e.g., RAJESH5678)
- **Business Rules:**
  - Auto-generated
  - Cannot be changed
  - Case-insensitive

**FR-REF-002: Track Referral**
- **Description:** Record when someone uses referral code
- **Priority:** CRITICAL
- **Input:** Referrer code, New user ID
- **Process:**
  1. On registration, if referral code provided
  2. Find referrer by code
  3. Create Referral record:
     - referrer_id, referred_id
     - status='pending'
  4. Store in users.referred_by
- **Output:** Referral tracking record
- **Business Rules:**
  - Recorded at registration only
  - Cannot change referrer later

**FR-REF-003: Complete Referral**
- **Description:** Mark referral as completed
- **Priority:** HIGH
- **Trigger:** Referred user makes first investment
- **Process:**
  1. Check if referred user paid first SIP
  2. If yes:
     - Update Referral.status = 'completed'
     - Set completed_at = NOW()
     - Award ₹500 bonus to referrer (FR-BONUS-005)
     - Recalculate referrer's multiplier (FR-BONUS-004)
     - Send notification to both users
- **Output:** Referral completion confirmation
- **Business Rules:**
  - Requires first payment completion
  - One-time ₹500 bonus
  - Counts toward multiplier

**FR-REF-004: View Referral Statistics**
- **Description:** Show user's referral performance
- **Priority:** MEDIUM
- **Input:** User ID
- **Output:**
  ```json
  {
    "referral_code": "RAJESH5678",
    "total_referrals": 5,
    "active_referrals": 5,
    "pending_referrals": 2,
    "current_multiplier": 2.0,
    "next_tier": {
      "referrals_needed": 5,
      "multiplier": 2.5
    },
    "referrals": [
      {
        "referred_user": "Amit Kumar",
        "status": "completed",
        "referred_at": "2024-09-15",
        "bonus_earned": 500
      }
    ],
    "total_bonus_earned": 2500
  }
  ```

**FR-REF-005: Referral Link Generation**
- **Description:** Generate shareable referral links
- **Priority:** LOW
- **Input:** User ID
- **Output:**
  ```json
  {
    "referral_link": "https://preiposip.com/signup?ref=RAJESH5678",
    "whatsapp_share": "https://wa.me/?text=...",
    "facebook_share": "...",
    "twitter_share": "..."
  }
  ```

---

#### 3.1.10 Lucky Draw System

**FR-LUCKY-001: Create Monthly Draw**
- **Description:** Setup lucky draw for the month
- **Priority:** MEDIUM
- **Input:** Draw month (YYYY-MM)
- **Process:**
  1. Create LuckyDraw record
  2. Generate unique draw_code
  3. Define prize structure:
     - Rank 1: 1 × ₹50,000
     - Rank 2: 4 × ₹10,000
     - Rank 3: 10 × ₹2,000
     - Rank 4: 85 × ₹500
  4. Total prize pool: ₹1,52,500
  5. Total winners: 100
  6. Set status='open'
  7. Announce draw to users
- **Output:** Draw details
- **Business Rules:**
  - One draw per month
  - Opens on 1st, closes on last day
  - Draw executed on last day at 11:59 PM

**FR-LUCKY-002: Generate Draw Entries**
- **Description:** Create entries for eligible users
- **Priority:** HIGH
- **Trigger:** User makes on-time SIP payment
- **Process:**
  1. Check payment is on-time
  2. Get number of entries based on plan:
     - Plan A: 1 entry
     - Plan B: 3 entries
     - Plan C: 5 entries
     - Plan D: 10 entries
  3. For each entry:
     - Generate unique 5-digit code (10000-99999)
     - Create LuckyDrawEntry record
  4. Send entry confirmation
- **Output:** Entry codes
- **Business Rules:**
  - Only on-time payments qualify
  - Multiple entries for premium plans
  - Entries cannot be transferred

**FR-LUCKY-003: Execute Draw**
- **Description:** Run the lucky draw
- **Priority:** CRITICAL
- **Input:** Draw ID
- **Process:**
  1. Get all entries for the draw
  2. Use cryptographically secure random selection
  3. For each prize rank:
     - Select winner(s) randomly
     - Ensure no duplicates
     - Mark entry as winner
     - Record prize_amount and prize_rank
  4. Create BonusTransaction for each winner
  5. Credit prizes to wallets
  6. Set draw.status = 'drawn'
  7. Send winner notifications
  8. Publish results publicly
- **Output:** List of winners
- **Business Rules:**
  - Must be provably random
  - Video recorded for transparency
  - Results published within 1 hour
  - One user cannot win multiple prizes

**FR-LUCKY-004: View Draw Results**
- **Description:** Display draw winners
- **Priority:** MEDIUM
- **Input:** Draw ID
- **Output:**
  ```json
  {
    "draw_code": "DRAW-NOV2024",
    "draw_date": "2024-11-30",
    "status": "completed",
    "total_entries": 8547,
    "total_participants": 3214,
    "winners": [
      {
        "rank": 1,
        "entry_code": "47892",
        "winner": "Raj K. (Mumbai)",
        "prize": 50000
      }
    ]
  }
  ```
- **Business Rules:**
  - Show partial name only (privacy)
  - Show city only
  - Publish within 24 hours

---

#### 3.1.11 Admin Dashboard

**FR-ADMIN-001: Dashboard Metrics**
- **Description:** Display key platform metrics
- **Priority:** HIGH
- **Output:**
  ```json
  {
    "metrics": {
      "total_users": 5247,
      "active_subscriptions": 3891,
      "total_investment": 22400000,
      "kyc_pending": 234,
      "pending_withdrawals": 45,
      "total_bv": 18700000,
      "revenue_this_month": 1800000,
      "net_profit": 1400000,
      "monthly_growth": 12.5
    },
    "charts": {
      "user_growth": [...],
      "revenue_trend": [...],
      "investment_by_plan": {...}
    }
  }
  ```
- **Business Rules:**
  - Real-time data
  - Refresh every 5 minutes
  - Role-based access

**FR-ADMIN-002: User Management**
- **Description:** Manage user accounts
- **Priority:** HIGH
- **Actions:**
  - View all users (paginated, searchable)
  - View user details (profile, KYC, transactions)
  - Edit user profile
  - Suspend/block user
  - Reset password
  - Adjust wallet balance (with reason)
  - View activity logs
- **Business Rules:**
  - Requires admin role
  - All actions logged
  - Cannot delete users (soft delete only)

**FR-ADMIN-003: KYC Verification Queue**
- **Description:** Process KYC submissions
- **Priority:** CRITICAL
- **Features:**
  - List pending KYCs (sorted by submission date)
  - Document viewer (zoom, rotate, download)
  - Verification checklist
  - Approve/Reject with reason
  - Bulk approval (for similar cases)
  - Request additional documents
- **Business Rules:**
  - Target: 24-hour processing
  - Requires verification checklist completion
  - Rejection must have detailed reason

**FR-ADMIN-004: Withdrawal Processing**
- **Description:** Manage withdrawal requests
- **Priority:** CRITICAL
- **Features:**
  - List pending withdrawals
  - Verify bank details match KYC
  - Fraud check indicators
  - Approve/Reject
  - Enter UTR after bank transfer
  - Mark as completed
  - Bulk processing
- **Business Rules:**
  - Target: 24-48 hour processing
  - Requires UTR for completion
  - Bank details must match KYC

**FR-ADMIN-005: Bulk Purchase Management**
- **Description:** Manage pre-IPO inventory
- **Priority:** HIGH
- **Features:**
  - Add new bulk purchase
  - View inventory levels
  - Track allocation status
  - Generate allocation reports
- **Input for new purchase:**
  - Product, Purchase date, Seller
  - Face value purchased
  - Actual cost (with discount %)
  - Extra allocation %
  - Upload purchase document
- **Business Rules:**
  - Discount + extra must total 25-45%
  - Track remaining inventory
  - Alert when inventory low

**FR-ADMIN-006: Bonus Management**
- **Description:** Manage bonus transactions
- **Priority:** MEDIUM
- **Features:**
  - View all bonus transactions
  - Filter by type, status, date
  - Approve pending bonuses
  - Manual bonus addition
  - Generate bonus reports
  - Export to Excel
- **Business Rules:**
  - Auto-calculated bonuses need no approval
  - Manual bonuses require justification

**FR-ADMIN-007: Reports & Analytics**
- **Description:** Generate business reports
- **Priority:** HIGH
- **Available Reports:**
  - Financial summary (daily/monthly/yearly)
  - User growth report
  - Investment analysis
  - Bonus distribution report
  - Product performance
  - Referral statistics
  - Compliance reports (SEBI)
  - Tax statements
- **Features:**
  - Date range selection
  - Export to PDF/Excel
  - Schedule automatic generation
  - Email delivery

**FR-ADMIN-008: System Settings**
- **Description:** Configure platform settings
- **Priority:** MEDIUM
- **Settings Groups:**
  - General: Site name, currency, timezone
  - Security: 2FA, session timeout, password policy
  - Financial: Min deposit, min withdrawal, fees
  - Compliance: KYC required, document retention
  - Notifications: Email/SMS templates, frequency
  - Payment Gateways: Keys, webhook URLs
- **Business Rules:**
  - Changes logged in audit trail
  - Some settings require system restart
  - Validate before saving

---

#### 3.1.12 Notifications

**FR-NOTIF-001: Send Email Notification**
- **Description:** Send email to users
- **Priority:** HIGH
- **Types:**
  - Welcome email
  - Email verification OTP
  - Payment confirmation
  - Bonus credit notification
  - Milestone achievement
  - Lucky draw results
  - Withdrawal status
  - KYC status update
- **Process:**
  1. Load email template
  2. Replace variables with data
  3. Queue email job
  4. Send via SendGrid/SMTP
  5. Log delivery status
- **Business Rules:**
  - Template-based
  - Queue for async processing
  - Retry 3 times on failure
  - Track open/click rates

**FR-NOTIF-002: Send SMS Notification**
- **Description:** Send SMS to users
- **Priority:** HIGH
- **Types:**
  - Mobile verification OTP
  - Payment reminder
  - Payment confirmation
  - Lucky draw winner
  - Withdrawal approved
- **Process:**
  1. Load SMS template
  2. Replace variables
  3. Queue SMS job
  4. Send via MSG91
  5. Log delivery status
- **Business Rules:**
  - Maximum 160 characters
  - Queue for async processing
  - Track delivery status
  - DND compliance

**FR-NOTIF-003: Push Notifications**
- **Description:** Send push notifications (future)
- **Priority:** LOW
- **Process:**
  1. Use Firebase Cloud Messaging
  2. Send to registered devices
  3. Track delivery and opens
- **Business Rules:**
  - Requires user opt-in
  - Respect quiet hours
  - Rate limiting

**FR-NOTIF-004: In-App Notifications**
- **Description:** Display notifications in dashboard
- **Priority:** MEDIUM
- **Features:**
  - Unread count badge
  - Notification list
  - Mark as read
  - Action buttons (View Details, etc.)
  - Categories/filters
- **Business Rules:**
  - Store for 90 days
  - Auto-mark read after 30 days

---

#### 3.1.13 Support System

**FR-SUPPORT-001: Create Support Ticket**
- **Description:** User creates support ticket
- **Priority:** HIGH
- **Input:** Subject, Category, Priority, Message, Attachments
- **Categories:**
  - Technical, Investment, Payment, KYC
  - Withdrawal, Bonus, Account, Other
- **Process:**
  1. Generate unique ticket_number
  2. Create SupportTicket record
  3. Set status='open'
  4. Assign to support team
  5. Send confirmation email
  6. Create first message
- **Output:** Ticket details
- **Business Rules:**
  - Max 5 active tickets per user
  - Attachments max 5MB each

**FR-SUPPORT-002: Reply to Ticket**
- **Description:** User/Admin replies to ticket
- **Priority:** HIGH
- **Input:** Ticket ID, Message, Attachments
- **Process:**
  1. Create SupportMessage
  2. Update ticket.updated_at
  3. Set status='replied' (if admin) or 'waiting' (if user)
  4. Notify other party
- **Output:** Reply confirmation
- **Business Rules:**
  - Email notification on reply
  - Ticket stays active until resolved

**FR-SUPPORT-003: Close Ticket**
- **Description:** Resolve and close ticket
- **Priority:** MEDIUM
- **Input:** Ticket ID, Resolution
- **Process:**
  1. Update status='resolved'
  2. Set resolved_at timestamp
  3. Store resolution details
  4. Request user rating
  5. Send closure notification
- **Output:** Closure confirmation
- **Business Rules:**
  - Can be reopened within 7 days
  - User rating optional

**FR-SUPPORT-004: Live Chat Support**
- **Description:** Real-time chat with support (future)
- **Priority:** LOW
- **Features:**
  - Instant messaging
  - File sharing
  - Typing indicators
  - Agent assignment
- **Business Rules:**
  - Available 9 AM - 9 PM
  - Auto-create ticket from chat

---

### 3.2 Non-Functional Requirements

#### 3.2.1 Performance Requirements

**NFR-PERF-001: Response Time**
- Page load time: < 2 seconds (95th percentile)
- API response time: < 500ms (95th percentile)
- Database query time: < 100ms
- Asset load time: < 1 second

**NFR-PERF-002: Throughput**
- Support 10,000 concurrent users
- Handle 100 requests/second sustained
- Handle 500 requests/second peak
- Process 1,000 bonus calculations/minute

**NFR-PERF-003: Scalability**
- Horizontal scaling for web servers
- Database read replicas for reporting
- Redis for session and cache
- Queue workers scale independently

**NFR-PERF-004: Database Performance**
- Indexed foreign keys
- Composite indexes for common queries
- Optimized slow queries (< 100ms)
- Connection pooling enabled

#### 3.2.2 Security Requirements

**NFR-SEC-001: Authentication**
- JWT token-based authentication
- Token expiry: 30 days (configurable)
- Refresh token mechanism
- Session invalidation on logout

**NFR-SEC-002: Password Security**
- Bcrypt hashing (cost factor 10)
- Minimum 8 characters
- Require uppercase, lowercase, number
- Password history (last 3)
- Change password every 90 days (optional)

**NFR-SEC-003: Data Encryption**
- HTTPS/TLS 1.3 for all connections
- Database encryption at rest
- Encrypt sensitive fields (Aadhaar, PAN)
- Encrypt documents on S3

**NFR-SEC-004: Access Control**
- Role-based access control (RBAC)
- Principle of least privilege
- API rate limiting (100 requests/15 minutes)
- IP whitelisting for admin panel

**NFR-SEC-005: Input Validation**
- Server-side validation mandatory
- Sanitize all user inputs
- SQL injection prevention (prepared statements)
- XSS prevention (output escaping)
- CSRF protection enabled

**NFR-SEC-006: File Upload Security**
- Whitelist allowed file types
- Maximum file size limits
- Virus scanning (ClamAV)
- Store outside web root
- Random filename generation

**NFR-SEC-007: Audit Trail**
- Log all admin actions
- Log all financial transactions
- Log all KYC decisions
- Immutable audit logs
- Retention: 7 years

#### 3.2.3 Reliability Requirements

**NFR-REL-001: Availability**
- 99.9% uptime (8.76 hours downtime/year)
- Scheduled maintenance windows
- Automatic failover for critical services
- Health check monitoring

**NFR-REL-002: Data Integrity**
- ACID compliance for transactions
- Database backups every 6 hours
- Transaction logs for point-in-time recovery
- Checksum verification for critical data

**NFR-REL-003: Error Handling**
- Graceful error handling
- User-friendly error messages
- Detailed error logging
- Automatic error reporting (Sentry)

**NFR-REL-004: Fault Tolerance**
- Retry mechanism for failed jobs
- Circuit breaker for external APIs
- Fallback mechanisms
- Queue-based processing for critical operations

#### 3.2.4 Usability Requirements

**NFR-USE-001: User Interface**
- Responsive design (mobile, tablet, desktop)
- Consistent design language
- Accessible (WCAG 2.1 Level AA)
- Support major browsers (last 2 versions)

**NFR-USE-002: User Experience**
- Maximum 3 clicks to any action
- Clear call-to-action buttons
- Progress indicators for multi-step forms
- Contextual help text
- Empty states with guidance

**NFR-USE-003: Localization**
- Support English and Hindi (Phase 1)
- Currency formatting (₹)
- Date/time formatting (DD/MM/YYYY)
- Number formatting (Indian numbering system)

#### 3.2.5 Maintainability Requirements

**NFR-MAINT-001: Code Quality**
- PSR-12 coding standards
- Minimum 80% test coverage
- Code comments for complex logic
- API documentation (OpenAPI/Swagger)

**NFR-MAINT-002: Logging**
- Structured logging (JSON format)
- Log levels: DEBUG, INFO, WARNING, ERROR, CRITICAL
- Separate logs for different modules
- Log rotation (keep 30 days)

**NFR-MAINT-003: Monitoring**
- Application performance monitoring (APM)
- Server resource monitoring
- Database query monitoring
- Alert thresholds configured

**NFR-MAINT-004: Deployment**
- Zero-downtime deployments
- Automated deployment pipeline (CI/CD)
- Database migration scripts
- Rollback capability

#### 3.2.6 Compliance Requirements

**NFR-COMP-001: SEBI Compliance**
- Transaction audit trail
- KYC document retention (7 years)
- Investment limits enforcement
- Risk disclosure display

**NFR-COMP-002: PMLA Compliance**
- Enhanced due diligence for high-value transactions
- Suspicious transaction reporting
- Customer risk profiling
- Record keeping

**NFR-COMP-003: Data Privacy**
- GDPR-inspired data practices
- User consent management
- Right to data export
- Right to be forgotten (soft delete)
- Privacy policy compliance

**NFR-COMP-004: Tax Compliance**
- TDS calculation and deduction
- Form 16 generation
- Capital gains calculation
- Annual tax statements

---

## 4. SYSTEM INTERFACES

### 4.1 External System Integrations

**INT-001: Razorpay Payment Gateway**
- Purpose: Process payments
- Protocol: REST API (HTTPS)
- Authentication: API Key + Secret
- Endpoints:
  - Create Order
  - Verify Payment
  - Refund Payment
  - Fetch Payment Details
- Webhooks: payment.captured, payment.failed

**INT-002: PayU Payment Gateway**
- Purpose: Alternate payment processor
- Protocol: REST API (HTTPS)
- Authentication: Merchant Key + Salt
- Similar functionality to Razorpay

**INT-003: DigiLocker API**
- Purpose: Aadhaar verification
- Protocol: OAuth 2.0 + REST API
- Authentication: Client ID + Secret
- Endpoints: Fetch Aadhaar eDocument

**INT-004: Income Tax API**
- Purpose: PAN verification
- Protocol: REST API (HTTPS)
- Authentication: API Key
- Rate Limit: 100 requests/day

**INT-005: MSG91 SMS Gateway**
- Purpose: Send SMS/OTP
- Protocol: REST API (HTTPS)
- Authentication: Auth Key
- Endpoints: Send SMS, Send OTP, Verify OTP

**INT-006: SendGrid Email Service**
- Purpose: Send transactional emails
- Protocol: REST API (HTTPS)
- Authentication: API Key
- Features: Templates, analytics, webhooks

**INT-007: AWS S3 / Local Storage**
- Purpose: Store KYC documents, reports
- Protocol: AWS SDK / File System
- Authentication: Access Key + Secret
- Features: Encryption, versioning, lifecycle

---

## 5. DATABASE REQUIREMENTS

### 5.1 Database Schema
- 55+ tables as per database_schema.sql
- Relationships: Foreign keys with cascading
- Indexes: Primary, foreign, composite indexes
- Views: Materialized views for reports
- Stored Procedures: Complex calculations
- Triggers: Automatic updates

### 5.2 Data Retention
- User data: Indefinite (until account deletion)
- Transaction records: 7 years (SEBI requirement)
- KYC documents: 7 years
- Audit logs: 7 years
- Session data: 30 days
- Temporary files: 7 days

### 5.3 Backup Strategy
- Full backup: Daily at 2 AM
- Incremental backup: Every 6 hours
- Transaction log backup: Continuous
- Backup retention: 30 days
- Offsite backup: AWS S3
- Backup testing: Monthly

---

## 6. TESTING REQUIREMENTS

### 6.1 Unit Testing
- Framework: PHPUnit
- Coverage: Minimum 80%
- Focus: Models, services, utilities
- Mock external dependencies

### 6.2 Integration Testing
- Test API endpoints
- Test database transactions
- Test payment gateway integration
- Test email/SMS delivery

### 6.3 User Acceptance Testing (UAT)
- Test complete user journeys
- Test admin workflows
- Test edge cases
- Beta user testing (100 users)

### 6.4 Performance Testing
- Load testing: Apache JMeter
- Stress testing: Simulate 10K users
- Endurance testing: 24-hour sustained load
- Database performance testing

### 6.5 Security Testing
- Penetration testing
- Vulnerability scanning
- SQL injection testing
- XSS testing
- Authentication testing

---

## 7. DEPLOYMENT REQUIREMENTS

### 7.1 Server Requirements
- OS: Ubuntu 20.04 LTS
- CPU: 4 cores minimum
- RAM: 8GB minimum
- Storage: 100GB SSD
- Network: 1 Gbps

### 7.2 Software Stack
- Web Server: Nginx 1.18+
- PHP: 8.3+ with extensions
- Database: MySQL 8.0+
- Cache: Redis 6.0+
- Queue: Supervisor + Laravel Queue

### 7.3 Domain & SSL
- Domain: preiposip.com
- SSL Certificate: Let's Encrypt (auto-renewal)
- CDN: CloudFlare (optional)

### 7.4 Monitoring & Alerts
- Server monitoring: Netdata
- Application monitoring: Laravel Telescope
- Error tracking: Sentry
- Uptime monitoring: Pingdom
- Alerts: Email + SMS for critical issues

---

## 8. GLOSSARY

**Terms and Definitions:**
- **Pre-IPO**: Shares purchased before a company's Initial Public Offering
- **SIP**: Systematic Investment Plan (monthly recurring investment)
- **BV**: Business Volume (face value of allocated shares)
- **Progressive Bonus**: Bonus that increases each month
- **Milestone Bonus**: One-time bonus at 12, 24, 36 months
- **Referral Multiplier**: Factor that multiplies all bonuses based on referrals
- **Lucky Draw**: Monthly prize distribution to eligible members
- **Profit Sharing**: Quarterly distribution of platform profits
- **Consistency Bonus**: Reward for making on-time payments
- **Celebration Bonus**: Birthday/anniversary bonuses
- **Exit Fee**: Fee charged when selling shares (currently 0%)

---

## 9. APPENDICES

### 9.1 Bonus Calculation Examples
*(Refer to bonus_calculation_engine.php)*

### 9.2 API Documentation
*(Refer to admin_dashboard_api.md)*

### 9.3 Database Schema
*(Refer to database_schema.sql)*

### 9.4 User Journey Diagrams
*(To be created in design phase)*

---

**Document Version History:**
- v1.0 - November 4, 2024 - Initial SRS creation

**Approval Signatures:**
- Product Owner: _______________
- Technical Lead: _______________
- Project Manager: _______________

---

**END OF SRS DOCUMENT**